{% load static %}
<!doctype html>
<html lang="en" data-theme="system" class="h-full">
  <head>
    <!-- Preconnect for Google auth fonts/icons -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <meta name="theme-color" content="#0b1220">

    <!-- Basic OG -->
    <meta property="og:site_name" content="DeltaCrown">
    <meta property="og:type" content="website">
    <meta property="og:title" content="{% block og_title %}DeltaCrown{% endblock %}">
    <meta property="og:image" content="{% static 'siteui/og/default.png' %}">

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Favicon - New Logo -->
    <link rel="icon" href="{% static 'img/favicon/favicon.ico' %}?v=new" sizes="any">
    <link rel="icon" href="{% static 'img/favicon/favicon-16x16.png' %}?v=new" sizes="16x16" type="image/png">
    <link rel="icon" href="{% static 'img/favicon/favicon-32x32.png' %}?v=new" sizes="32x32" type="image/png">
    <link rel="icon" href="{% static 'img/favicon/favicon-48x48.png' %}?v=new" sizes="48x48" type="image/png">
    <link rel="icon" href="{% static 'img/favicon/favicon-64x64.png' %}?v=new" sizes="64x64" type="image/png">
    <link rel="apple-touch-icon" href="{% static 'img/favicon/favicon-180x180.png' %}?v=new">
    <link rel="manifest" href="{% static 'img/favicon/site-v2.webmanifest' %}">


    {% include "partials/seo_meta.html" %}
    <title>{% block title %}DeltaCrown{% endblock %}</title>

    <!-- Tailwind CSS: CDN Play + custom DeltaCrown config (works everywhere, no build step) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            colors: {
              primary: {"50":"#eff6ff","100":"#dbeafe","200":"#bfdbfe","300":"#93c5fd","400":"#60a5fa","500":"#3b82f6","600":"#2563eb","700":"#1d4ed8","800":"#1e40af","900":"#1e3a8a","950":"#172554"},
              delta: { base:'#020204', surface:'#0A0A0F', highlight:'#12121A', gold:'#FFD700', violet:'#6C00FF', electric:'#00E5FF', success:'#10B981', danger:'#EF4444' },
              'dc-cyan':'#06b6d4','dc-purple':'#8b5cf6','dc-gold':'#facc15','dc-dark':'#050505','dc-bg':'#030303',
              'dc-surface':'#0d0d0d','dc-card':'#111111','dc-card-hover':'#181818','dc-border':'rgba(255,255,255,0.08)','val-red':'#ff4655',
            },
            fontFamily: {
              sans:['Inter','ui-sans-serif','system-ui','sans-serif'],
              display:['Space Grotesk','sans-serif'],
              gaming:['Rajdhani','sans-serif'],
              corp:['Outfit','sans-serif'],
              tech:['Rajdhani','sans-serif'],
              body:['Inter','ui-sans-serif','system-ui','sans-serif'],
            },
            backgroundImage: {
              'gradient-radial':'radial-gradient(var(--tw-gradient-stops))',
              'hero-gradient':'linear-gradient(to bottom, rgba(3,3,3,0) 0%, #030303 100%)',
              'card-gradient':'linear-gradient(180deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0) 100%)',
            },
            animation: {
              'pulse-slow':'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
              'float':'float 6s ease-in-out infinite',
              'shimmer':'shimmer 2.5s linear infinite',
            },
            boxShadow: {
              'glow-gold':'0 0 30px rgba(255, 215, 0, 0.1)',
              'glow-cyan':'0 0 15px rgba(6, 182, 212, 0.15)',
              'glow-purple':'0 0 15px rgba(139, 92, 246, 0.15)',
            },
          },
        },
      }
    </script>
    <!-- Custom site CSS (tokens, components, nav, etc.) -->
    <link rel="stylesheet" href="{% static 'dist/tailwind.css' %}?v=20260225" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css">
    <!-- Phase 9A-24: Toastify.js for modern toast notifications -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js@1.12.0/src/toastify.min.css">

    {# ðŸ”½ allow pages to inject extra CSS (e.g., tournaments-detail.css) #}
    {% block extra_css %}{% endblock %}
    <!-- CSRF token for JS â€” works with CSRF_COOKIE_HTTPONLY=True -->
    <meta name="csrf-token" content="{{ csrf_token }}">
    {% block extra_head %}{% endblock %}
    <!-- Provide a safe no-op `dcLog` early so inline scripts can call it without errors -->
    <script>
      window.DELTACROWN_DEBUG = false;
      window.dcLog = function(){};
    </script>
  </head>
  <body class="min-h-full bg-body text-body antialiased">
    <a href="#main" class="skip-link">Skip to main content</a>

    {% include "partials/primary_navigation.html" %}

    <main id="main" tabindex="-1">
      {% block content %}{% endblock %}
    </main>

    {% block footer %}
    {% if request.path == '/' %}
      {% include "partials/footer_modern.html" %}
    {% endif %}
    {% endblock %}
    {% include "partials/toasts.html" %}

    <!-- Site JS -->
    <script>
      // Server-side controlled debug flag (authorized users only)
      window.DELTACROWN_DEBUG = {% if request.user.is_superuser or debug|default:False %}true{% else %}false{% endif %};
    </script>
    <script src="{% static 'siteui/js/debug.js' %}"></script>
    <script src="{% static 'siteui/js/theme.js' %}"></script>
    <script src="{% static 'siteui/js/esports-theme-toggle.js' %}"></script>
    <script src="{% static 'siteui/js/notifications.js' %}?v=2"></script>
    <script src="{% static 'siteui/js/components.js' %}"></script>
    <script src="{% static 'siteui/js/motion.js' %}"></script>
    <script src="{% static 'siteui/js/tournaments.js' %}"></script>
    <script src="{% static 'siteui/js/tournaments-list.js' %}"></script>
    <script src="{% static 'siteui/js/teams.js' %}"></script>
    <script src="{% static 'siteui/js/auth.js' %}"></script>
    <script src="{% static 'siteui/js/micro.js' %}"></script>
    <script src="{% static 'siteui/js/toast-modern.js' %}"></script>
    <script src="{% static 'siteui/js/primary_navigation.js' %}"></script>
    <script src="{% static 'siteui/js/reg_wizard.js' %}"></script>
    <script src="{% static 'siteui/js/follow.js' %}"></script>

    <!-- Phase 9A-24: Toastify.js + Messages Init -->
    <script src="https://cdn.jsdelivr.net/npm/toastify-js@1.12.0/src/toastify.min.js"></script>
    <script src="{% static 'siteui/js/toast.js' %}"></script>
    
    {% if messages %}
    <script id="messages-data" type="application/json">[
      {% for message in messages %}
        {"level":"{{ message.tags|default:'info' }}","text":"{{ message|escapejs }}"}{% if not forloop.last %},{% endif %}
      {% endfor %}
    ]</script>
    <script>
      // Phase 9A-24: Auto-show Django messages as toasts on page load
      document.addEventListener('DOMContentLoaded', function() {
        const messagesEl = document.getElementById('messages-data');
        if (messagesEl && window.showToast) {
          try {
            const messages = JSON.parse(messagesEl.textContent);
            messages.forEach(msg => {
              const type = msg.level === 'error' ? 'error' : 
                          msg.level === 'warning' ? 'warning' : 
                          msg.level === 'success' ? 'success' : 'info';
              window.showToast({type, message: msg.text});
            });
          } catch(e) {
            console.error('[Toast] Failed to parse Django messages:', e);
          }
        }
      });
    </script>
    {% endif %}

    {# ðŸ”½ allow pages to inject extra JS (e.g., tournament-detail.js) #}
    {% block extra_js %}{% endblock %}
  </body>
</html>
