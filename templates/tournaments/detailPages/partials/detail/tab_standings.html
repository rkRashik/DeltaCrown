{# Standings Tab - Unified Tournament Rankings #}

<section class="td-tab-panel td-tab-panel-standings" data-tab="standings">
  <div class="td-standings-header">
    <div class="td-standings-header-main">
      <h2 class="td-standings-title">Standings</h2>
      <p class="td-standings-subtitle">
        Rankings and performance across the tournament.
      </p>
    </div>

    <div class="td-standings-meta">
      {% if standings_source == "group_stage" %}
        <span class="td-standings-badge">Based on group stage results</span>
      {% elif standings_source == "mixed" %}
        <span class="td-standings-badge">Group stage + knockout performance</span>
      {% else %}
        <span class="td-standings-badge">Overall performance</span>
      {% endif %}
    </div>
  </div>

  {% if standings_primary %}
    <div class="td-standings-layout">
      <section class="td-standings-main">
        <header class="td-standings-table-header">
          <div class="td-std-col td-std-col-rank">#</div>
          <div class="td-std-col td-std-col-name">Team / Player</div>
          <div class="td-std-col td-std-col-mp">P</div>
          <div class="td-std-col td-std-col-w">W</div>
          <div class="td-std-col td-std-col-d">D</div>
          <div class="td-std-col td-std-col-l">L</div>
          <div class="td-std-col td-std-col-gd">Â±</div>
          <div class="td-std-col td-std-col-pts">Pts</div>
        </header>

        <div class="td-standings-table-body">
          {% for row in standings_primary %}
            <article class="td-std-row {% if row.is_advancing %}is-advancing{% endif %}">
              <div class="td-std-cell td-std-col-rank">
                <span class="td-std-rank">{{ row.rank }}</span>
              </div>

              <div class="td-std-cell td-std-col-name">
                <div class="td-std-name-main">
                  <span class="td-std-name-text">
                    {{ row.name }}
                  </span>
                  {% if row.group_name %}
                    <span class="td-std-tag-pill">Group {{ row.group_name }}</span>
                  {% endif %}
                </div>
                {% if row.game_specific_label %}
                  <div class="td-std-name-sub">
                    <span class="td-std-meta">{{ row.game_specific_label }}</span>
                  </div>
                {% endif %}
              </div>

              <div class="td-std-cell td-std-col-mp">{{ row.matches_played }}</div>
              <div class="td-std-cell td-std-col-w">{{ row.wins }}</div>
              <div class="td-std-cell td-std-col-d">{{ row.draws }}</div>
              <div class="td-std-cell td-std-col-l">{{ row.losses }}</div>
              <div class="td-std-cell td-std-col-gd">
                {% if row.goal_difference is not None %}
                  <span class="{% if row.goal_difference > 0 %}td-stat-positive{% elif row.goal_difference < 0 %}td-stat-negative{% endif %}">
                    {{ row.goal_difference|stringformat:"+d" }}
                  </span>
                {% elif row.round_difference is not None %}
                  <span class="{% if row.round_difference > 0 %}td-stat-positive{% elif row.round_difference < 0 %}td-stat-negative{% endif %}">
                    {{ row.round_difference|stringformat:"+d" }}
                  </span>
                {% elif row.kill_difference is not None %}
                  <span class="{% if row.kill_difference > 0 %}td-stat-positive{% elif row.kill_difference < 0 %}td-stat-negative{% endif %}">
                    {{ row.kill_difference|stringformat:"+d" }}
                  </span>
                {% else %}
                  -
                {% endif %}
              </div>
              <div class="td-std-cell td-std-col-pts">
                <span class="td-std-points">{{ row.points }}</span>
              </div>
            </article>
          {% endfor %}
        </div>
      </section>

      {% if is_multi_stage and group_standings_summary %}
        <aside class="td-standings-sidebar">
          <h3 class="td-standings-sidebar-title">Group Overview</h3>
          <div class="td-standings-groups-summary">
            {% for group_summary in group_standings_summary %}
              <section class="td-standings-group-card">
                <header class="td-standings-group-header">
                  <span class="td-group-label">Group</span>
                  <span class="td-group-name">{{ group_summary.name }}</span>
                </header>
                <div class="td-standings-group-body">
                  {% for s in group_summary.advancers %}
                    <div class="td-standings-group-row is-advancing">
                      <span class="td-sg-rank">{{ s.rank }}</span>
                      <span class="td-sg-name">{{ s.name }}</span>
                    </div>
                  {% endfor %}
                  {% for s in group_summary.others %}
                    <div class="td-standings-group-row">
                      <span class="td-sg-rank">{{ s.rank }}</span>
                      <span class="td-sg-name">{{ s.name }}</span>
                    </div>
                  {% endfor %}
                </div>
              </section>
            {% endfor %}
          </div>
        </aside>
      {% endif %}
    </div>
  {% else %}
    <div class="td-standings-empty">
      <div class="td-empty-icon">ðŸ“Š</div>
      <p class="td-empty-title">Standings are not available yet.</p>
      <p class="td-empty-subtitle">
        Once enough matches have been completed, standings will appear here.
      </p>
    </div>
  {% endif %}
</section>
