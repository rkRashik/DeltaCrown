{# Bracket Tab - Multi-Stage Tournament Support #}
{# Purpose: Interactive bracket view with group stage and knockout support #}
{# Content: Stage selector, group standings, bracket visualization #}
{% load dict_utils %}

<section class="detail-tab-panel td-tab-panel td-tab-panel-bracket" data-tab="bracket">
  {% if tournament.format == 'group_playoff' %}
    {# GROUP_PLAYOFF tournaments - Show stage selector #}
    <div class="td-stage-selector">
      <button
        type="button"
        class="td-stage-pill {% if current_stage == 'group_stage' %}is-active{% endif %}"
        data-stage-target="group_stage"
      >
        ğŸ“Š Group Stage
        {% if current_stage == 'group_stage' %}
          <span class="td-stage-pill-status">Live</span>
        {% else %}
          <span class="td-stage-pill-status">Complete</span>
        {% endif %}
      </button>

      <button
        type="button"
        class="td-stage-pill {% if current_stage == 'knockout_stage' %}is-active{% endif %}"
        data-stage-target="knockout_stage"
        {% if current_stage != 'knockout_stage' %}data-disabled-stage="true"{% endif %}
      >
        ğŸ† Knockout
        {% if current_stage == 'knockout_stage' %}
          <span class="td-stage-pill-status">Live</span>
        {% else %}
          <span class="td-stage-pill-status">Coming Soon</span>
        {% endif %}
      </button>
    </div>

    <div class="td-stage-panels">
      {# Group Stage Panel #}
      <div
        class="td-stage-panel td-stage-panel-group {% if current_stage == 'group_stage' %}is-active{% endif %}"
        data-stage-panel="group_stage"
      >
        {% include "tournaments/detailPages/partials/detail/_group_stage_panel.html" %}
      </div>

      {# Knockout Stage Panel #}
      <div
        class="td-stage-panel td-stage-panel-knockout {% if current_stage == 'knockout_stage' %}is-active{% endif %}"
        data-stage-panel="knockout_stage"
      >
        {% include "tournaments/detailPages/partials/detail/_knockout_panel.html" %}
      </div>
    </div>
  {% else %}
    {# Single-stage tournaments (SINGLE_ELIM, DOUBLE_ELIM, etc.) - Pure bracket view #}
    {% if bracket %}
      <div class="td-single-stage-bracket">
        {% include "tournaments/detailPages/partials/detail/_knockout_panel.html" %}
      </div>
    {% else %}
      <div class="td-bracket-empty">
        <div class="td-empty-icon">ğŸ†</div>
        <p class="td-empty-title">Bracket has not been generated yet</p>
        <p class="td-empty-subtitle">
          The tournament bracket will appear here once it has been generated.
        </p>
      </div>
    {% endif %}
  {% endif %}
</section>
