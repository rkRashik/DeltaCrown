{% extends "tournaments/team_registration/base.html" %}

{% block extra_head %}
<!-- Override progress bar for success page -->
<style>
    .step-indicator { display: none; }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center py-12">
    <div class="max-w-3xl w-full space-y-8 text-center">
        <!-- Success Animation Container -->
        <div class="relative">
            <div class="w-32 h-32 mx-auto mb-8 relative">
                <!-- Animated Checkmark Circle -->
                <div class="success-checkmark">
                    <div class="check-icon">
                        <span class="icon-line line-tip"></span>
                        <span class="icon-line line-long"></span>
                        <div class="icon-circle"></div>
                        <div class="icon-fix"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Success Message -->
        <div>
            <h1 class="text-4xl font-bold text-white mb-4">
                üéâ Team Registration Submitted!
            </h1>
            <p class="text-xl text-gray-400 mb-2">
                <span class="text-primary font-bold">{{ step_data.team_name }}</span> is registered for
            </p>
            <p class="text-lg text-gray-500">
                {{ tournament.title }}
            </p>
        </div>

        <!-- Team Summary Card -->
        <div class="gradient-border rounded-lg p-8 text-left">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-white flex items-center">
                    <span class="text-3xl mr-3">üèÜ</span>
                    Team Registration Summary
                </h2>
                <span class="px-4 py-2 bg-yellow-500/20 text-yellow-500 rounded-full text-sm font-bold">
                    ‚è≥ Pending Verification
                </span>
            </div>

            <div class="space-y-4 mb-6">
                <div class="flex justify-between items-center pb-3 border-b border-gray-700">
                    <span class="text-gray-400">Team Name</span>
                    <span class="text-white font-bold text-lg">{{ step_data.team_name }} [{{ step_data.team_tag }}]</span>
                </div>
                <div class="flex justify-between items-center pb-3 border-b border-gray-700">
                    <span class="text-gray-400">Team Captain</span>
                    <span class="text-white font-medium">{{ step_data.captain_display_name }}</span>
                </div>
                <div class="flex justify-between items-center pb-3 border-b border-gray-700">
                    <span class="text-gray-400">Captain Email</span>
                    <span class="text-white font-medium">{{ step_data.captain_email }}</span>
                </div>
                <div class="flex justify-between items-center pb-3 border-b border-gray-700">
                    <span class="text-gray-400">Total Players</span>
                    <span class="text-white font-medium">5 main + 1 substitute</span>
                </div>
                <div class="flex justify-between items-center pb-3 border-b border-gray-700">
                    <span class="text-gray-400">Payment Method</span>
                    <span class="text-white font-medium">{{ step_data.payment_method }}</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-gray-400">Transaction ID</span>
                    <span class="text-white font-medium font-mono">{{ step_data.transaction_id }}</span>
                </div>
            </div>

            <div class="bg-primary/10 border border-primary/30 rounded-lg p-4">
                <div class="flex items-start">
                    <i class="fas fa-clock text-primary text-2xl mr-3 mt-1"></i>
                    <div class="text-sm">
                        <p class="font-bold text-white mb-2">What happens next?</p>
                        <ul class="text-gray-300 space-y-1">
                            <li>‚úÖ Our team will verify your payment within 1-2 hours</li>
                            <li>üìß Captain will receive confirmation email at <strong>{{ step_data.captain_email }}</strong></li>
                            <li>üí¨ Discord invite and WhatsApp group link will be sent to all team members</li>
                            <li>üë• All team members will be notified via email</li>
                            <li>üéÆ Once approved, access tournament details in your team dashboard</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Team Roster Card -->
        <div class="gradient-border rounded-lg p-6 text-left">
            <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                <span class="text-2xl mr-2">üë•</span>
                Your Team Roster
            </h3>
            
            <div class="space-y-2">
                <div class="bg-gray-800 rounded-lg p-3 border-l-4 border-yellow-500 flex items-center justify-between">
                    <div>
                        <span class="text-yellow-500 text-xs font-bold">‚≠ê CAPTAIN</span>
                        <div class="text-white font-medium">{{ step_data.captain_display_name }}</div>
                        <div class="text-xs text-gray-400 font-mono">{{ step_data.captain_riot_id }}</div>
                    </div>
                </div>
                
                <div class="bg-gray-800 rounded-lg p-3 border-l-4 border-primary flex items-center justify-between">
                    <div>
                        <span class="text-primary text-xs font-bold">PLAYER 2</span>
                        <div class="text-white font-medium">{{ step_data.player2_ign }}</div>
                        <div class="text-xs text-gray-400 font-mono">{{ step_data.player2_riot_id }}</div>
                    </div>
                </div>
                
                <div class="bg-gray-800 rounded-lg p-3 border-l-4 border-primary flex items-center justify-between">
                    <div>
                        <span class="text-primary text-xs font-bold">PLAYER 3</span>
                        <div class="text-white font-medium">{{ step_data.player3_ign }}</div>
                        <div class="text-xs text-gray-400 font-mono">{{ step_data.player3_riot_id }}</div>
                    </div>
                </div>
                
                <div class="bg-gray-800 rounded-lg p-3 border-l-4 border-primary flex items-center justify-between">
                    <div>
                        <span class="text-primary text-xs font-bold">PLAYER 4</span>
                        <div class="text-white font-medium">{{ step_data.player4_ign }}</div>
                        <div class="text-xs text-gray-400 font-mono">{{ step_data.player4_riot_id }}</div>
                    </div>
                </div>
                
                <div class="bg-gray-800 rounded-lg p-3 border-l-4 border-primary flex items-center justify-between">
                    <div>
                        <span class="text-primary text-xs font-bold">PLAYER 5</span>
                        <div class="text-white font-medium">{{ step_data.player5_ign }}</div>
                        <div class="text-xs text-gray-400 font-mono">{{ step_data.player5_riot_id }}</div>
                    </div>
                </div>
                
                <div class="bg-gray-800 rounded-lg p-3 border-l-4 border-green-500 flex items-center justify-between">
                    <div>
                        <span class="text-green-500 text-xs font-bold">üîÑ SUBSTITUTE</span>
                        <div class="text-white font-medium">{{ step_data.substitute_ign }}</div>
                        <div class="text-xs text-gray-400 font-mono">{{ step_data.substitute_riot_id }}</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Important Information -->
        <div class="gradient-border rounded-lg p-6 text-left">
            <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                <span class="text-2xl mr-2">üí°</span>
                Important for Team Captains
            </h3>
            
            <div class="space-y-3 text-sm text-gray-300">
                <div class="flex items-start">
                    <i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i>
                    <p><strong>Coordinate Your Team:</strong> Ensure all team members join Discord and check their emails</p>
                </div>
                <div class="flex items-start">
                    <i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i>
                    <p><strong>Team Check-in:</strong> Captain must check in the entire team 30 minutes before matches</p>
                </div>
                <div class="flex items-start">
                    <i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i>
                    <p><strong>Communication:</strong> You're responsible for keeping your team informed of all updates</p>
                </div>
                <div class="flex items-start">
                    <i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i>
                    <p><strong>Save This Page:</strong> Screenshot team roster and registration details for your records</p>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center pt-4">
            <a href="{% url 'tournaments:detail' tournament.slug %}" 
                class="px-8 py-4 bg-gradient-to-r from-primary to-secondary text-white font-bold rounded-lg glow-button hover:scale-105 transform transition-all">
                <i class="fas fa-trophy mr-2"></i>
                View Tournament Details
            </a>
            
            <a href="{% url 'tournaments:list' %}" 
                class="px-8 py-4 bg-gray-700 hover:bg-gray-600 text-white font-bold rounded-lg transition-colors">
                <i class="fas fa-users mr-2"></i>
                Go to Team Dashboard
            </a>
        </div>

        <!-- Social Share -->
        <div class="pt-8 border-t border-gray-800">
            <p class="text-gray-400 mb-4">Share your team registration!</p>
            <div class="flex justify-center gap-4">
                <button onclick="shareTwitter()" 
                    class="px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors">
                    <i class="fab fa-twitter mr-2"></i>
                    Twitter
                </button>
                <button onclick="shareFacebook()" 
                    class="px-6 py-3 bg-blue-700 hover:bg-blue-800 text-white rounded-lg transition-colors">
                    <i class="fab fa-facebook mr-2"></i>
                    Facebook
                </button>
                <button onclick="shareDiscord()" 
                    class="px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors">
                    <i class="fab fa-discord mr-2"></i>
                    Discord
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Custom Success Animation CSS -->
<style>
.success-checkmark {
    width: 128px;
    height: 128px;
    margin: 0 auto;
}

.success-checkmark .check-icon {
    width: 128px;
    height: 128px;
    position: relative;
    border-radius: 50%;
    box-sizing: content-box;
    border: 4px solid #4ade80;
}

.success-checkmark .check-icon::before {
    top: 3px;
    left: -2px;
    width: 30px;
    transform-origin: 100% 50%;
    border-radius: 100px 0 0 100px;
}

.success-checkmark .check-icon::after {
    top: 0;
    left: 30px;
    width: 60px;
    transform-origin: 0 50%;
    border-radius: 0 100px 100px 0;
    animation: rotate-circle 4.25s ease-in;
}

.success-checkmark .check-icon::before, .success-checkmark .check-icon::after {
    content: '';
    height: 120px;
    position: absolute;
    background: #1f2937;
    transform: rotate(-45deg);
}

.success-checkmark .icon-line {
    height: 5px;
    background-color: #4ade80;
    display: block;
    border-radius: 2px;
    position: absolute;
    z-index: 10;
}

.success-checkmark .icon-line.line-tip {
    top: 56px;
    left: 21px;
    width: 30px;
    transform: rotate(45deg);
    animation: icon-line-tip 0.75s;
}

.success-checkmark .icon-line.line-long {
    top: 48px;
    right: 12px;
    width: 60px;
    transform: rotate(-45deg);
    animation: icon-line-long 0.75s;
}

.success-checkmark .icon-circle {
    top: -4px;
    left: -4px;
    z-index: 10;
    width: 128px;
    height: 128px;
    border-radius: 50%;
    position: absolute;
    box-sizing: content-box;
    border: 4px solid rgba(74, 222, 128, 0.5);
}

.success-checkmark .icon-fix {
    top: 12px;
    width: 10px;
    left: 32px;
    z-index: 1;
    height: 110px;
    position: absolute;
    transform: rotate(-45deg);
    background-color: #1f2937;
}

@keyframes rotate-circle {
    0% { transform: rotate(-45deg); }
    5% { transform: rotate(-45deg); }
    12% { transform: rotate(-405deg); }
    100% { transform: rotate(-405deg); }
}

@keyframes icon-line-tip {
    0% { width: 0; left: 5px; top: 24px; }
    54% { width: 0; left: 5px; top: 24px; }
    70% { width: 50px; left: -8px; top: 56px; }
    84% { width: 24px; left: 28px; top: 56px; }
    100% { width: 30px; left: 21px; top: 56px; }
}

@keyframes icon-line-long {
    0% { width: 0; right: 56px; top: 62px; }
    65% { width: 0; right: 56px; top: 62px; }
    84% { width: 70px; right: 0; top: 48px; }
    100% { width: 60px; right: 12px; top: 48px; }
}
</style>

<script>
// Trigger confetti on page load
document.addEventListener('DOMContentLoaded', function() {
    // Big confetti celebration for team success
    confetti({
        particleCount: 150,
        spread: 80,
        origin: { y: 0.6 }
    });
    
    // Multiple bursts
    setTimeout(function() {
        confetti({
            particleCount: 70,
            angle: 60,
            spread: 55,
            origin: { x: 0 }
        });
        confetti({
            particleCount: 70,
            angle: 120,
            spread: 55,
            origin: { x: 1 }
        });
    }, 250);
    
    setTimeout(function() {
        confetti({
            particleCount: 100,
            spread: 90,
            origin: { y: 0.7 }
        });
    }, 500);
});

// Social sharing functions
function shareTwitter() {
    const text = `Our team {{ step_data.team_name }} just registered for {{ tournament.title }}! üèÜüî•`;
    const url = window.location.origin + "{% url 'tournaments:detail' tournament.slug %}";
    window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`, '_blank');
}

function shareFacebook() {
    const url = window.location.origin + "{% url 'tournaments:detail' tournament.slug %}";
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`, '_blank');
}

function shareDiscord() {
    alert('Copy the tournament link and share it in your team Discord!');
}
</script>
{% endblock %}
