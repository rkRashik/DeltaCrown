{% extends "tournaments/team_registration/base.html" %}

{% block extra_head %}
<!-- Override progress bar for success page -->
<style>
    .step-indicator { display: none; }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center py-12">
    <div class="max-w-2xl w-full space-y-8 text-center">
        <!-- Success Animation Container -->
        <div class="relative">
            <div class="w-32 h-32 mx-auto mb-8 relative">
                <!-- Animated Checkmark Circle -->
                <div class="success-checkmark">
                    <div class="check-icon">
                        <span class="icon-line line-tip"></span>
                        <span class="icon-line line-long"></span>
                        <div class="icon-circle"></div>
                        <div class="icon-fix"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Success Message -->
        <div>
            <h1 class="text-4xl font-bold text-white mb-4">
                üéâ Registration Submitted!
            </h1>
            <p class="text-xl text-gray-400 mb-8">
                Thank you for registering for <span class="text-primary font-bold">{{ tournament.title }}</span>
            </p>
        </div>

        <!-- Registration Status Card -->
        <div class="gradient-border rounded-lg p-8 text-left">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-white flex items-center">
                    <span class="text-3xl mr-3">üìù</span>
                    Registration Summary
                </h2>
                <span class="px-4 py-2 bg-yellow-500/20 text-yellow-500 rounded-full text-sm font-bold">
                    ‚è≥ Pending Verification
                </span>
            </div>

            <div class="space-y-4 mb-6">
                <div class="flex justify-between items-center pb-3 border-b border-gray-700">
                    <span class="text-gray-400">Player Name</span>
                    <span class="text-white font-medium">{{ step_data.full_name }}</span>
                </div>
                <div class="flex justify-between items-center pb-3 border-b border-gray-700">
                    <span class="text-gray-400">Display Name</span>
                    <span class="text-white font-medium">{{ step_data.display_name }}</span>
                </div>
                <div class="flex justify-between items-center pb-3 border-b border-gray-700">
                    <span class="text-gray-400">Game ID</span>
                    <span class="text-white font-medium font-mono">{{ step_data.game_id }}</span>
                </div>
                <div class="flex justify-between items-center pb-3 border-b border-gray-700">
                    <span class="text-gray-400">Email</span>
                    <span class="text-white font-medium">{{ step_data.email }}</span>
                </div>
                <div class="flex justify-between items-center pb-3 border-b border-gray-700">
                    <span class="text-gray-400">Payment Method</span>
                    <span class="text-white font-medium">{{ step_data.payment_method }}</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-gray-400">Transaction ID</span>
                    <span class="text-white font-medium font-mono">{{ step_data.transaction_id }}</span>
                </div>
            </div>

            <div class="bg-primary/10 border border-primary/30 rounded-lg p-4">
                <div class="flex items-start">
                    <i class="fas fa-clock text-primary text-2xl mr-3 mt-1"></i>
                    <div class="text-sm">
                        <p class="font-bold text-white mb-2">What happens next?</p>
                        <ul class="text-gray-300 space-y-1">
                            <li>‚úÖ Our team will verify your payment within 1-2 hours</li>
                            <li>üìß You'll receive a confirmation email at <strong>{{ step_data.email }}</strong></li>
                            <li>üí¨ We'll send Discord/WhatsApp instructions to your registered contacts</li>
                            <li>üéÆ Once approved, you can access tournament details in your dashboard</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Important Information -->
        <div class="gradient-border rounded-lg p-6 text-left">
            <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                <span class="text-2xl mr-2">üí°</span>
                Important Information
            </h3>
            
            <div class="space-y-3 text-sm text-gray-300">
                <div class="flex items-start">
                    <i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i>
                    <p><strong>Check-in Required:</strong> You must check in 30 minutes before the tournament starts</p>
                </div>
                <div class="flex items-start">
                    <i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i>
                    <p><strong>Join Discord:</strong> Tournament updates and match coordination happen on Discord</p>
                </div>
                <div class="flex items-start">
                    <i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i>
                    <p><strong>Keep Contacts Active:</strong> We'll reach out via {{ step_data.preferred_contact }} for urgent updates</p>
                </div>
                <div class="flex items-start">
                    <i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i>
                    <p><strong>Save This Info:</strong> Screenshot this page or check your email for registration details</p>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center pt-4">
            <a href="{% url 'tournaments:detail' tournament.slug %}" 
                class="px-8 py-4 bg-gradient-to-r from-primary to-secondary text-white font-bold rounded-lg glow-button hover:scale-105 transform transition-all">
                <i class="fas fa-trophy mr-2"></i>
                View Tournament Details
            </a>
            
            <a href="{% url 'tournaments:list' %}" 
                class="px-8 py-4 bg-gray-700 hover:bg-gray-600 text-white font-bold rounded-lg transition-colors">
                <i class="fas fa-home mr-2"></i>
                Go to Dashboard
            </a>
        </div>

        <!-- Social Share -->
        <div class="pt-8 border-t border-gray-800">
            <p class="text-gray-400 mb-4">Share your registration with friends!</p>
            <div class="flex justify-center gap-4">
                <button onclick="shareTwitter()" 
                    class="px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors">
                    <i class="fab fa-twitter mr-2"></i>
                    Twitter
                </button>
                <button onclick="shareFacebook()" 
                    class="px-6 py-3 bg-blue-700 hover:bg-blue-800 text-white rounded-lg transition-colors">
                    <i class="fab fa-facebook mr-2"></i>
                    Facebook
                </button>
                <button onclick="shareDiscord()" 
                    class="px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors">
                    <i class="fab fa-discord mr-2"></i>
                    Discord
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Custom Success Animation CSS -->
<style>
.success-checkmark {
    width: 128px;
    height: 128px;
    margin: 0 auto;
}

.success-checkmark .check-icon {
    width: 128px;
    height: 128px;
    position: relative;
    border-radius: 50%;
    box-sizing: content-box;
    border: 4px solid #4ade80;
}

.success-checkmark .check-icon::before {
    top: 3px;
    left: -2px;
    width: 30px;
    transform-origin: 100% 50%;
    border-radius: 100px 0 0 100px;
}

.success-checkmark .check-icon::after {
    top: 0;
    left: 30px;
    width: 60px;
    transform-origin: 0 50%;
    border-radius: 0 100px 100px 0;
    animation: rotate-circle 4.25s ease-in;
}

.success-checkmark .check-icon::before, .success-checkmark .check-icon::after {
    content: '';
    height: 120px;
    position: absolute;
    background: #1f2937;
    transform: rotate(-45deg);
}

.success-checkmark .icon-line {
    height: 5px;
    background-color: #4ade80;
    display: block;
    border-radius: 2px;
    position: absolute;
    z-index: 10;
}

.success-checkmark .icon-line.line-tip {
    top: 56px;
    left: 21px;
    width: 30px;
    transform: rotate(45deg);
    animation: icon-line-tip 0.75s;
}

.success-checkmark .icon-line.line-long {
    top: 48px;
    right: 12px;
    width: 60px;
    transform: rotate(-45deg);
    animation: icon-line-long 0.75s;
}

.success-checkmark .icon-circle {
    top: -4px;
    left: -4px;
    z-index: 10;
    width: 128px;
    height: 128px;
    border-radius: 50%;
    position: absolute;
    box-sizing: content-box;
    border: 4px solid rgba(74, 222, 128, 0.5);
}

.success-checkmark .icon-fix {
    top: 12px;
    width: 10px;
    left: 32px;
    z-index: 1;
    height: 110px;
    position: absolute;
    transform: rotate(-45deg);
    background-color: #1f2937;
}

@keyframes rotate-circle {
    0% { transform: rotate(-45deg); }
    5% { transform: rotate(-45deg); }
    12% { transform: rotate(-405deg); }
    100% { transform: rotate(-405deg); }
}

@keyframes icon-line-tip {
    0% { width: 0; left: 5px; top: 24px; }
    54% { width: 0; left: 5px; top: 24px; }
    70% { width: 50px; left: -8px; top: 56px; }
    84% { width: 24px; left: 28px; top: 56px; }
    100% { width: 30px; left: 21px; top: 56px; }
}

@keyframes icon-line-long {
    0% { width: 0; right: 56px; top: 62px; }
    65% { width: 0; right: 56px; top: 62px; }
    84% { width: 70px; right: 0; top: 48px; }
    100% { width: 60px; right: 12px; top: 48px; }
}
</style>

<script>
// Trigger confetti on page load
document.addEventListener('DOMContentLoaded', function() {
    // Confetti celebration
    confetti({
        particleCount: 100,
        spread: 70,
        origin: { y: 0.6 }
    });
    
    // Second burst after delay
    setTimeout(function() {
        confetti({
            particleCount: 50,
            angle: 60,
            spread: 55,
            origin: { x: 0 }
        });
        confetti({
            particleCount: 50,
            angle: 120,
            spread: 55,
            origin: { x: 1 }
        });
    }, 250);
});

// Social sharing functions
function shareTwitter() {
    const text = `Just registered for {{ tournament.title }}! üéÆüî•`;
    const url = window.location.origin + "{% url 'tournaments:detail' tournament.slug %}";
    window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`, '_blank');
}

function shareFacebook() {
    const url = window.location.origin + "{% url 'tournaments:detail' tournament.slug %}";
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`, '_blank');
}

function shareDiscord() {
    alert('Copy the tournament link and share it in your Discord server!');
}
</script>
{% endblock %}
