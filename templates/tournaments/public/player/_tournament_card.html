{% load static %}
{# Tournament card for player dashboard - shows registration status and quick actions #}
{% with tournament=registration.tournament %}
<article class="glass p-6 rounded-2xl hover:scale-[1.02] transition-transform duration-200">
  <!-- Tournament Header -->
  <div class="flex items-start justify-between mb-4">
    <div class="flex-1">
      <a href="{% url 'tournaments:detail' tournament.slug %}" class="link-nav text-lg font-bold block mb-1 hover:text-primary transition">
        {{ tournament.name }}
      </a>
      {% if tournament.game %}
        <div class="flex items-center gap-2 text-sm text-muted">
          <span class="px-2 py-1 rounded-lg bg-primary/10 text-primary">
            {{ tournament.game.name }}
          </span>
        </div>
      {% endif %}
    </div>
    
    <!-- Registration Status Badge -->
    <span class="px-3 py-1 rounded-full text-xs font-semibold
      {% if registration.status == 'confirmed' %}bg-green-600/20 text-green-400
      {% elif registration.status == 'payment_submitted' %}bg-yellow-600/20 text-yellow-400
      {% elif registration.status == 'pending' %}bg-blue-600/20 text-blue-400
      {% elif registration.status == 'rejected' %}bg-red-600/20 text-red-400
      {% elif registration.status == 'cancelled' %}bg-gray-600/20 text-gray-400
      {% elif registration.status == 'no_show' %}bg-orange-600/20 text-orange-400
      {% else %}bg-gray-600/20 text-gray-400{% endif %}">
      {{ registration.get_status_display }}
    </span>
  </div>

  <!-- Tournament Info Grid -->
  <div class="grid grid-cols-2 gap-3 mb-4 text-sm">
    <div>
      <p class="text-muted text-xs mb-1">Format</p>
      <p class="font-medium">
        {% if tournament.tournament_type == 'single_elimination' %}Single Elimination
        {% elif tournament.tournament_type == 'double_elimination' %}Double Elimination
        {% elif tournament.tournament_type == 'round_robin' %}Round Robin
        {% elif tournament.tournament_type == 'swiss' %}Swiss
        {% elif tournament.tournament_type == 'group_stage_playoff' %}Groups + Playoffs
        {% else %}{{ tournament.tournament_type|title }}{% endif %}
      </p>
    </div>
    <div>
      <p class="text-muted text-xs mb-1">Start Date</p>
      <p class="font-medium">
        {% if tournament.tournament_start %}
          {{ tournament.tournament_start|date:"M d, Y" }}
        {% else %}
          TBA
        {% endif %}
      </p>
    </div>
    <div>
      <p class="text-muted text-xs mb-1">Participants</p>
      <p class="font-medium">{{ tournament.confirmed_count|default:0 }}/{{ tournament.max_participants|default:"∞" }}</p>
    </div>
    <div>
      <p class="text-muted text-xs mb-1">Prize Pool</p>
      <p class="font-medium text-accent">
        {% if tournament.prize_pool_bdt %}
          ৳{{ tournament.prize_pool_bdt|floatformat:0 }}
        {% else %}
          —
        {% endif %}
      </p>
    </div>
  </div>

  <!-- Check-in Status (if applicable) -->
  {% if registration.checked_in %}
    <div class="mb-4 p-2 rounded-lg bg-green-600/10 border border-green-600/20 text-sm">
      <i class="fas fa-check-circle text-green-400 mr-2"></i>
      <span class="text-green-400">Checked In</span>
      {% if registration.checked_in_at %}
        <span class="text-muted text-xs ml-1">• {{ registration.checked_in_at|date:"M d, g:i A" }}</span>
      {% endif %}
    </div>
  {% elif tournament.status in 'live,ongoing,group_stage,playoffs' and not registration.checked_in %}
    <div class="mb-4 p-2 rounded-lg bg-yellow-600/10 border border-yellow-600/20 text-sm">
      <i class="fas fa-exclamation-triangle text-yellow-400 mr-2"></i>
      <span class="text-yellow-400">Check-in Required</span>
    </div>
  {% endif %}

  <!-- Next Match Info (if available) -->
  {% with next_match=tournament.matches.all.0 %}
    {% if next_match and next_match.scheduled_time %}
      <div class="mb-4 p-3 rounded-lg bg-primary/5 border border-primary/20">
        <p class="text-xs text-muted mb-1">Next Match</p>
        <div class="flex items-center justify-between">
          <span class="text-sm font-medium">Round {{ next_match.round_number }}</span>
          <span class="text-xs text-muted">{{ next_match.scheduled_time|date:"M d, g:i A" }}</span>
        </div>
      </div>
    {% endif %}
  {% endwith %}

  <!-- Action Buttons -->
  <div class="flex gap-2">
    <a href="{% url 'tournaments:detail' tournament.slug %}" class="flex-1 btn-secondary text-center">
      <i class="fas fa-info-circle mr-1"></i>
      View Tournament
    </a>
    
    {% comment %}
    <!-- Future: Lobby button (FE-T-007, currently blocked) -->
    {% if registration.is_confirmed and tournament.status in 'live,ongoing,group_stage,playoffs' %}
      <a href="#" class="flex-1 btn-primary text-center" title="Tournament lobby coming soon">
        <i class="fas fa-users mr-1"></i>
        Lobby
      </a>
    {% endif %}
    {% endcomment %}
  </div>
</article>
{% endwith %}
