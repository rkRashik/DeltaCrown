{% comment %}
  Hub Tab: Support & Disputes
  Full support system — contact organizer, file disputes, get help.
  Server-rendered (context data available directly — no separate API fetch needed).
{% endcomment %}

<div class="p-6 lg:p-8 space-y-8 min-h-[80vh]">

  {% comment %}── Section Header ─────────────────────────────{% endcomment %}
  <div>
    <h2 class="text-2xl font-black text-white tracking-tight" style="font-family:Outfit,sans-serif;">
      <i data-lucide="life-buoy" class="w-6 h-6 inline-block text-[var(--game-primary)] mr-2 align-text-bottom"></i>
      Support & Disputes
    </h2>
    <p class="text-xs text-gray-500 mt-1" style="font-family:'Space Grotesk',monospace;">Get help, contact the organizer, or file a dispute</p>
  </div>

  {% comment %}── Quick Actions ──────────────────────────────{% endcomment %}
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">

    {% if contact_email %}
    <a href="mailto:{{ contact_email }}?subject=Tournament%20Support%20-%20{{ tournament.name|urlencode }}"
       class="support-action-card group">
      <div class="support-action-icon bg-[var(--game-primary)]/15">
        <i data-lucide="mail" class="w-5 h-5 text-[var(--game-primary)]"></i>
      </div>
      <div class="flex-1 min-w-0">
        <p class="text-sm font-bold text-white group-hover:text-[var(--game-primary)] transition-colors">Email Organizer</p>
        <p class="text-[10px] text-gray-500 truncate">{{ contact_email }}</p>
      </div>
      <i data-lucide="external-link" class="w-3.5 h-3.5 text-gray-600 group-hover:text-[var(--game-primary)] transition-colors"></i>
    </a>
    {% endif %}

    {% if discord_url %}
    <a href="{{ discord_url }}" target="_blank" rel="noopener"
       class="support-action-card group">
      <div class="support-action-icon bg-[#5865F2]/15">
        <i data-lucide="message-circle" class="w-5 h-5 text-[#5865F2]"></i>
      </div>
      <div class="flex-1 min-w-0">
        <p class="text-sm font-bold text-white group-hover:text-[#5865F2] transition-colors">Discord Server</p>
        <p class="text-[10px] text-gray-500">Fastest way to get help</p>
      </div>
      <i data-lucide="external-link" class="w-3.5 h-3.5 text-gray-600 group-hover:text-[#5865F2] transition-colors"></i>
    </a>
    {% endif %}

    {% if social_twitter %}
    <a href="{{ social_twitter }}" target="_blank" rel="noopener"
       class="support-action-card group">
      <div class="support-action-icon bg-[#1DA1F2]/15">
        <i data-lucide="twitter" class="w-5 h-5 text-[#1DA1F2]"></i>
      </div>
      <div class="flex-1 min-w-0">
        <p class="text-sm font-bold text-white group-hover:text-[#1DA1F2] transition-colors">X / Twitter</p>
        <p class="text-[10px] text-gray-500">DM for quick inquiries</p>
      </div>
      <i data-lucide="external-link" class="w-3.5 h-3.5 text-gray-600 group-hover:text-[#1DA1F2] transition-colors"></i>
    </a>
    {% endif %}
  </div>

  {% comment %}── Organizer Card & Dispute Form ──────────────{% endcomment %}
  <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">

    {% comment %}── Organizer Info Card (2 cols) ──{% endcomment %}
    <div class="lg:col-span-2 space-y-5">

      {% comment %}Organizer Profile{% endcomment %}
      <div class="hub-glass rounded-xl p-5 border border-white/5">
        <p class="text-[10px] font-black text-gray-500 uppercase tracking-widest mb-4">
          <i data-lucide="shield-check" class="w-3 h-3 inline-block mr-1 align-text-bottom"></i>
          Tournament Organizer
        </p>
        <div class="flex items-center gap-4 mb-4">
          <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-[var(--game-primary)]/20 to-[#7000FF]/20 border border-white/10 flex items-center justify-center">
            {% if tournament.organizer.profile.avatar %}
              <img src="{{ tournament.organizer.profile.avatar.url }}" class="w-full h-full rounded-xl object-cover" alt="{{ organizer_name }}">
            {% else %}
              <i data-lucide="user" class="w-6 h-6 text-[var(--game-primary)]"></i>
            {% endif %}
          </div>
          <div>
            <p class="text-base font-bold text-white" style="font-family:Outfit,sans-serif;">{{ organizer_name }}</p>
            <p class="text-[10px] text-gray-500 uppercase tracking-widest">Official Organizer</p>
          </div>
        </div>

        {% if contact_email %}
        <div class="flex items-center gap-3 p-3 rounded-lg bg-white/[0.02] border border-white/5 mb-2">
          <i data-lucide="mail" class="w-4 h-4 text-gray-500 shrink-0"></i>
          <span class="text-xs text-gray-300 truncate">{{ contact_email }}</span>
        </div>
        {% endif %}

        {% if social_website %}
        <div class="flex items-center gap-3 p-3 rounded-lg bg-white/[0.02] border border-white/5 mb-2">
          <i data-lucide="globe" class="w-4 h-4 text-gray-500 shrink-0"></i>
          <a href="{{ social_website }}" target="_blank" rel="noopener" class="text-xs text-[var(--game-primary)] hover:text-white transition-colors truncate">{{ social_website }}</a>
        </div>
        {% endif %}
      </div>

      {% comment %}Response Time / SLA Info{% endcomment %}
      <div class="hub-glass rounded-xl p-5 border border-white/5">
        <p class="text-[10px] font-black text-gray-500 uppercase tracking-widest mb-4">
          <i data-lucide="clock" class="w-3 h-3 inline-block mr-1 align-text-bottom"></i>
          Expected Response
        </p>
        <div class="space-y-3">
          <div class="flex items-center justify-between">
            <span class="text-xs text-gray-400">General Inquiries</span>
            <span class="text-xs font-bold text-white">24–48 hours</span>
          </div>
          <div class="h-px bg-white/5"></div>
          <div class="flex items-center justify-between">
            <span class="text-xs text-gray-400">Disputes</span>
            <span class="text-xs font-bold text-[#FFB800]">Within 24 hours</span>
          </div>
          <div class="h-px bg-white/5"></div>
          <div class="flex items-center justify-between">
            <span class="text-xs text-gray-400">Urgent / Live Match</span>
            <span class="text-xs font-bold text-[#FF2A55]">ASAP (use Discord)</span>
          </div>
        </div>
      </div>

      {% comment %}Guidelines{% endcomment %}
      <div class="hub-glass rounded-xl p-5 border border-white/5">
        <p class="text-[10px] font-black text-gray-500 uppercase tracking-widest mb-3">
          <i data-lucide="info" class="w-3 h-3 inline-block mr-1 align-text-bottom"></i>
          Guidelines
        </p>
        <ul class="space-y-2 text-xs text-gray-400 leading-relaxed">
          <li class="flex items-start gap-2">
            <span class="text-[var(--game-primary)] mt-0.5">•</span>
            <span>Be respectful and provide clear details about your issue</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-[var(--game-primary)] mt-0.5">•</span>
            <span>Include match IDs, timestamps, or screenshots when reporting disputes</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-[var(--game-primary)] mt-0.5">•</span>
            <span>Dispute decisions by the organizer are final. Repeated and frivolous disputes may result in penalties</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-[var(--game-primary)] mt-0.5">•</span>
            <span>For live match issues, use Discord for the fastest response</span>
          </li>
        </ul>
      </div>
    </div>

    {% comment %}── Contact / Dispute Form (3 cols) ──{% endcomment %}
    <div class="lg:col-span-3 space-y-5">

      {% comment %}Contact / Dispute Form{% endcomment %}
      <div class="hub-glass rounded-xl border border-white/5 overflow-hidden">
        <div class="relative p-5 border-b border-white/5">
          <div class="absolute inset-0 bg-gradient-to-b from-[var(--game-primary)]/5 to-transparent pointer-events-none"></div>
          <div class="relative flex items-center gap-3">
            <div class="w-10 h-10 rounded-xl bg-[var(--game-primary)]/10 border border-[var(--game-primary)]/20 flex items-center justify-center">
              <i data-lucide="send" class="w-5 h-5 text-[var(--game-primary)]"></i>
            </div>
            <div>
              <h3 class="text-base font-bold text-white" style="font-family:Outfit,sans-serif;">Send a Message</h3>
              <p class="text-[10px] text-gray-500">Contact the organizer or file a dispute</p>
            </div>
          </div>
        </div>

        <div class="p-5 space-y-4">
          {% comment %}Category Selection{% endcomment %}
          <div>
            <label class="text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2 block">Category</label>
            <div class="grid grid-cols-2 gap-2" id="support-categories">
              <button type="button" class="support-category-btn active" data-category="general" onclick="HubEngine.selectSupportCategory('general')">
                <i data-lucide="help-circle" class="w-4 h-4"></i>
                <span>General Inquiry</span>
              </button>
              <button type="button" class="support-category-btn" data-category="dispute" onclick="HubEngine.selectSupportCategory('dispute')">
                <i data-lucide="alert-triangle" class="w-4 h-4"></i>
                <span>Match Dispute</span>
              </button>
              <button type="button" class="support-category-btn" data-category="technical" onclick="HubEngine.selectSupportCategory('technical')">
                <i data-lucide="bug" class="w-4 h-4"></i>
                <span>Technical Issue</span>
              </button>
              <button type="button" class="support-category-btn" data-category="payment" onclick="HubEngine.selectSupportCategory('payment')">
                <i data-lucide="credit-card" class="w-4 h-4"></i>
                <span>Payment / Prize</span>
              </button>
            </div>
          </div>

          {% comment %}Dispute-specific: Match selector{% endcomment %}
          <div id="support-dispute-fields" class="hidden space-y-3">
            <div>
              <label class="text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2 block">Match Reference</label>
              <input type="text" id="support-match-ref" placeholder="e.g. Round 1 — Match #3 or Match ID"
                     class="support-input w-full">
            </div>
          </div>

          {% comment %}Subject{% endcomment %}
          <div>
            <label class="text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2 block">Subject</label>
            <input type="text" id="support-subject" placeholder="Brief description of your issue"
                   class="support-input w-full" maxlength="200">
          </div>

          {% comment %}Message{% endcomment %}
          <div>
            <label class="text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2 block">Message</label>
            <textarea id="support-message" rows="5" placeholder="Describe your issue in detail. Include screenshots links if applicable."
                      class="support-input w-full resize-none" maxlength="2000"></textarea>
            <div class="flex items-center justify-between mt-1">
              <span class="text-[10px] text-gray-600" id="support-char-count">0 / 2000</span>
            </div>
          </div>

          {% comment %}Error / Success Messages{% endcomment %}
          <div id="support-error" class="hidden p-3 rounded-lg bg-[#FF2A55]/10 border border-[#FF2A55]/20 text-xs text-[#FF2A55] font-medium"></div>
          <div id="support-success" class="hidden p-3 rounded-lg bg-[#00FF66]/10 border border-[#00FF66]/20 text-xs text-[#00FF66] font-medium"></div>

          {% comment %}Submit{% endcomment %}
          <button id="support-submit-btn" onclick="HubEngine.submitSupportRequest()"
                  class="w-full px-4 py-3 rounded-xl bg-[var(--game-primary)]/15 hover:bg-[var(--game-primary)]/25 border border-[var(--game-primary)]/20 hover:border-[var(--game-primary)]/40 text-[var(--game-primary)] font-bold text-sm transition-all flex items-center justify-center gap-2">
            <i data-lucide="send" class="w-4 h-4"></i>
            Send Message
          </button>
        </div>
      </div>

      {% comment %}Previous Tickets / Messages{% endcomment %}
      <div class="hub-glass rounded-xl p-5 border border-white/5">
        <p class="text-[10px] font-black text-gray-500 uppercase tracking-widest mb-4">
          <i data-lucide="inbox" class="w-3 h-3 inline-block mr-1 align-text-bottom"></i>
          Your Tickets
        </p>
        <div id="support-tickets-list">
          <div class="text-center py-8">
            <i data-lucide="inbox" class="w-8 h-8 text-gray-700 mx-auto mb-2"></i>
            <p class="text-xs text-gray-500">No support tickets yet</p>
            <p class="text-[10px] text-gray-600 mt-1">Tickets you submit will appear here</p>
          </div>
        </div>
      </div>

      {% comment %}FAQ{% endcomment %}
      <div class="hub-glass rounded-xl p-5 border border-white/5">
        <p class="text-[10px] font-black text-gray-500 uppercase tracking-widest mb-4">
          <i data-lucide="help-circle" class="w-3 h-3 inline-block mr-1 align-text-bottom"></i>
          Frequently Asked Questions
        </p>
        <div class="space-y-2">
          <details class="support-faq-item group">
            <summary class="cursor-pointer flex items-center justify-between p-3 rounded-lg hover:bg-white/[0.03] transition-colors">
              <span class="text-sm font-medium text-gray-300 group-open:text-white">How do I check in for my match?</span>
              <i data-lucide="chevron-down" class="w-4 h-4 text-gray-600 group-open:rotate-180 transition-transform"></i>
            </summary>
            <div class="px-3 pb-3 text-xs text-gray-400 leading-relaxed">
              When your match is ready, you'll see a "Check In" notification on the Overview tab. Click the check-in button within the allowed time window. Both teams must check in for the match to begin.
            </div>
          </details>
          <details class="support-faq-item group">
            <summary class="cursor-pointer flex items-center justify-between p-3 rounded-lg hover:bg-white/[0.03] transition-colors">
              <span class="text-sm font-medium text-gray-300 group-open:text-white">How do I file a dispute?</span>
              <i data-lucide="chevron-down" class="w-4 h-4 text-gray-600 group-open:rotate-180 transition-transform"></i>
            </summary>
            <div class="px-3 pb-3 text-xs text-gray-400 leading-relaxed">
              Select "Match Dispute" as the category above, enter the match reference, and describe the issue with evidence. The organizer will review your dispute within 24 hours.
            </div>
          </details>
          <details class="support-faq-item group">
            <summary class="cursor-pointer flex items-center justify-between p-3 rounded-lg hover:bg-white/[0.03] transition-colors">
              <span class="text-sm font-medium text-gray-300 group-open:text-white">Can I swap players during the tournament?</span>
              <i data-lucide="chevron-down" class="w-4 h-4 text-gray-600 group-open:rotate-180 transition-transform"></i>
            </summary>
            <div class="px-3 pb-3 text-xs text-gray-400 leading-relaxed">
              Yes, team captains can swap starters and substitutes from the Squad tab, as long as the roster isn't locked. Check the tournament rules for specific substitution policies.
            </div>
          </details>
          <details class="support-faq-item group">
            <summary class="cursor-pointer flex items-center justify-between p-3 rounded-lg hover:bg-white/[0.03] transition-colors">
              <span class="text-sm font-medium text-gray-300 group-open:text-white">When will I receive my prize?</span>
              <i data-lucide="chevron-down" class="w-4 h-4 text-gray-600 group-open:rotate-180 transition-transform"></i>
            </summary>
            <div class="px-3 pb-3 text-xs text-gray-400 leading-relaxed">
              Prizes are distributed after the tournament concludes. Go to the Prizes tab to claim your prize and provide your payout details. Processing times vary by payment method.
            </div>
          </details>
        </div>
      </div>
    </div>
  </div>

</div>
