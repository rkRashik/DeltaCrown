{% comment %}
  Tab: Squad Management — Full roster view, passport status, warnings
  Only shown for team tournaments.
{% endcomment %}

<div class="p-4 md:p-8 lg:p-10 max-w-[1200px] mx-auto space-y-8">

  {% comment %}── Header ──────────────────────────────────────────────────{% endcomment %}
  <div class="flex items-center justify-between border-b border-white/5 pb-6">
    <div>
      <h2 class="font-black text-2xl lg:text-3xl text-white" style="font-family:Outfit,sans-serif;">
        {% if is_team %}Squad Management{% else %}Participant Info{% endif %}
      </h2>
      <p class="text-sm text-gray-400 mt-1">
        {% if is_team %}Manage your roster, verify Game IDs, and ensure readiness.
        {% else %}Your registration details and readiness status.{% endif %}
      </p>
    </div>
    {% if is_team %}
    <div class="flex items-center gap-2 text-xs">
      <span class="text-gray-500">Roster:</span>
      <span class="font-bold {% if starters|length >= min_roster %}text-[#00FF66]{% else %}text-[#FF2A55]{% endif %}">
        {{ starters|length }}/{{ min_roster }} min
      </span>
      <span class="text-gray-600">&middot;</span>
      <span class="text-gray-400">{{ squad|length }}/{{ max_roster }} max</span>
    </div>
    {% endif %}
  </div>

  {% if is_team %}
  {% if squad_warnings %}
  <div class="bg-[#FFB800]/10 border border-[#FFB800]/20 rounded-2xl p-5">
    <div class="flex items-start gap-3">
      <div class="w-8 h-8 rounded-full bg-[#FFB800]/20 flex items-center justify-center text-[#FFB800] shrink-0 mt-0.5">
        <i data-lucide="alert-triangle" class="w-4 h-4"></i>
      </div>
      <div>
        <h4 class="text-sm font-bold text-white mb-2">{{ squad_warnings|length }} Issue{{ squad_warnings|length|pluralize }} Found</h4>
        <ul class="space-y-1">
          {% for warning in squad_warnings %}
          <li class="text-xs text-[#FFB800] flex items-center gap-2">
            <span class="w-1 h-1 rounded-full bg-[#FFB800]"></span> {{ warning }}
          </li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
  {% endif %}
  <div>
    <h3 class="text-xs font-black text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2">
      <i data-lucide="crosshairs" class="w-4 h-4 text-[#00F0FF]"></i>
      Starting Lineup
      <span class="text-gray-600">({{ starters|length }})</span>
    </h3>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      {% for member in starters %}
      <div class="hub-glass rounded-xl p-4 flex items-center gap-4 roster-starter hub-glass-hover">
        {% comment %}Avatar{% endcomment %}
        <div class="w-12 h-12 rounded-lg bg-[#08080C] overflow-hidden border border-white/10 shrink-0">
          <img src="{{ member.avatar_url }}" class="w-full h-full object-cover" alt="{{ member.display_name }}">
        </div>

        {% comment %}Info{% endcomment %}
        <div class="flex-1 min-w-0">
          <div class="flex items-center gap-2 mb-0.5">
            <span class="text-sm font-bold text-white truncate">{{ member.display_name }}</span>
            {% if member.is_captain %}
              <span class="px-1.5 py-0.5 rounded bg-[#FFB800]/20 text-[#FFB800] text-[8px] font-black uppercase">Captain</span>
            {% endif %}
          </div>

          {% comment %}Game ID / Passport{% endcomment %}
          {% if member.game_id %}
            <p class="text-xs text-[#00F0FF] truncate" style="font-family:'Space Grotesk',monospace;">
              {{ member.game_id }}
            </p>
          {% else %}
            <p class="text-xs text-[#FF2A55] flex items-center gap-1">
              <i data-lucide="alert-circle" class="w-3 h-3"></i> Missing Game ID
            </p>
          {% endif %}
        </div>

        {% comment %}Role badge{% endcomment %}
        <div class="shrink-0 text-right">
          <span class="text-[9px] font-bold text-gray-500 uppercase tracking-widest block">
            {{ member.player_role|default:"Player" }}
          </span>
          {% if member.has_passport %}
            <span class="w-2 h-2 bg-[#00FF66] rounded-full inline-block shadow-[0_0_5px_#00FF66] mt-1"></span>
          {% else %}
            <span class="w-2 h-2 bg-[#FF2A55] rounded-full inline-block shadow-[0_0_5px_#FF2A55] mt-1"></span>
          {% endif %}
        </div>
      </div>
      {% empty %}
      <div class="hub-glass rounded-xl p-6 text-center col-span-2">
        <p class="text-sm text-gray-500">No starters assigned yet.</p>
      </div>
      {% endfor %}
    </div>
  </div>
  {% if subs %}
  <div>
    <h3 class="text-xs font-black text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2">
      <i data-lucide="refresh-cw" class="w-4 h-4 text-[#FFB800]"></i>
      Substitutes
      <span class="text-gray-600">({{ subs|length }})</span>
    </h3>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      {% for member in subs %}
      <div class="hub-glass rounded-xl p-4 flex items-center gap-4 roster-sub hub-glass-hover opacity-80">
        <div class="w-10 h-10 rounded-lg bg-[#08080C] overflow-hidden border border-white/10 shrink-0">
          <img src="{{ member.avatar_url }}" class="w-full h-full object-cover" alt="{{ member.display_name }}">
        </div>
        <div class="flex-1 min-w-0">
          <span class="text-sm font-medium text-gray-300 truncate block">{{ member.display_name }}</span>
          {% if member.game_id %}
            <span class="text-xs text-gray-500" style="font-family:'Space Grotesk',monospace;">{{ member.game_id }}</span>
          {% else %}
            <span class="text-xs text-[#FF2A55]">No Game ID</span>
          {% endif %}
        </div>
        <span class="text-[9px] font-bold text-[#FFB800] uppercase tracking-widest">SUB</span>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}
  {% if coaches %}
  <div>
    <h3 class="text-xs font-black text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2">
      <i data-lucide="graduation-cap" class="w-4 h-4 text-[#7000FF]"></i>
      Coaching Staff
      <span class="text-gray-600">({{ coaches|length }})</span>
    </h3>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      {% for member in coaches %}
      <div class="hub-glass rounded-xl p-4 flex items-center gap-4 roster-coach hub-glass-hover opacity-80">
        <div class="w-10 h-10 rounded-lg bg-[#08080C] overflow-hidden border border-white/10 shrink-0">
          <img src="{{ member.avatar_url }}" class="w-full h-full object-cover" alt="{{ member.display_name }}">
        </div>
        <div class="flex-1 min-w-0">
          <span class="text-sm font-medium text-gray-300 truncate block">{{ member.display_name }}</span>
        </div>
        <span class="text-[9px] font-bold text-[#7000FF] uppercase tracking-widest">COACH</span>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}

  {% else %}
  {% comment %}── Solo participant info ────────────────────────────────────{% endcomment %}
  <div class="hub-glass rounded-2xl p-8 text-center">
    <div class="w-16 h-16 rounded-2xl bg-[#7000FF]/10 border border-[#7000FF]/20 flex items-center justify-center mx-auto mb-4">
      <i data-lucide="user" class="w-8 h-8 text-[#7000FF]"></i>
    </div>
    <h3 class="text-lg font-bold text-white mb-2" style="font-family:Outfit,sans-serif;">Solo Participant</h3>
    <p class="text-sm text-gray-400 max-w-md mx-auto">
      You're competing as an individual in this tournament.
      Your registration status is <strong class="text-white">{{ user_status }}</strong>.
    </p>
  </div>
  {% endif %}

</div>
