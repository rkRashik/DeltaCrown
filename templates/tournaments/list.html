{% extends "base.html" %}
{% load static %}
{% block title %}{{ game_name|default:"Tournaments" }} - Tournaments | DeltaCrown{% endblock %}

{% block content %}
<main id="tournaments-list" class="min-h-screen">
  <!-- Header -->
  <section class="container mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pt-10 pb-4">
    <nav class="text-white/70 text-sm">
      <a class="hover:underline" href="/tournaments/">Games</a>
      <span>-</span>
      <span class="text-white">{{ game_name|default:"All" }}</span>
    </nav>
    <div class="mt-2 grid gap-3 lg:grid-cols-2 lg:items-end">
      <h1 class="text-3xl font-extrabold tracking-tight text-white">{{ game_name|default:"All tournaments" }}</h1>
      <form method="get" id="t-filter" class="flex flex-wrap items-center justify-start lg:justify-end gap-2">
        <input type="text" name="q" value="{{ q }}" placeholder="Search tournaments..." class="input input-sm w-48">
        <select name="status" class="input input-sm">
          <option value="">Any status</option>
          <option value="ongoing" {% if status == 'ongoing' %}selected{% endif %}>Ongoing</option>
          <option value="upcoming" {% if status == 'upcoming' %}selected{% endif %}>Upcoming</option>
          <option value="past" {% if status == 'past' %}selected{% endif %}>Past</option>
        </select>
        <select name="entry" class="input input-sm">
          <option value="">Any entry</option>
          <option value="paid" {% if entry == 'paid' %}selected{% endif %}>Paid</option>
        </select>
        <select name="sort" class="input input-sm">
          <option value="new" {% if sort == '' or sort == 'new' %}selected{% endif %}>Newest</option>
          <option value="start" {% if sort == 'start' %}selected{% endif %}>Start time</option>
          <option value="prize" {% if sort == 'prize' %}selected{% endif %}>Prize pool</option>
          <option value="entry" {% if sort == 'entry' %}selected{% endif %}>Entry fee</option>
        </select>
        <button class="btn btn-secondary btn-sm" type="submit">Apply</button>
        <a href="." class="btn btn-ghost btn-sm">Reset</a>
      </form>
    </div>
  </section>

  <!-- Grid -->
  <section class="container mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-12" id="grid-root">
    {% include "tournaments/partials/_grid.html" %}

    <!-- Pagination -->
    {% if page_obj %}
    <div class="mt-8 flex items-center justify-center gap-2">
      {% if page_obj.has_previous %}
        <a class="btn btn-ghost" href="?{% if request.GET.status %}status={{ request.GET.status }}&{% endif %}page={{ page_obj.previous_page_number }}">Prev</a>
      {% else %}
        <span class="btn btn-ghost opacity-40 pointer-events-none">Prev</span>
      {% endif %}

      <span class="px-3 py-2 rounded-xl bg-white/5 ring-1 ring-white/10 text-white/80">
        Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
      </span>

      {% if page_obj.has_next %}
        <a class="btn btn-ghost" href="?{% if request.GET.status %}status={{ request.GET.status }}&{% endif %}page={{ page_obj.next_page_number }}">Next</a>
      {% else %}
        <span class="btn btn-ghost opacity-40 pointer-events-none">Next</span>
      {% endif %}
    </div>
    {% endif %}
  </section>
</main>
{% endblock %}
