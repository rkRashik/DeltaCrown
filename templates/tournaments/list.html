{% extends "base.html" %}
{% block title %}Tournaments — DeltaCrown{% endblock %}

{% block content %}
{% meta_tags title="Tournaments — DeltaCrown" description="Browse upcoming and ongoing esports tournaments in Bangladesh." %}

<section aria-labelledby="h1" data-testid="tournaments-index">
  <header class="d-flex align-items-center justify-content-between">
    <div>
      <h1 class="mb-3">Tournaments</h1>
      <p class="text-muted mb-0">Find events to join, check rules, and compete.</p>
    </div>
    <div class="d-flex gap-2">
      <!-- If your create URL name differs, this literal keeps the template safe -->
      <a class="btn btn-primary" href="/tournaments/create/">Create Tournament</a>
    </div>
  </header>

  <!-- Optional search/filter shell (non-breaking; works even if view ignores it) -->
  <form class="card p-3 mb-3" method="get" action="">
    <div class="form-field">
      <label class="label" for="q">Search tournaments</label>
      <input id="q" name="q" value="{{ request.GET.q }}" placeholder="Name, game, or format" />
      <div class="help">Press Enter to search</div>
    </div>
  </form>

  {% if tournaments %}
    {% with items=tournaments %}
      <div class="d-flex flex-wrap g-3">
        {% for t in items %}
          <article class="card p-3" style="flex:1 1 340px;min-width:280px">
            <div class="fw-medium mb-1">
              <a href="{{ t.get_absolute_url|default:'/tournaments/'|add:t.slug|default:''|add:'/' }}">{{ t.name|default:"Tournament" }}</a>
            </div>
            <div class="text-muted mb-2" style="font-size:.9rem">
              {% if t.game_name %}{{ t.game_name }}{% elif t.game %}{{ t.game }}{% else %}Game: —{% endif %}
              {% if t.starts_at %} · Starts {{ t.starts_at|date:"M d, Y" }}{% endif %}
            </div>
            <div class="d-flex gap-2">
              <a class="btn btn-outline btn-sm" href="{{ t.get_absolute_url|default:'/tournaments/'|add:t.slug|default:''|add:'/' }}">Details</a>
              <a class="btn btn-primary btn-sm" href="/tournaments/{{ t.slug|urlencode }}/register/">Register</a>
            </div>
          </article>
        {% endfor %}
      </div>
    {% endwith %}
  {% elif object_list %}
    {% with items=object_list %}
      <div class="d-flex flex-wrap g-3">
        {% for t in items %}
          <article class="card p-3" style="flex:1 1 340px;min-width:280px">
            <div class="fw-medium mb-1">
              <a href="{{ t.get_absolute_url|default:'/tournaments/'|add:t.slug|default:''|add:'/' }}">{{ t.name|default:"Tournament" }}</a>
            </div>
            <div class="text-muted mb-2" style="font-size:.9rem">
              {% if t.game_name %}{{ t.game_name }}{% elif t.game %}{{ t.game }}{% else %}Game: —{% endif %}
              {% if t.starts_at %} · Starts {{ t.starts_at|date:"M d, Y" }}{% endif %}
            </div>
            <div class="d-flex gap-2">
              <a class="btn btn-outline btn-sm" href="{{ t.get_absolute_url|default:'/tournaments/'|add:t.slug|default:''|add:'/' }}">Details</a>
              <a class="btn btn-primary btn-sm" href="/tournaments/{{ t.slug|urlencode }}/register/">Register</a>
            </div>
          </article>
        {% endfor %}
      </div>
    {% endwith %}
  {% else %}
    <article class="card p-3">
      <div class="fw-medium mb-1">No tournaments found.</div>
      <p class="mb-0 text-muted">Check back soon or start one now.</p>
    </article>
  {% endif %}

  <div class="mt-3">
    {% include "partials/pagination.html" %}
  </div>
</section>
{% endblock %}
