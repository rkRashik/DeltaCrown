{# expects: t (Tournament-like), optional state dict #}
<article class="dc-card">
  <a href="{{ t.get_absolute_url|default:'#' }}" class="dc-card-media">
    {% if t.dc_banner_url %}
      <img src="{{ t.dc_banner_url }}" alt="{{ t.title }} banner" loading="lazy">
    {% else %}
      <div class="dc-card-fallback" aria-hidden="true"></div>
    {% endif %}
    {% if t.dc_status == 'live' %}
      <span class="dc-live">LIVE</span>
    {% endif %}
  </a>

  <div class="dc-card-body">
    <h3 class="dc-card-title">
      <a href="{{ t.get_absolute_url|default:'#' }}">{{ t.title|default:"Untitled Tournament" }}</a>
    </h3>

    <div class="dc-meta">
      {% if t.starts_at %}
        <span class="dc-chip-muted">Starts {{ t.starts_at|date:"M j, H:i" }}</span>
      {% endif %}
      {% if t.game %}
        <span class="dc-chip-muted">{{ t.game|title }}</span>
      {% endif %}
      {% if t.fee_amount is not None %}
        <span class="dc-chip-muted">{% if t.fee_amount == 0 %}Free{% else %}à§³{{ t.fee_amount }}{% endif %}</span>
      {% endif %}
    </div>

    <div class="dc-actions">
      <a class="dc-btn-secondary" href="{{ t.get_absolute_url|default:'#' }}">View</a>

      {# Registered/Continue/Receipt logic #}
      {% if state and state.registered %}
        {% if state.cta == 'continue' and state.cta_url %}
          <a class="dc-btn" href="{{ state.cta_url }}">Continue</a>
          <span class="dc-badge dc-badge-registered">Registered</span>
        {% elif state.cta == 'receipt' and state.cta_url %}
          <a class="dc-btn" href="{{ state.cta_url }}">Receipt</a>
          <span class="dc-badge dc-badge-registered">Registered</span>
        {% else %}
          <button class="dc-btn" disabled>Registered</button>
        {% endif %}
      {% else %}
        {% if t.dc_status == 'open' or t.dc_status == 'opening' or t.dc_status == 'filling' %}
          <a class="dc-btn" href="{{ t.dc_register_url|default:'#' }}">Register</a>
        {% else %}
          <button class="dc-btn" disabled>{{ t.dc_status|default:"Closed"|title }}</button>
        {% endif %}
      {% endif %}
    </div>
  </div>
</article>
