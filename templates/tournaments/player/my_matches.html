{% extends "base.html" %}
{% load static %}

{% block title %}My Matches â€” DeltaCrown{% endblock %}

{% block content %}
<section class="container py-8">
  <!-- Page Header -->
  <div class="flex items-center justify-between mb-6">
    <div>
      <h1 class="sec-h">My Matches</h1>
      <p class="text-muted mt-1">Your scheduled and completed matches across all tournaments</p>
    </div>
    <a href="{% url 'tournaments:my_tournaments' %}" class="btn-secondary">
      <i class="fas fa-trophy mr-2"></i>My Tournaments
    </a>
  </div>

  <!-- Filter Tabs -->
  <div class="glass rounded-xl p-1 mb-6 inline-flex">
    <a href="?status=all" class="px-4 py-2 rounded-lg {% if filter_status == 'all' %}bg-primary text-white{% else %}text-muted hover:text-white transition{% endif %}">
      All Matches
    </a>
    <a href="?status=upcoming" class="px-4 py-2 rounded-lg {% if filter_status == 'upcoming' %}bg-primary text-white{% else %}text-muted hover:text-white transition{% endif %}">
      Upcoming
      {% if upcoming_count > 0 %}<span class="ml-1 px-2 py-0.5 rounded-full bg-blue-500/20 text-blue-400 text-xs">{{ upcoming_count }}</span>{% endif %}
    </a>
    <a href="?status=live" class="px-4 py-2 rounded-lg {% if filter_status == 'live' %}bg-primary text-white{% else %}text-muted hover:text-white transition{% endif %}">
      Live
      {% if live_count > 0 %}<span class="ml-1 px-2 py-0.5 rounded-full bg-red-500/20 text-red-400 text-xs animate-pulse">{{ live_count }}</span>{% endif %}
    </a>
    <a href="?status=completed" class="px-4 py-2 rounded-lg {% if filter_status == 'completed' %}bg-primary text-white{% else %}text-muted hover:text-white transition{% endif %}">
      Completed
      {% if completed_count > 0 %}<span class="ml-1 px-2 py-0.5 rounded-full bg-gray-500/20 text-gray-400 text-xs">{{ completed_count }}</span>{% endif %}
    </a>
  </div>

  <!-- Matches List -->
  {% if my_matches %}
    <div class="grid gap-4 mb-8">
      {% for match in my_matches %}
        {% include "tournaments/player/_match_card.html" with match=match user=request.user %}
      {% endfor %}
    </div>

    <!-- Pagination -->
    {% if is_paginated %}
      <nav class="flex items-center justify-center gap-2">
        {% if page_obj.has_previous %}
          <a href="?page=1&status={{ filter_status }}" class="px-3 py-2 glass rounded-lg hover:bg-primary/20 transition">
            <i class="fas fa-angle-double-left"></i>
          </a>
          <a href="?page={{ page_obj.previous_page_number }}&status={{ filter_status }}" class="px-3 py-2 glass rounded-lg hover:bg-primary/20 transition">
            <i class="fas fa-angle-left"></i>
          </a>
        {% endif %}

        <span class="px-4 py-2 glass rounded-lg">
          Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
        </span>

        {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}&status={{ filter_status }}" class="px-3 py-2 glass rounded-lg hover:bg-primary/20 transition">
            <i class="fas fa-angle-right"></i>
          </a>
          <a href="?page={{ page_obj.paginator.num_pages }}&status={{ filter_status }}" class="px-3 py-2 glass rounded-lg hover:bg-primary/20 transition">
            <i class="fas fa-angle-double-right"></i>
          </a>
        {% endif %}
      </nav>
    {% endif %}
  {% else %}
    <!-- Empty State -->
    {% include "tournaments/player/_empty_state.html" with type="matches" filter_status=filter_status %}
  {% endif %}
</section>
{% endblock %}
