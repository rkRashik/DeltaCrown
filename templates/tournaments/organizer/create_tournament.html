{% extends "base.html" %}
{% load static %}

{% block title %}Create Tournament - DeltaCrown{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'tournaments/organizer/css/organizer-glassmorphism.css' %}?v=1.0">
<style>
    body { background: #0f172a; }
    .create-tournament-container {
        min-height: 100vh;
        padding: 3rem 0;
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
    }
    .create-header {
        text-align: center;
        margin-bottom: 3rem;
    }
    .create-header h1 {
        font-size: 3rem;
        font-weight: 800;
        background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-primary) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 0.75rem;
    }
    .create-header p {
        font-size: 1.125rem;
        color: var(--text-muted);
    }
    .form-section {
        margin-bottom: 3rem;
    }
    .section-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 1.5rem;
        padding-bottom: 0.75rem;
        border-bottom: 2px solid var(--glass-border);
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }
    .section-icon {
        width: 2.5rem;
        height: 2.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--accent-primary);
        border-radius: var(--radius-md);
        color: white;
        font-size: 1.25rem;
    }
    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1.5rem;
    }
    .form-row-thirds {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 1.5rem;
    }
    .help-text {
        font-size: 0.8125rem;
        color: var(--text-muted);
        margin-top: 0.375rem;
    }
    .form-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 2rem;
        border-top: 1px solid var(--glass-border);
    }
    @media (max-width: 768px) {
        .form-row, .form-row-thirds {
            grid-template-columns: 1fr;
        }
    }
    .errorlist {
        list-style: none;
        padding: 0;
        margin: 0.5rem 0 0 0;
    }
    .errorlist li {
        color: var(--accent-danger);
        font-size: 0.875rem;
        margin-top: 0.25rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="create-tournament-container">
    <div class="container mx-auto px-4" style="max-width: 1000px;">
        <div class="create-header">
            <h1><i class="fas fa-trophy"></i> Create Tournament</h1>
            <p>Set up a new competitive tournament for your community</p>
        </div>

        {% if messages %}
        <div class="mb-6">
            {% for message in messages %}
            <div class="content-card" style="background: {% if message.tags == 'error' %}rgba(239, 68, 68, 0.1){% elif message.tags == 'success' %}rgba(16, 185, 129, 0.1){% else %}rgba(59, 130, 246, 0.1){% endif %}; border-color: {% if message.tags == 'error' %}rgba(239, 68, 68, 0.3){% elif message.tags == 'success' %}rgba(16, 185, 129, 0.3){% else %}rgba(59, 130, 246, 0.3){% endif %};">
                <div class="p-4 flex items-center gap-3">
                    <i class="fas fa-{% if message.tags == 'error' %}exclamation-circle{% elif message.tags == 'success' %}check-circle{% else %}info-circle{% endif %}"></i>
                    <span>{{ message }}</span>
                </div>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <form method="post" class="content-card">
            {% csrf_token %}
            <div class="card-body">
                <!-- Basic Information -->
                <div class="form-section">
                    <div class="section-title">
                        <div class="section-icon"><i class="fas fa-info-circle"></i></div>
                        <span>Basic Information</span>
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.name.id_for_label }}" class="form-label">Tournament Name *</label>
                        {{ form.name }}
                        {% if form.name.errors %}{{ form.name.errors }}{% endif %}
                        <div class="help-text">The full name of your tournament</div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="{{ form.slug.id_for_label }}" class="form-label">URL Slug *</label>
                            {{ form.slug }}
                            {% if form.slug.errors %}{{ form.slug.errors }}{% endif %}
                            <div class="help-text">Lowercase, hyphens only (e.g., winter-championship-2025)</div>
                        </div>
                        <div class="form-group">
                            <label for="{{ form.game.id_for_label }}" class="form-label">Game *</label>
                            {{ form.game }}
                            {% if form.game.errors %}{{ form.game.errors }}{% endif %}
                            <div class="help-text">Select the competitive game</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="{{ form.format_type.id_for_label }}" class="form-label">Tournament Format *</label>
                        {{ form.format_type }}
                        {% if form.format_type.errors %}{{ form.format_type.errors }}{% endif %}
                        <div class="help-text">Choose the bracket/competition format</div>
                    </div>
                </div>

                <!-- Schedule -->
                <div class="form-section">
                    <div class="section-title">
                        <div class="section-icon"><i class="fas fa-calendar-alt"></i></div>
                        <span>Schedule</span>
                    </div>
                    
                    <div class="form-row-thirds">
                        <div class="form-group">
                            <label for="{{ form.registration_start.id_for_label }}" class="form-label">Registration Opens *</label>
                            {{ form.registration_start }}
                            {% if form.registration_start.errors %}{{ form.registration_start.errors }}{% endif %}
                        </div>
                        <div class="form-group">
                            <label for="{{ form.registration_end.id_for_label }}" class="form-label">Registration Closes *</label>
                            {{ form.registration_end }}
                            {% if form.registration_end.errors %}{{ form.registration_end.errors %}{% endif %}
                        </div>
                        <div class="form-group">
                            <label for="{{ form.tournament_start.id_for_label }}" class="form-label">Tournament Starts *</label>
                            {{ form.tournament_start }}
                            {% if form.tournament_start.errors %}{{ form.tournament_start.errors }}{% endif %}
                        </div>
                    </div>
                </div>

                <!-- Participants & Prizes -->
                <div class="form-section">
                    <div class="section-title">
                        <div class="section-icon"><i class="fas fa-users"></i></div>
                        <span>Participants & Prizes</span>
                    </div>
                    
                    <div class="form-row-thirds">
                        <div class="form-group">
                            <label for="{{ form.max_participants.id_for_label }}" class="form-label">Max Participants *</label>
                            {{ form.max_participants }}
                            {% if form.max_participants.errors %}{{ form.max_participants.errors }}{% endif %}
                            <div class="help-text">Number of teams/players (4-128)</div>
                        </div>
                        <div class="form-group">
                            <label for="{{ form.entry_fee.id_for_label }}" class="form-label">Entry Fee (BDT) *</label>
                            {{ form.entry_fee }}
                            {% if form.entry_fee.errors %}{{ form.entry_fee.errors }}{% endif %}
                            <div class="help-text">Set to 0 for free tournaments</div>
                        </div>
                        <div class="form-group">
                            <label for="{{ form.prize_pool.id_for_label }}" class="form-label">Prize Pool (BDT) *</label>
                            {{ form.prize_pool }}
                            {% if form.prize_pool.errors %}{{ form.prize_pool.errors }}{% endif %}
                            <div class="help-text">Total prize money</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="flex items-center gap-2 cursor-pointer">
                            {{ form.is_official }}
                            <span class="text-secondary font-medium">Mark as Official Tournament</span>
                        </label>
                        <div class="help-text">Official tournaments appear with a verified badge and get priority placement</div>
                    </div>
                </div>

                <!-- Details -->
                <div class="form-section">
                    <div class="section-title">
                        <div class="section-icon"><i class="fas fa-file-alt"></i></div>
                        <span>Description & Rules</span>
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.description.id_for_label }}" class="form-label">Description</label>
                        {{ form.description }}
                        {% if form.description.errors %}{{ form.description.errors }}{% endif %}
                        <div class="help-text">Brief description of the tournament (optional)</div>
                    </div>

                    <div class="form-group">
                        <label for="{{ form.rules.id_for_label }}" class="form-label">Rules & Regulations</label>
                        {{ form.rules }}
                        {% if form.rules.errors %}{{ form.rules.errors }}{% endif %}
                        <div class="help-text">Tournament rules and guidelines (optional)</div>
                    </div>
                </div>

                {% if form.non_field_errors %}
                <div class="mb-6 p-4 bg-glass-elevated border border-danger rounded-lg">
                    {{ form.non_field_errors }}
                </div>
                {% endif %}

                <!-- Form Actions -->
                <div class="form-actions">
                    <a href="{% url 'tournaments:organizer_dashboard' %}" class="btn btn-secondary">
                        <i class="fas fa-times"></i> Cancel
                    </a>
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-plus-circle"></i> Create Tournament
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>
{% endblock %}
