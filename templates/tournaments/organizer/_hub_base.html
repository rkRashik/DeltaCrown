{% extends "tournaments/base.html" %}
{% load static humanize tournament_tags %}

{# ─────────────────────────────────────────────────────────
   Organizer Hub Base — Shared layout for all hub tabs
   Phase 4 Frontend Rebuild
   ───────────────────────────────────────────────────────── #}

{% block title %}{{ tournament.name }} — Hub | DeltaCrown{% endblock %}

{% block tournament_css %}
<script src="{% static 'tournaments/js/tournaments.js' %}" defer></script>
{% endblock %}

{% block tournament_content %}

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">

  {# ── Breadcrumb ── #}
  <div class="flex items-center gap-2 text-xs text-gray-500 mb-4">
    <a href="{% url 'tournaments:organizer_dashboard' %}" class="hover:text-white transition">Dashboard</a>
    <i data-lucide="chevron-right" class="w-3 h-3"></i>
    <a href="{% url 'tournaments:organizer_tournament_detail' tournament.slug %}" class="hover:text-white transition">{{ tournament.name|truncatewords:4 }}</a>
    <i data-lucide="chevron-right" class="w-3 h-3"></i>
    <span class="text-white capitalize">{{ active_tab }}</span>
  </div>

  {# ── Tournament header strip ── #}
  <div class="flex items-center gap-4 mb-6">
    <div class="w-10 h-10 rounded-lg bg-dc-surface border border-dc-border overflow-hidden flex-shrink-0">
      {% if tournament.thumbnail_image %}
        <img src="{{ tournament.thumbnail_image.url }}" class="w-full h-full object-cover">
      {% else %}
        <div class="w-full h-full flex items-center justify-center"><i data-lucide="trophy" class="w-5 h-5 text-gray-700"></i></div>
      {% endif %}
    </div>
    <div class="flex-1 min-w-0">
      <h1 class="font-display font-bold text-lg text-white truncate">{{ tournament.name }}</h1>
      <div class="flex items-center gap-2 mt-0.5">
        {% include "tournaments/components/_status_badge.html" with status=tournament.status %}
        <span class="text-[10px] text-gray-500">{{ tournament.game.display_name }}</span>
      </div>
    </div>
  </div>

  {# ── Hub Tab Navigation ── #}
  <div class="border-b border-dc-border mb-6 -mx-4 px-4 overflow-x-auto no-scrollbar">
    <div class="flex items-center gap-1">
      {% with slug=tournament.slug %}
      <a href="{% url 'tournaments:organizer_tournament_detail' slug %}"
         class="tab-btn{% if active_tab == 'overview' %} active{% endif %}">
        <i data-lucide="layout-dashboard" class="w-4 h-4 mr-1 inline"></i> Overview
      </a>
      <a href="{% url 'tournaments:organizer_hub' slug 'participants' %}"
         class="tab-btn{% if active_tab == 'participants' %} active{% endif %}">
        <i data-lucide="users" class="w-4 h-4 mr-1 inline"></i> Participants
      </a>
      <a href="{% url 'tournaments:organizer_hub' slug 'payments' %}"
         class="tab-btn{% if active_tab == 'payments' %} active{% endif %}">
        <i data-lucide="credit-card" class="w-4 h-4 mr-1 inline"></i> Payments
      </a>
      <a href="{% url 'tournaments:organizer_hub' slug 'brackets' %}"
         class="tab-btn{% if active_tab == 'brackets' %} active{% endif %}">
        <i data-lucide="git-merge" class="w-4 h-4 mr-1 inline"></i> Brackets
      </a>
      <a href="{% url 'tournaments:organizer_hub' slug 'disputes' %}"
         class="tab-btn{% if active_tab == 'disputes' %} active{% endif %}">
        <i data-lucide="alert-triangle" class="w-4 h-4 mr-1 inline"></i> Disputes
        {% if open_disputes_count %}<span class="ml-1 text-[10px] bg-red-600/20 text-red-400 px-1.5 py-0.5 rounded font-mono">{{ open_disputes_count }}</span>{% endif %}
      </a>
      <a href="{% url 'tournaments:organizer_hub' slug 'announcements' %}"
         class="tab-btn{% if active_tab == 'announcements' %} active{% endif %}">
        <i data-lucide="megaphone" class="w-4 h-4 mr-1 inline"></i> Announcements
      </a>
      <a href="{% url 'tournaments:organizer_hub' slug 'settings' %}"
         class="tab-btn{% if active_tab == 'settings' %} active{% endif %}">
        <i data-lucide="settings" class="w-4 h-4 mr-1 inline"></i> Settings
      </a>
      {% endwith %}
    </div>
  </div>

  {# ── Tab content ── #}
  {% block hub_content %}{% endblock %}

</div>

{% endblock %}
