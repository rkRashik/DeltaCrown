{% comment %}
Settings & Security — Team visibility, status, temporary flag.
Danger zone for owner-only actions (transfer / delete).
Settings auto-save via AJAX.
{% endcomment %}
<section id="settings" class="hq-section space-y-4">

    {# ── Visibility ── #}
    <div class="rounded-3xl border border-line bg-card shadow-soft p-5 lg:p-6">
        <h2 class="text-base font-bold mb-1 flex items-center gap-2">
            <i data-lucide="eye" class="w-4 h-4 text-blue-400"></i>
            Visibility
        </h2>
        <p class="text-xs text-white/40 mb-5">Control who can discover and view your team page.</p>

        <div class="grid grid-cols-1 sm:grid-cols-3 gap-3" id="visibility-options">
            {% for vis_val, vis_label in visibility_choices %}
            <label class="relative cursor-pointer">
                <input type="radio" name="visibility" value="{{ vis_val }}"
                    {% if team.visibility == vis_val %}checked{% endif %}
                    class="peer sr-only"
                    onchange="ManageHQ.toggleSetting('visibility', '{{ vis_val }}')">
                <div class="rounded-2xl border border-white/10 bg-white/5 p-4 text-center transition
                            peer-checked:border-blue-500/50 peer-checked:bg-blue-500/10 hover:bg-white/8">
                    <div class="text-xl mb-1">
                        {% if vis_val == 'PUBLIC' %}<i data-lucide="globe" class="w-5 h-5 mx-auto text-emerald-400"></i>
                        {% elif vis_val == 'PRIVATE' %}<i data-lucide="lock" class="w-5 h-5 mx-auto text-red-400"></i>
                        {% else %}<i data-lucide="eye-off" class="w-5 h-5 mx-auto text-amber-400"></i>{% endif %}
                    </div>
                    <p class="text-sm font-semibold mt-2">{{ vis_label }}</p>
                    <p class="text-xs text-white/40 mt-1">
                        {% if vis_val == 'PUBLIC' %}Anyone can find and view your team
                        {% elif vis_val == 'PRIVATE' %}Only members can see team details
                        {% else %}Visible via direct link only{% endif %}
                    </p>
                </div>
            </label>
            {% endfor %}
        </div>
    </div>

    {# ── Team Status ── #}
    <div class="rounded-3xl border border-line bg-card shadow-soft p-5 lg:p-6">
        <h2 class="text-base font-bold mb-1 flex items-center gap-2">
            <i data-lucide="shield" class="w-4 h-4 text-amber-400"></i>
            Team Status
        </h2>
        <p class="text-xs text-white/40 mb-5">Current operational status of your team.</p>

        <div class="flex items-center justify-between p-4 rounded-xl bg-white/5 border border-white/10">
            <div class="flex items-center gap-3">
                <div class="h-10 w-10 rounded-xl grid place-items-center
                    {% if team.status == 'ACTIVE' %}bg-emerald-500/15 text-emerald-400
                    {% elif team.status == 'SUSPENDED' %}bg-red-500/15 text-red-400
                    {% else %}bg-amber-500/15 text-amber-400{% endif %}">
                    {% if team.status == 'ACTIVE' %}<i data-lucide="check-circle" class="w-5 h-5"></i>
                    {% elif team.status == 'SUSPENDED' %}<i data-lucide="ban" class="w-5 h-5"></i>
                    {% else %}<i data-lucide="clock" class="w-5 h-5"></i>{% endif %}
                </div>
                <div>
                    <p class="text-sm font-semibold">{{ team.status|title }}</p>
                    <p class="text-xs text-white/40">
                        {% if team.status == 'ACTIVE' %}Your team is fully operational and can join tournaments
                        {% elif team.status == 'SUSPENDED' %}Team is suspended — contact support for details
                        {% else %}{{ team.status|title }}{% endif %}
                    </p>
                </div>
            </div>
            <span class="text-xs px-3 py-1.5 rounded-full font-medium
                {% if team.status == 'ACTIVE' %}bg-emerald-500/15 text-emerald-400
                {% elif team.status == 'SUSPENDED' %}bg-red-500/15 text-red-400
                {% else %}bg-amber-500/15 text-amber-400{% endif %}">
                {{ team.status|title }}
            </span>
        </div>

        {# ── Temporary Team Toggle ── #}
        <div class="mt-4">
            {% include "teams/manage_hq/partials/_toggle.html" with field="is_temporary" label="Temporary Team" desc="Mark this team as temporary (e.g., created for a specific tournament). Temporary teams may be auto-cleaned." checked=team.is_temporary %}
        </div>
    </div>

    {# ── Organization Policies (if org team) ── #}
    {% if team.organization %}
    <div class="rounded-3xl border border-indigo-500/20 bg-gradient-to-br from-indigo-500/5 to-transparent shadow-soft p-5 lg:p-6">
        <h2 class="text-base font-bold mb-1 flex items-center gap-2">
            <i data-lucide="building-2" class="w-4 h-4 text-indigo-400"></i>
            Organization Policies
        </h2>
        <p class="text-xs text-white/40 mb-5">Settings inherited from <b class="text-white/60">{{ team.organization.name }}</b>. These cannot be overridden at team level.</p>

        <div class="space-y-3">
            {# Roster Lock #}
            <div class="flex items-center justify-between p-3 rounded-xl bg-white/5 border border-white/10">
                <div class="flex items-center gap-3">
                    <div class="h-9 w-9 rounded-lg grid place-items-center
                        {% if org_policies.roster_locked %}bg-red-500/15 text-red-400{% else %}bg-emerald-500/15 text-emerald-400{% endif %}">
                        <i data-lucide="{% if org_policies.roster_locked %}lock{% else %}unlock{% endif %}" class="w-4 h-4"></i>
                    </div>
                    <div>
                        <p class="text-sm font-medium">Roster Lock</p>
                        <p class="text-xs text-white/40">
                            {% if org_policies.roster_locked %}Org has locked roster changes for all teams
                            {% else %}Roster changes allowed by organization{% endif %}
                        </p>
                    </div>
                </div>
                <span class="text-[10px] px-2 py-1 rounded-full font-medium
                    {% if org_policies.roster_locked %}bg-red-500/15 text-red-400{% else %}bg-emerald-500/15 text-emerald-400{% endif %}">
                    {% if org_policies.roster_locked %}Locked{% else %}Open{% endif %}
                </span>
            </div>

            {# Brand Enforcement #}
            <div class="flex items-center justify-between p-3 rounded-xl bg-white/5 border border-white/10">
                <div class="flex items-center gap-3">
                    <div class="h-9 w-9 rounded-lg grid place-items-center
                        {% if org_policies.enforce_brand %}bg-amber-500/15 text-amber-400{% else %}bg-emerald-500/15 text-emerald-400{% endif %}">
                        <i data-lucide="{% if org_policies.enforce_brand %}shield{% else %}brush{% endif %}" class="w-4 h-4"></i>
                    </div>
                    <div>
                        <p class="text-sm font-medium">Brand Enforcement</p>
                        <p class="text-xs text-white/40">
                            {% if org_policies.enforce_brand %}Team uses organization branding — custom logos disabled
                            {% else %}Team can use custom branding{% endif %}
                        </p>
                    </div>
                </div>
                <span class="text-[10px] px-2 py-1 rounded-full font-medium
                    {% if org_policies.enforce_brand %}bg-amber-500/15 text-amber-400{% else %}bg-emerald-500/15 text-emerald-400{% endif %}">
                    {% if org_policies.enforce_brand %}Enforced{% else %}Custom{% endif %}
                </span>
            </div>

            {# Revenue Split #}
            <div class="flex items-center justify-between p-3 rounded-xl bg-white/5 border border-white/10">
                <div class="flex items-center gap-3">
                    <div class="h-9 w-9 rounded-lg grid place-items-center
                        {% if org_policies.revenue_split_config %}bg-blue-500/15 text-blue-400{% else %}bg-white/10 text-white/30{% endif %}">
                        <i data-lucide="split" class="w-4 h-4"></i>
                    </div>
                    <div>
                        <p class="text-sm font-medium">Revenue Split</p>
                        <p class="text-xs text-white/40">
                            {% if org_policies.revenue_split_config %}Prize money split active between org and team
                            {% else %}No revenue split configured{% endif %}
                        </p>
                    </div>
                </div>
                <span class="text-[10px] px-2 py-1 rounded-full font-medium
                    {% if org_policies.revenue_split_config %}bg-blue-500/15 text-blue-400{% else %}bg-white/10 text-white/30{% endif %}">
                    {% if org_policies.revenue_split_config %}Active{% else %}None{% endif %}
                </span>
            </div>
        </div>

        {% if org_control_plane_url %}
        <div class="mt-4 text-center">
            <a href="{{ org_control_plane_url }}" class="text-xs text-indigo-400 hover:text-indigo-300 transition font-medium">
                View all policies in Org Control Plane →
            </a>
        </div>
        {% endif %}
    </div>
    {% endif %}

    {# ── Danger Zone (Owner Only) ── #}
    {% if is_owner %}
    <div class="rounded-3xl border border-red-500/25 bg-red-500/5 shadow-soft p-5 lg:p-6">
        <h2 class="text-base font-bold mb-1 flex items-center gap-2 text-red-400">
            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
            Danger Zone
        </h2>
        <p class="text-xs text-white/40 mb-5">Irreversible actions. Proceed with extreme caution.</p>

        <div class="space-y-3">
            {# Transfer Ownership #}
            <div class="flex items-center justify-between p-3 rounded-xl bg-white/5 border border-white/10">
                <div>
                    <p class="text-sm font-medium">Transfer Ownership</p>
                    <p class="text-xs text-white/40">Make another member the team owner</p>
                </div>
                <button onclick="alert('Transfer ownership feature coming soon.')"
                   class="px-3 py-1.5 text-xs rounded-lg border border-red-500/40 text-red-400 hover:bg-red-500/15 transition font-medium">
                    Transfer
                </button>
            </div>

            {# Delete Team #}
            <div class="flex items-center justify-between p-3 rounded-xl bg-white/5 border border-white/10">
                <div>
                    <p class="text-sm font-medium">Delete Team</p>
                    <p class="text-xs text-white/40">Permanently delete this team and all its data</p>
                </div>
                <button onclick="alert('Delete team feature coming soon.')"
                   class="px-3 py-1.5 text-xs rounded-lg border border-red-500/40 text-red-400 hover:bg-red-500/15 transition font-medium">
                    Delete
                </button>
            </div>

            {% if team.organization %}
            {# Release from Organization #}
            <div class="flex items-center justify-between p-3 rounded-xl bg-white/5 border border-white/10">
                <div>
                    <p class="text-sm font-medium">Release from Organization</p>
                    <p class="text-xs text-white/40">Make this team independent — remove from {{ team.organization.name }}</p>
                </div>
                <button onclick="alert('Release from organization feature coming soon.')"
                   class="px-3 py-1.5 text-xs rounded-lg border border-amber-500/40 text-amber-400 hover:bg-amber-500/15 transition font-medium">
                    Release
                </button>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

</section>
