{% extends "base.html" %}
{% block content %}
<div class="container py-4">
  <h3>{{ team.tag }} — {{ team.name }}</h3>

  <h5 class="mt-3">Roster</h5>
  <ul class="list-group mb-3">
    {% for m in memberships %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <div>
        <strong>@{{ m.user.user.username }}</strong>
        <small class="text-muted ms-2">({{ m.role }})</small>
      </div>
      {% if is_captain and m.user != team.captain %}
        <a class="btn btn-sm btn-outline-primary" href="{% url 'teams:transfer_captain' team.id m.user.id %}">Make Captain</a>
      {% endif %}
    </li>
    {% empty %}
      <li class="list-group-item text-muted">No members.</li>
    {% endfor %}
  </ul>

  {% if is_captain %}
  <div class="card p-3 mb-3">
    <h6>Invite a player</h6>
    <form method="post" action="{% url 'teams:invite_member' team.id %}">
      {% csrf_token %}
      <div class="row g-2">
        <div class="col-md-4">
          <input class="form-control" name="username" placeholder="username" required>
        </div>
        <div class="col-md-6">
          <input class="form-control" name="message" placeholder="optional message">
        </div>
        <div class="col-md-2">
          <button class="btn btn-primary w-100" type="submit">Invite</button>
        </div>
      </div>
    </form>
  </div>

  <div class="card p-3 mb-3">
    <h6>Pending Invites</h6>
    <ul class="list-group">
      {% for inv in invites %}
        <li class="list-group-item d-flex justify-content-between">
          <span>@{{ inv.invited_user.user.username }} — {{ inv.status|lower }}</span>
        </li>
      {% empty %}
        <li class="list-group-item text-muted">No pending invites.</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}

  {% if not is_captain %}
    <a class="btn btn-outline-danger" href="{% url 'teams:leave_team' team.id %}">Leave Team</a>
  {% endif %}
</div>
{% endblock %}
