{% extends "base.html" %}
{% load static %}

{% block title %}{{ team.name }} â€” Team{% endblock %}

{% block content %}
<div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 py-8">
  <div class="relative rounded-2xl overflow-hidden border border-black/5 dark:border-white/10 bg-gradient-to-br from-slate-100 to-white dark:from-slate-900 dark:to-slate-950">
    {% if team.banner %}
      <img src="{{ team.banner.url }}" alt="" class="absolute inset-0 w-full h-40 object-cover opacity-80">
    {% else %}
      <div class="absolute inset-0 h-40 bg-[radial-gradient(ellipse_at_top,rgba(59,130,246,.35),transparent_40%)]"></div>
    {% endif %}
    <div class="relative pt-6 px-6 pb-4">
      <div class="flex items-center gap-4">
        {% if team.logo %}
          <img src="{{ team.logo.url }}" alt="{{ team.name }} logo" class="w-16 h-16 rounded-xl ring-1 ring-black/5 dark:ring-white/10 object-cover bg-white/70 backdrop-blur">
        {% else %}
          <div class="w-16 h-16 rounded-xl ring-1 ring-black/5 dark:ring-white/10 bg-white/70 backdrop-blur grid place-content-center text-lg font-semibold">
            {{ team.name|slice:":2"|upper }}
          </div>
        {% endif %}
        <div class="flex-1">
          <div class="flex items-center gap-2">
            <h1 class="text-2xl md:text-3xl font-semibold tracking-tight">{{ team.name }}</h1>
            <span class="chip">{{ team.game|title }}</span>
          </div>
          {% if team.tagline %}
            <p class="text-sm text-gray-600 dark:text-gray-300 mt-1">{{ team.tagline }}</p>
          {% endif %}
        </div>

        {% include "teams/partials/share_menu.html" with title=team.name url=request.build_absolute_uri %}

      </div>

      <div class="mt-4 flex flex-wrap gap-3">
        {% if is_captain %}
          <a href="{% url 'teams:edit' team.slug %}" class="btn btn-secondary">Edit</a>
          <a href="{% url 'teams:invite' team.slug %}" class="btn btn-secondary">Invite</a>
        {% endif %}

        {% if is_member and not is_captain %}
          <a href="{% url 'teams:leave' team.slug %}" class="btn btn-danger">Leave</a>
        {% endif %}

        {% if not is_member %}
          {% if already_in_team_for_game %}
            <button class="btn btn-disabled" disabled title="You already belong to a team in {{ team.game|title }}.">
              Already in a {{ team.game|title }} team
            </button>
          {% else %}
            <a href="{% url 'teams:join' team.slug %}" class="btn btn-primary">Join team</a>
          {% endif %}
        {% endif %}
      </div>
    </div>
  </div>

  <div class="mt-6">
    <div class="tabs" data-tabs>
      <button class="tab active" data-tab="roster">Roster</button>
      <button class="tab" data-tab="matches">Matches</button>
      <button class="tab" data-tab="stats">Stats</button>
      <button class="tab" data-tab="media">Media</button>
    </div>

    <section id="tab-roster" class="tab-panel mt-4">
      {% include "teams/_roster.html" with roster=roster team=team is_captain=is_captain %}
    </section>

    <section id="tab-matches" class="tab-panel mt-4 hidden">
      {% include "teams/_matches.html" with team=team %}
    </section>

    <section id="tab-stats" class="tab-panel mt-4 hidden">
      {% include "teams/_stats_blocks.html" with team=team %}
    </section>

    <section id="tab-media" class="tab-panel mt-4 hidden">
      <div class="card glass p-4">
        {% if team.discord or team.youtube or team.twitch or team.facebook %}
          <h3 class="text-lg font-semibold mb-2">Social & Media</h3>
          <ul class="list-disc pl-6">
            {% if team.discord %}<li><a class="link" href="{{ team.discord }}" target="_blank" rel="noopener">Discord</a></li>{% endif %}
            {% if team.youtube %}<li><a class="link" href="{{ team.youtube }}" target="_blank" rel="noopener">YouTube</a></li>{% endif %}
            {% if team.twitch %}<li><a class="link" href="{{ team.twitch }}" target="_blank" rel="noopener">Twitch</a></li>{% endif %}
            {% if team.facebook %}<li><a class="link" href="{{ team.facebook }}" target="_blank" rel="noopener">Facebook</a></li>{% endif %}
          </ul>
        {% else %}
          <p class="text-gray-600 dark:text-gray-300">No media links yet.</p>
        {% endif %}
      </div>
    </section>
  </div>
</div>

<script src="{% static 'siteui/js/teams-detail.js' %}" defer></script>
{% endblock %}
