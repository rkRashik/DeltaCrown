{% extends "base.html" %}
{% load static %}

{% block title %}{{ team.name }} â€” Team{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'siteui/css/teams-detail-responsive.css' %}?v=1.0">
<link rel="stylesheet" href="{% static 'siteui/css/teams-detail-hero-v2.css' %}?v=1.0">
{% endblock %}

{% block content %}
<div class="team-detail-container">
  <!-- Modern Esports Hero Section -->
  <div class="team-esports-hero">
    <!-- Full-Width Banner Background -->
    <div class="team-hero-banner">
      {% if team.banner %}
        <img src="{{ team.banner.url }}" alt="{{ team.name }} banner" class="banner-image">
      {% else %}
        <div class="banner-placeholder">
          <div class="placeholder-pattern"></div>
        </div>
      {% endif %}
      <div class="banner-overlay"></div>
      <div class="banner-gradient"></div>
    </div>
    
    <!-- Hero Content Container -->
    <div class="team-hero-container">
      <div class="team-hero-layout">
        <!-- Left Side: Team Identity -->
        <div class="team-identity-section">
          <!-- Team Logo with Glow Effect -->
          <div class="team-logo-display">
            {% if team.logo %}
              <img src="{{ team.logo.url }}" alt="{{ team.name }} logo" class="team-logo-img">
            {% else %}
              <div class="team-logo-placeholder">
                <span class="logo-initials">{{ team.name|slice:":2"|upper }}</span>
              </div>
            {% endif %}
            <div class="logo-glow"></div>
          </div>
          
          <!-- Team Info -->
          <div class="team-identity-info">
            <h1 class="team-name-display">{{ team.name }}</h1>
            
            <div class="team-badges-row">
              <div class="team-game-tag">
                <i class="fas fa-gamepad"></i>
                <span>{{ team.game|title }}</span>
              </div>
              {% if team.is_recruiting and not is_member %}
                <div class="team-recruiting-tag">
                  <i class="fas fa-bullhorn"></i>
                  <span>Recruiting</span>
                </div>
              {% endif %}
              {% if team.region %}
                <div class="team-region-tag">
                  <i class="fas fa-map-marker-alt"></i>
                  <span>{{ team.region }}</span>
                </div>
              {% endif %}
            </div>
            
            {% if team.tagline %}
              <p class="team-motto">{{ team.tagline }}</p>
            {% endif %}
          </div>
        </div>
        
        <!-- Right Side: Stats & Actions -->
        <div class="team-actions-section">
          <!-- Stats Cards -->
          <div class="team-stats-cards">
            <div class="stat-card">
              <div class="stat-icon-wrapper">
                <i class="fas fa-users"></i>
              </div>
              <div class="stat-details">
                <div class="stat-number">{{ team.memberships.count|default:0 }}</div>
                <div class="stat-label">Members</div>
              </div>
            </div>
            
            <div class="stat-card">
              <div class="stat-icon-wrapper">
                <i class="fas fa-trophy"></i>
              </div>
              <div class="stat-details">
                <div class="stat-number">{{ team.tournament_wins|default:0 }}</div>
                <div class="stat-label">Wins</div>
              </div>
            </div>
            
            <div class="stat-card">
              <div class="stat-icon-wrapper">
                <i class="fas fa-star"></i>
              </div>
              <div class="stat-details">
                <div class="stat-number">{{ team.total_points|default:0 }}</div>
                <div class="stat-label">Points</div>
              </div>
            </div>
          </div>
          
          <!-- Action Buttons -->
          <div class="team-action-buttons">
        {% if is_captain %}
          <a href="{% url 'teams:manage' team.slug %}" class="btn btn-primary">
            <i class="fas fa-cogs"></i>
            <span>Manage Team</span>
          </a>
          <a href="{% url 'teams:invite_member' team.slug %}" class="btn btn-secondary">
            <i class="fas fa-user-plus"></i>
            <span>Invite Members</span>
          </a>
          <a href="{% url 'teams:settings' team.slug %}" class="btn btn-ghost">
            <i class="fas fa-cog"></i>
            <span>Settings</span>
          </a>
        {% endif %}

        {% if is_member and not is_captain %}
          <form method="post" action="{% url 'teams:leave' team.slug %}" class="inline-form" onsubmit="return confirm('Are you sure you want to leave this team?');">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger">
              <i class="fas fa-sign-out-alt"></i>
              <span>Leave Team</span>
            </button>
          </form>
        {% endif %}

        {% if not is_member %}
          {% if already_in_team_for_game %}
            <button class="btn btn-disabled" disabled title="You already belong to a team in {{ team.game|title }}.">
              <i class="fas fa-users"></i>
              <span>Already in {{ team.game|title }} team</span>
            </button>
          {% elif team.is_open %}
            <form method="post" action="{% url 'teams:join' team.slug %}" class="inline-form">
              {% csrf_token %}
              <button type="submit" class="btn btn-primary">
                <i class="fas fa-plus"></i>
                <span>Join Team</span>
              </button>
            </form>
          {% else %}
            <button class="btn btn-disabled" disabled title="This team requires an invitation to join.">
              <i class="fas fa-lock"></i>
              <span>Invitation Required</span>
            </button>
          {% endif %}
        {% endif %}
        
        {% include "teams/partials/share_menu.html" with title=team.name url=request.build_absolute_uri %}
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-6">
    <div class="tabs" data-tabs>
      <button class="tab active" data-tab="roster">Roster</button>
      <button class="tab" data-tab="matches">Matches</button>
      <button class="tab" data-tab="stats">Stats</button>
      <button class="tab" data-tab="media">Media</button>
    </div>

    <section id="tab-roster" class="tab-panel mt-4">
      {% include "teams/_roster.html" with roster=roster team=team is_captain=is_captain %}
    </section>

    <section id="tab-matches" class="tab-panel mt-4 hidden">
      {% include "teams/_matches.html" with team=team %}
    </section>

    <section id="tab-stats" class="tab-panel mt-4 hidden">
      {% include "teams/_stats_blocks.html" with team=team %}
    </section>

    <section id="tab-media" class="tab-panel mt-4 hidden">
      <div class="card glass p-4">
        {% if team.discord or team.youtube or team.twitch or team.facebook %}
          <h3 class="text-lg font-semibold mb-2">Social & Media</h3>
          <ul class="list-disc pl-6">
            {% if team.discord %}<li><a class="link" href="{{ team.discord }}" target="_blank" rel="noopener">Discord</a></li>{% endif %}
            {% if team.youtube %}<li><a class="link" href="{{ team.youtube }}" target="_blank" rel="noopener">YouTube</a></li>{% endif %}
            {% if team.twitch %}<li><a class="link" href="{{ team.twitch }}" target="_blank" rel="noopener">Twitch</a></li>{% endif %}
            {% if team.facebook %}<li><a class="link" href="{{ team.facebook }}" target="_blank" rel="noopener">Facebook</a></li>{% endif %}
          </ul>
        {% else %}
          <p class="text-gray-600 dark:text-gray-300">No media links yet.</p>
        {% endif %}
      </div>
    </section>
  </div>
</div>

<script src="{% static 'siteui/js/teams-detail.js' %}" defer></script>
{% endblock %}

{% block footer %}
{# Footer removed for team detail page #}
{% endblock %}
