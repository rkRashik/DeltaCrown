<!-- Role-Based Team Hub Dashboard -->
<!-- Modern, professional esports team dashboard with glassmorphism design -->
{% if is_member %}

<!-- Dashboard Header with Role Display -->
<div class="card glass p-6 mb-6">
  <div class="flex items-center justify-between mb-4">
    <div>
      <h2 class="text-2xl font-bold flex items-center gap-3">
        <i class="fas fa-tachometer-alt text-cyan-400"></i>
        {% if is_owner %}
          Team Owner Dashboard
        {% elif is_manager %}
          Manager Dashboard
        {% elif is_coach %}
          Coach Dashboard
        {% else %}
          Member Dashboard
        {% endif %}
      </h2>
      <p class="text-gray-400 mt-1">Welcome back, {{ request.user.username }}!</p>
    </div>
    <div class="text-right">
      <div class="text-sm text-gray-400">Your Role</div>
      <div class="font-semibold text-lg">
        {% if is_owner %}
          <i class="fas fa-crown text-yellow-400"></i> Owner
        {% elif is_manager %}
          <i class="fas fa-user-tie text-blue-400"></i> Manager
        {% elif is_coach %}
          <i class="fas fa-chalkboard-teacher text-green-400"></i> Coach
        {% elif is_player %}
          <i class="fas fa-gamepad text-purple-400"></i> Player
        {% else %}
          <i class="fas fa-user text-gray-400"></i> Member
        {% endif %}
        {% if user_membership.is_captain %}
          <span class="text-yellow-400 text-sm ml-2">(Captain)</span>
        {% endif %}
      </div>
    </div>
  </div>
  
  <!-- Quick Stats -->
  <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
    <div class="p-4 rounded-lg bg-gradient-to-br from-cyan-500/10 to-blue-500/10 border border-cyan-500/20">
      <div class="text-sm text-gray-400">Team Members</div>
      <div class="text-2xl font-bold text-cyan-400">{{ roster_count|default:roster|length }}</div>
    </div>
    <div class="p-4 rounded-lg bg-gradient-to-br from-purple-500/10 to-pink-500/10 border border-purple-500/20">
      <div class="text-sm text-gray-400">Tournaments</div>
      <div class="text-2xl font-bold text-purple-400">{{ team.tournament_count|default:0 }}</div>
    </div>
    <div class="p-4 rounded-lg bg-gradient-to-br from-green-500/10 to-emerald-500/10 border border-green-500/20">
      <div class="text-sm text-gray-400">Win Rate</div>
      <div class="text-2xl font-bold text-green-400">{{ latest_stats.win_rate|default:"0" }}%</div>
    </div>
    <div class="p-4 rounded-lg bg-gradient-to-br from-yellow-500/10 to-orange-500/10 border border-yellow-500/20">
      <div class="text-sm text-gray-400">Rank Points</div>
      <div class="text-2xl font-bold text-yellow-400">{{ team.total_points|default:0 }}</div>
    </div>
  </div>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
  
  <!-- =================================================================== -->
  <!-- OWNER / CAPTAIN CONTROLS -->
  <!-- =================================================================== -->
  {% if is_owner %}
  <div class="card glass p-6 hover:shadow-2xl transition-shadow duration-300">
    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-crown text-yellow-400"></i>
      Captain Controls
    </h3>
    
    <div class="space-y-2">
      <a href="{% url 'teams:dashboard' team.slug %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-cyan-500/10 transition-colors">
        <i class="fas fa-tachometer-alt text-cyan-400"></i>
        <span>Full Dashboard</span>
      </a>
      
      <a href="{% url 'teams:settings' team.slug %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-cyan-500/10 transition-colors">
        <i class="fas fa-cog text-gray-400"></i>
        <span>Team Settings</span>
      </a>
      
      <a href="{% url 'teams:manage' team.slug %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-cyan-500/10 transition-colors">
        <i class="fas fa-users-cog text-blue-400"></i>
        <span>Manage Roster</span>
      </a>
      
      <a href="{% url 'teams:invite_member' team.slug %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-cyan-500/10 transition-colors">
        <i class="fas fa-user-plus text-green-400"></i>
        <span>Invite Members</span>
      </a>
      
      {% if can_register_tournaments %}
      <a href="{% url 'tournaments:list' %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-cyan-500/10 transition-colors">
        <i class="fas fa-trophy text-yellow-400"></i>
        <span>Browse Tournaments</span>
      </a>
      {% endif %}
      
      <a href="{% url 'teams:team_analytics' team.id %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-cyan-500/10 transition-colors">
        <i class="fas fa-chart-line text-purple-400"></i>
        <span>View Analytics</span>
      </a>
    </div>
  </div>
  {% endif %}
  
  <!-- =================================================================== -->
  <!-- MANAGER TOOLS -->
  <!-- =================================================================== -->
  {% if is_manager or is_owner %}
  <div class="card glass p-6 hover:shadow-2xl transition-shadow duration-300">
    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-user-tie text-blue-400"></i>
      Manager Tools
    </h3>
    <p class="text-sm text-gray-400 mb-4">Roster management and operations</p>
    
    <div class="space-y-2">
      <a href="{% url 'teams:manage' team.slug %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-blue-500/10 transition-colors">
        <i class="fas fa-users-cog text-blue-400"></i>
        <span>Manage Roster</span>
      </a>
      
      <a href="{% url 'teams:invite_member' team.slug %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-blue-500/10 transition-colors">
        <i class="fas fa-user-plus text-green-400"></i>
        <span>Invite Members</span>
      </a>
      
      <a href="{% url 'teams:manager_tools' team.slug %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-blue-500/10 transition-colors">
        <i class="fas fa-clipboard-check text-cyan-400"></i>
        <span>Approve Requests</span>
      </a>
      
      <a href="{% url 'teams:team_tournaments' team.slug %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-blue-500/10 transition-colors">
        <i class="fas fa-trophy text-yellow-400"></i>
        <span>Tournament Schedule</span>
      </a>
      
      <a href="{% url 'teams:settings' team.slug %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-blue-500/10 transition-colors">
        <i class="fas fa-sliders-h text-gray-400"></i>
        <span>Team Settings</span>
      </a>
    </div>
  </div>
  {% endif %}
  
  <!-- =================================================================== -->
  <!-- COACH TOOLS -->
  <!-- =================================================================== -->
  {% if is_coach %}
  <div class="card glass p-6 hover:shadow-2xl transition-shadow duration-300">
    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-chalkboard-teacher text-green-400"></i>
      Coach Tools
    </h3>
    <p class="text-sm text-gray-400 mb-4">Performance and strategy management</p>
    
    <div class="space-y-2">
      <a href="{% url 'teams:coach_tools' team.slug %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-green-500/10 transition-colors">
        <i class="fas fa-chalkboard text-green-400"></i>
        <span>Practice Schedule</span>
      </a>
      
      <a href="{% url 'teams:coach_tools' team.slug %}#vod-review" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-green-500/10 transition-colors">
        <i class="fas fa-video text-purple-400"></i>
        <span>VOD Review</span>
      </a>
      
      <a href="{% url 'teams:team_analytics' team.id %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-green-500/10 transition-colors">
        <i class="fas fa-chart-bar text-cyan-400"></i>
        <span>Player Performance</span>
      </a>
      
      <a href="{% url 'teams:coach_tools' team.slug %}#strategy" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-green-500/10 transition-colors">
        <i class="fas fa-brain text-pink-400"></i>
        <span>Strategy & Notes</span>
      </a>
      
      <a href="{% url 'teams:team_tournaments' team.slug %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-green-500/10 transition-colors">
        <i class="fas fa-calendar-alt text-yellow-400"></i>
        <span>Match Schedule</span>
      </a>
    </div>
  </div>
  {% endif %}
  
  <!-- =================================================================== -->
  <!-- MEMBER TOOLS (ALL MEMBERS) -->
  <!-- =================================================================== -->
  <div class="card glass p-6 hover:shadow-2xl transition-shadow duration-300">
    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-user text-purple-400"></i>
      Member Tools
    </h3>
    <p class="text-sm text-gray-400 mb-4">Your personal team features</p>
    
    <div class="space-y-3">
      <!-- Profile & IDs Section -->
      <div class="mb-4">
        <div class="text-xs font-semibold text-gray-500 uppercase mb-2">Profile & IDs</div>
        <div class="space-y-2">
          <a href="{% url 'teams:collect_game_id' team.game %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-purple-500/10 transition-colors">
            <i class="fas fa-id-card text-cyan-400"></i>
            <span>Update Game ID</span>
          </a>
          
          <a href="{% url 'user_profile:profile' user.username %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-purple-500/10 transition-colors">
            <i class="fas fa-user-circle text-blue-400"></i>
            <span>View My Profile</span>
          </a>
        </div>
      </div>
      
      <!-- Performance Section -->
      <div class="mb-4">
        <div class="text-xs font-semibold text-gray-500 uppercase mb-2">Performance</div>
        <div class="space-y-2">
          <a href="{% url 'teams:player_analytics' user_membership.profile.id %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-purple-500/10 transition-colors">
            <i class="fas fa-chart-line text-green-400"></i>
            <span>My Stats</span>
          </a>
        </div>
      </div>
      
      <!-- Communication Section -->
      <div class="mb-4">
        <div class="text-xs font-semibold text-gray-500 uppercase mb-2">Communication</div>
        <div class="space-y-2">
          <a href="{% url 'notifications:list' %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-purple-500/10 transition-colors">
            <i class="fas fa-bell text-yellow-400"></i>
            <span>Notifications</span>
          </a>
        </div>
      </div>
      
      <!-- Safety Section -->
      <div>
        <div class="text-xs font-semibold text-gray-500 uppercase mb-2">Safety</div>
        <div class="space-y-2">
          <a href="{% url 'teams:team_safety' team.slug %}" class="dashboard-action-btn w-full flex items-center gap-3 p-3 rounded-lg hover:bg-red-500/10 transition-colors text-red-400">
            <i class="fas fa-shield-alt"></i>
            <span>Team Settings & Safety</span>
          </a>
        </div>
      </div>
    </div>
  </div>
  
</div>

<!-- Recent Activity Feed -->
<div class="card glass p-6 mt-6">
  <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
    <i class="fas fa-stream text-cyan-400"></i>
    Recent Team Activity
  </h3>
  
  {% if recent_activity %}
  <div class="space-y-3">
    {% for activity in recent_activity|slice:":10" %}
    <div class="flex items-center gap-3 p-3 rounded-lg bg-white/5 hover:bg-white/10 transition-colors">
      <div class="flex-shrink-0">
        {% if activity.type == 'tournament' %}
          <i class="fas fa-trophy text-yellow-400 text-xl"></i>
        {% elif activity.type == 'member_join' %}
          <i class="fas fa-user-plus text-green-400 text-xl"></i>
        {% elif activity.type == 'match' %}
          <i class="fas fa-gamepad text-purple-400 text-xl"></i>
        {% else %}
          <i class="fas fa-info-circle text-cyan-400 text-xl"></i>
        {% endif %}
      </div>
      <div class="flex-1">
        <div class="text-sm font-medium">{{ activity.description }}</div>
        <div class="text-xs text-gray-400">{{ activity.timestamp|timesince }} ago</div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="text-center py-8 text-gray-400">
    <i class="fas fa-inbox text-4xl mb-3 opacity-50"></i>
    <p>No recent activity yet. Start by inviting members or registering for tournaments!</p>
  </div>
  {% endif %}
</div>

{% else %}
<!-- Public View (Not a member) -->
<div class="card glass p-8 text-center">
  <i class="fas fa-lock text-4xl text-gray-400 mb-4"></i>
  <h3 class="text-xl font-bold mb-2">Member Dashboard</h3>
  <p class="text-gray-400 mb-6">This dashboard is only available to team members.</p>
  
  {% if user.is_authenticated %}
    <a href="{% url 'teams:join' team.slug %}" class="btn btn-primary">
      <i class="fas fa-user-plus"></i>
      Request to Join Team
    </a>
  {% else %}
    <a href="{% url 'account_login' %}?next={{ request.path }}" class="btn btn-primary">
      <i class="fas fa-sign-in-alt"></i>
      Login to Join
    </a>
  {% endif %}
</div>
{% endif %}

<style>
.dashboard-action-btn {
  display: flex;
  align-items: center;
  transition: all 0.2s ease;
  text-decoration: none;
}

.dashboard-action-btn:hover {
  transform: translateX(4px);
}

.card.glass {
  background: rgba(15, 23, 42, 0.7);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 12px;
}

.card.glass:hover {
  border-color: rgba(6, 182, 212, 0.3);
}
</style>
