<!-- Member Dashboard Header -->
<div class="card glass p-6 mb-6">
  <div class="flex items-center justify-between mb-4">
    <div>
      <h2 class="text-2xl font-bold flex items-center gap-3">
        <i class="fas fa-tachometer-alt text-cyan-400"></i>
        {% if is_captain %}
          Captain Dashboard
        {% elif user_membership and user_membership.role == 'MANAGER' %}
          Manager Dashboard
        {% else %}
          Member Dashboard
        {% endif %}
      </h2>
      <p class="text-gray-400 mt-1">Welcome back, {{ request.user.username }}!</p>
    </div>
    <div class="text-right">
      <div class="text-sm text-gray-400">Your Role</div>
      <div class="font-semibold text-lg">
        {% if is_captain %}
          <i class="fas fa-crown text-yellow-400"></i> Captain
        {% elif user_membership and user_membership.role == 'MANAGER' %}
          <i class="fas fa-user-tie text-blue-400"></i> Manager
        {% elif user_membership and user_membership.role == 'COACH' %}
          <i class="fas fa-chalkboard-teacher text-green-400"></i> Coach
        {% elif user_membership %}
          <i class="fas fa-user text-gray-400"></i> {{ user_membership.get_role_display }}
        {% else %}
          <i class="fas fa-user text-gray-400"></i> Member
        {% endif %}
      </div>
    </div>
  </div>
  
  <!-- Quick Stats -->
  <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
    <div class="p-4 rounded-lg bg-gradient-to-br from-cyan-500/10 to-blue-500/10 border border-cyan-500/20">
      <div class="text-sm text-gray-400">Team Members</div>
      <div class="text-2xl font-bold text-cyan-400">{{ roster_count|default:roster|length }}</div>
    </div>
    <div class="p-4 rounded-lg bg-gradient-to-br from-purple-500/10 to-pink-500/10 border border-purple-500/20">
      <div class="text-sm text-gray-400">Tournaments</div>
      <div class="text-2xl font-bold text-purple-400">{{ team.tournament_count|default:0 }}</div>
    </div>
    <div class="p-4 rounded-lg bg-gradient-to-br from-green-500/10 to-emerald-500/10 border border-green-500/20">
      <div class="text-sm text-gray-400">Win Rate</div>
      <div class="text-2xl font-bold text-green-400">{{ team.win_rate|default:"0" }}%</div>
    </div>
    <div class="p-4 rounded-lg bg-gradient-to-br from-yellow-500/10 to-orange-500/10 border border-yellow-500/20">
      <div class="text-sm text-gray-400">Rank Points</div>
      <div class="text-2xl font-bold text-yellow-400">{{ team.total_points|default:0 }}</div>
    </div>
  </div>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
  
  <!-- Member Actions Card -->
  <div class="card glass p-6">
    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-user-cog text-cyan-400"></i>
      My Actions
    </h3>
    
    <div class="space-y-3">
      <!-- Update Game ID -->
      <button 
        class="w-full btn btn-secondary justify-start text-left"
        onclick="updateGameID('{{ team.game }}', '{{ team.get_game_display }}')">
        <i class="fas fa-id-card"></i>
        <span>Update Game ID</span>
      </button>

      <!-- View My Stats -->
      <a href="/user/{{ request.user.username }}/" class="w-full btn btn-secondary justify-start">
        <i class="fas fa-chart-bar"></i>
        <span>View My Stats</span>
      </a>

      <!-- Notifications -->
      <button class="w-full btn btn-secondary justify-start text-left" onclick="showTeamNotifications()">
        <i class="fas fa-bell"></i>
        <span>Team Notifications</span>
        {% if pending_notifications_count %}
        <span class="badge bg-red-500 ml-auto">{{ pending_notifications_count }}</span>
        {% endif %}
      </button>

      <!-- Team Calendar -->
      <a href="#" class="w-full btn btn-secondary justify-start" onclick="alert('Team calendar feature coming soon!'); return false;">
        <i class="fas fa-calendar-alt"></i>
        <span>Team Calendar</span>
      </a>

      <!-- Practice Schedule -->
      <a href="#" class="w-full btn btn-secondary justify-start" onclick="alert('Practice schedule feature coming soon!'); return false;">
        <i class="fas fa-clock"></i>
        <span>Practice Schedule</span>
      </a>
      
      <!-- Manager/Captain Actions -->
      {% if is_captain or user_membership.role == 'MANAGER' %}
      <div class="pt-3 mt-3 border-t border-gray-700">
        <div class="text-xs text-gray-400 mb-2 font-semibold uppercase">Management Actions</div>
        
        <a href="{% url 'teams:invite_member' team.slug %}" class="w-full btn btn-primary justify-start mb-2">
          <i class="fas fa-user-plus"></i>
          <span>Invite Members</span>
        </a>
        
        {% if is_captain %}
        <a href="{% url 'teams:settings' team.slug %}" class="w-full btn btn-primary justify-start mb-2">
          <i class="fas fa-cog"></i>
          <span>Team Settings</span>
        </a>
        
        <a href="{% url 'teams:dashboard' team.slug %}" class="w-full btn btn-primary justify-start mb-2">
          <i class="fas fa-tachometer-alt"></i>
          <span>Full Dashboard</span>
        </a>
        {% endif %}
      </div>
      {% endif %}

      <!-- Leave Team (Always at bottom, danger action) -->
      <div class="pt-3 mt-3 border-t border-red-900/30">
        <button 
          class="w-full btn btn-danger justify-start text-left"
          onclick="showLeaveTeamModal('{{ team.slug }}', '{{ team.name }}', {{ roster_count|default:roster|length }}, {{ is_captain|yesno:'true,false' }})">
          <i class="fas fa-sign-out-alt"></i>
          <span>Leave Team</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Team Communication Card -->
  <div class="card glass p-6">
    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-comments text-purple-400"></i>
      Communication
    </h3>
    
    <div class="space-y-4">
      {% if team.discord %}
      <a href="{{ team.discord }}" target="_blank" rel="noopener" class="block p-4 rounded-lg bg-indigo-600 hover:bg-indigo-700 transition-colors">
        <div class="flex items-center gap-3">
          <i class="fab fa-discord text-2xl"></i>
          <div>
            <div class="font-semibold">Discord Server</div>
            <div class="text-sm opacity-75">Join team chat</div>
          </div>
        </div>
      </a>
      {% endif %}

      <div class="p-4 rounded-lg border border-gray-700 bg-gray-800/50">
        <div class="flex items-start gap-3">
          <i class="fas fa-info-circle text-cyan-400 mt-1"></i>
          <div class="text-sm">
            <p class="font-semibold mb-1">Team Coordination</p>
            <p class="text-gray-400">Connect with your teammates through Discord or social media. Stay updated on practice schedules and tournament registrations.</p>
          </div>
        </div>
      </div>

      <!-- Contact Captain -->
      {% if not is_captain and team.captain %}
      <div class="p-4 rounded-lg border border-gray-700">
        <div class="flex items-center gap-3">
          <i class="fas fa-user-shield text-lg text-yellow-400"></i>
          <div>
            <div class="text-sm text-gray-400">Team Captain</div>
            <div class="font-semibold">{{ team.captain.user.username }}</div>
          </div>
        </div>
      </div>
      {% endif %}
    </div>
  </div>

  <!-- Quick Links Card -->
  <div class="card glass p-6">
    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-bolt text-yellow-400"></i>
      Quick Links
    </h3>
    
    <div class="space-y-2">
      <a href="{% url 'teams:team_tournaments' team.slug %}" class="flex items-center gap-3 p-3 rounded hover:bg-white/5 transition-colors">
        <i class="fas fa-trophy text-yellow-400"></i>
        <span>Tournament History</span>
      </a>
      
      <a href="{% url 'teams:team_analytics' team.id %}" class="flex items-center gap-3 p-3 rounded hover:bg-white/5 transition-colors">
        <i class="fas fa-chart-line text-green-400"></i>
        <span>Team Analytics</span>
      </a>
      
      {% if is_captain %}
      <a href="{% url 'teams:invite_member' team.slug %}" class="flex items-center gap-3 p-3 rounded hover:bg-white/5 transition-colors">
        <i class="fas fa-user-plus text-blue-400"></i>
        <span>Invite Members</span>
      </a>
      {% endif %}
    </div>
  </div>

  <!-- Team Status Card -->
  <div class="card glass p-6">
    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-info-circle text-blue-400"></i>
      Team Info
    </h3>
    
    <div class="space-y-3">
      <div class="flex justify-between items-center">
        <span class="text-gray-400">Members</span>
        <span class="font-semibold">{{ roster_count|default:roster|length }}</span>
      </div>
      
      <div class="flex justify-between items-center">
        <span class="text-gray-400">Your Role</span>
        <span class="font-semibold">
          {% if is_captain %}
            <i class="fas fa-crown text-yellow-400"></i> Captain
          {% elif user_membership %}
            <i class="fas fa-user"></i> {{ user_membership.get_role_display }}
          {% else %}
            <i class="fas fa-user"></i> Member
          {% endif %}
        </span>
      </div>
      
      <div class="flex justify-between items-center">
        <span class="text-gray-400">Team Status</span>
        <span class="font-semibold">
          {% if team.is_active %}
            <span class="text-green-400"><i class="fas fa-check-circle"></i> Active</span>
          {% else %}
            <span class="text-gray-400"><i class="fas fa-pause-circle"></i> Inactive</span>
          {% endif %}
        </span>
      </div>

      <div class="flex justify-between items-center">
        <span class="text-gray-400">Recruitment</span>
        <span class="font-semibold">
          {% if team.is_recruiting %}
            <span class="text-green-400"><i class="fas fa-unlock"></i> Open</span>
          {% else %}
            <span class="text-yellow-400"><i class="fas fa-lock"></i> Invite Only</span>
          {% endif %}
        </span>
      </div>
    </div>
  </div>
  
  <!-- Team Achievements Card -->
  <div class="card glass p-6">
    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-medal text-yellow-400"></i>
      Team Achievements
    </h3>
    
    <div class="space-y-3">
      {% if total_achievements and total_achievements > 0 %}
        {% for achievement in achievements_by_year.values.0|slice:":4" %}
        <div class="flex items-center gap-3 p-3 rounded-lg bg-gradient-to-r from-yellow-500/10 to-orange-500/10 border border-yellow-500/20">
          <div class="w-10 h-10 rounded-full bg-yellow-500/20 flex items-center justify-center flex-shrink-0">
            <i class="fas fa-trophy text-yellow-400"></i>
          </div>
          <div class="flex-1">
            <div class="font-semibold text-sm">{{ achievement.title }}</div>
            <div class="text-xs text-gray-400">{{ achievement.date_earned|date:"M d, Y" }}</div>
          </div>
        </div>
        {% endfor %}
        {% if total_achievements > 4 %}
        <a href="#" class="text-sm text-cyan-400 hover:text-cyan-300 flex items-center gap-2">
          <span>View all {{ total_achievements }} achievements</span>
          <i class="fas fa-arrow-right"></i>
        </a>
        {% endif %}
      {% else %}
        <div class="text-center py-6 text-gray-500">
          <i class="fas fa-medal text-3xl mb-2 opacity-50"></i>
          <p class="text-sm">No achievements yet</p>
          <p class="text-xs">Participate in tournaments to earn achievements!</p>
        </div>
      {% endif %}
    </div>
  </div>

  <!-- Upcoming Events Card -->
  <div class="card glass p-6">
    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-calendar-check text-purple-400"></i>
      Upcoming Events
    </h3>
    
    <div class="space-y-3">
      {% if upcoming_matches %}
        {% for event in upcoming_matches|slice:":3" %}
        <div class="p-3 rounded-lg border border-purple-500/20 bg-purple-500/5 hover:bg-purple-500/10 transition-colors">
          <div class="flex items-start gap-3">
            <div class="w-10 h-10 rounded bg-purple-500/20 flex items-center justify-center flex-shrink-0">
              <i class="fas fa-calendar text-purple-400"></i>
            </div>
            <div class="flex-1">
              <div class="font-semibold text-sm">{{ event.title }}</div>
              <div class="text-xs text-gray-400">{{ event.scheduled_date|date:"M d, Y - g:i A" }}</div>
            </div>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <div class="text-center py-6 text-gray-500">
          <i class="fas fa-calendar-times text-3xl mb-2 opacity-50"></i>
          <p class="text-sm">No upcoming events</p>
        </div>
      {% endif %}
    </div>
  </div>

  <!-- Team Resources Card -->
  <div class="card glass p-6">
    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-book text-blue-400"></i>
      Team Resources
    </h3>
    
    <div class="space-y-2">
      <a href="#" class="flex items-center gap-3 p-3 rounded hover:bg-white/5 transition-colors" onclick="alert('Team strategies feature coming soon!'); return false;">
        <i class="fas fa-chess text-blue-400"></i>
        <span>Strategies & Tactics</span>
      </a>
      
      <a href="#" class="flex items-center gap-3 p-3 rounded hover:bg-white/5 transition-colors" onclick="alert('Training materials feature coming soon!'); return false;">
        <i class="fas fa-graduation-cap text-green-400"></i>
        <span>Training Materials</span>
      </a>
      
      <a href="#" class="flex items-center gap-3 p-3 rounded hover:bg-white/5 transition-colors" onclick="alert('Match recordings feature coming soon!'); return false;">
        <i class="fas fa-video text-red-400"></i>
        <span>Match Recordings</span>
      </a>
      
      <a href="#" class="flex items-center gap-3 p-3 rounded hover:bg-white/5 transition-colors" onclick="alert('Team wiki feature coming soon!'); return false;">
        <i class="fas fa-file-alt text-purple-400"></i>
        <span>Team Wiki</span>
      </a>
    </div>
  </div>

  <!-- Recent Activity Card -->
  <div class="card glass p-6 md:col-span-2">
    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-history text-green-400"></i>
      Recent Activity
    </h3>
    
    <div class="space-y-3 max-h-64 overflow-y-auto">
      {% if activities %}
        {% for activity in activities|slice:":5" %}
        <div class="p-3 rounded-lg bg-gray-800/50 border border-gray-700 flex items-start gap-3">
          <i class="fas fa-circle-notch text-cyan-400 mt-1"></i>
          <div class="flex-1">
            <p class="text-sm">{{ activity.description|default:"Team activity" }}</p>
            <span class="text-xs text-gray-500">{{ activity.created_at|timesince }} ago</span>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <div class="text-center py-8 text-gray-500">
          <i class="fas fa-inbox text-4xl mb-2 opacity-50"></i>
          <p>No recent activity</p>
        </div>
      {% endif %}
    </div>
  </div>
</div>
