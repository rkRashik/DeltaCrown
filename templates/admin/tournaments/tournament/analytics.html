{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
  <h1>{{ title }}</h1>

  <div class="card" style="padding:16px; margin-bottom:16px;">
    <h2>Summary</h2>
    <p>
      Status: <strong>{{ tournament.status }}</strong> |
      Starts: <strong>{{ tournament.start_at|date:"M d, Y H:i" }}</strong> |
      Bracket: <strong>{{ stats.bracket.status }}</strong>
    </p>
  </div>

  <div class="card" style="padding:16px; margin-bottom:16px;">
    <h2>Registrations</h2>
    <ul>
      <li>Total: <strong>{{ stats.registrations.total }}</strong></li>
      <li>Confirmed: <strong>{{ stats.registrations.confirmed }}</strong></li>
      <li>Pending: <strong>{{ stats.registrations.pending }}</strong></li>
      <li>Checked-in: <strong>{{ stats.registrations.checked_in }}</strong></li>
      <li>Withdrawn: <strong>{{ stats.registrations.withdrawn }}</strong></li>
      <li>Solo: <strong>{{ stats.registrations.solo }}</strong> | Team: <strong>{{ stats.registrations.team }}</strong></li>
      <li>Verified payments: <strong>{{ stats.registrations.verified_payments }}</strong></li>
      <li>Revenue (BDT): <strong>{{ stats.registrations.revenue_bdt }}</strong></li>
    </ul>
  </div>

  <div class="card" style="padding:16px; margin-bottom:16px;">
    <h2>Matches</h2>
    <ul>
      <li>Total: <strong>{{ stats.matches.total }}</strong></li>
      <li>Unscheduled: <strong>{{ stats.matches.unscheduled }}</strong></li>
      <li>Upcoming 24h: <strong>{{ stats.matches.upcoming_24h }}</strong></li>
      <li>Max round: <strong>{{ stats.matches.max_round }}</strong></li>
    </ul>

    <h3>By State</h3>
    <table class="adminlist">
      <thead><tr><th>State</th><th>Count</th></tr></thead>
      <tbody>
        {% for state, n in stats.matches.by_state.items %}
          <tr><td>{{ state }}</td><td>{{ n }}</td></tr>
        {% empty %}
          <tr><td colspan="2"><em>No matches</em></td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="card" style="padding:16px; margin-bottom:16px;">
    <h2>Notifications</h2>
    <p>Total sent (this tournament): <strong>{{ stats.notifications.total }}</strong></p>
  </div>

  <p><a class="button" href="../">Back to tournament</a></p>
{% endblock %}
