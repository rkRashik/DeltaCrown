{% comment %}
Mobile Bottom Navigation â€” Fixed bar for small screens with 5 primary nav shortcuts + more menu.
Only visible below lg breakpoint.
{% endcomment %}
<nav id="mobileBottomNav"
     class="fixed bottom-0 left-0 right-0 z-40 lg:hidden border-t border-line bg-[var(--bg0)]/95 backdrop-blur-xl safe-bottom"
     role="navigation" aria-label="Mobile navigation">
    <div class="grid grid-cols-5 h-14">
        <button data-route="command" onclick="setActiveRoute('command')"
                class="mobile-nav-btn flex flex-col items-center justify-center gap-0.5 text-white transition">
            <i data-lucide="layout-dashboard" class="w-4.5 h-4.5"></i>
            <span class="text-[9px] font-medium leading-tight">Home</span>
        </button>
        <button data-route="roster" onclick="setActiveRoute('roster')"
                class="mobile-nav-btn flex flex-col items-center justify-center gap-0.5 text-white/40 transition">
            <i data-lucide="users" class="w-4.5 h-4.5"></i>
            <span class="text-[9px] font-medium leading-tight">Roster</span>
        </button>
        <button data-route="training" onclick="setActiveRoute('training')"
                class="mobile-nav-btn flex flex-col items-center justify-center gap-0.5 text-white/40 transition">
            <i data-lucide="crosshair" class="w-4.5 h-4.5"></i>
            <span class="text-[9px] font-medium leading-tight">Training</span>
        </button>
        <button data-route="community" onclick="setActiveRoute('community')"
                class="mobile-nav-btn flex flex-col items-center justify-center gap-0.5 text-white/40 transition">
            <i data-lucide="message-square" class="w-4.5 h-4.5"></i>
            <span class="text-[9px] font-medium leading-tight">Social</span>
        </button>
        <button id="mobileMoreBtn" data-route="more" onclick="toggleMobileMore()"
                class="mobile-nav-btn flex flex-col items-center justify-center gap-0.5 text-white/40 transition relative">
            <i data-lucide="grid-3x3" class="w-4.5 h-4.5"></i>
            <span class="text-[9px] font-medium leading-tight">More</span>
        </button>
    </div>

    {# More menu flyout #}
    <div id="mobileMoreMenu"
         class="hidden absolute bottom-full left-0 right-0 bg-[var(--bg1)] border-t border-line rounded-t-2xl shadow-2xl p-3 mb-0">
        <div class="grid grid-cols-4 gap-2">
            <button onclick="setActiveRoute('competition'); closeMobileMore()" class="flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white/5 transition">
                <div class="h-9 w-9 rounded-lg bg-amber-500/10 grid place-items-center"><i data-lucide="trophy" class="w-4 h-4 text-amber-400"></i></div>
                <span class="text-[10px] text-white/60">Compete</span>
            </button>
            <button onclick="setActiveRoute('profile'); closeMobileMore()" class="flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white/5 transition">
                <div class="h-9 w-9 rounded-lg bg-blue-500/10 grid place-items-center"><i data-lucide="palette" class="w-4 h-4 text-blue-400"></i></div>
                <span class="text-[10px] text-white/60">Profile</span>
            </button>
            <button onclick="setActiveRoute('settings'); closeMobileMore()" class="flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white/5 transition">
                <div class="h-9 w-9 rounded-lg bg-white/10 grid place-items-center"><i data-lucide="settings" class="w-4 h-4 text-white/60"></i></div>
                <span class="text-[10px] text-white/60">Settings</span>
            </button>
            <button onclick="setActiveRoute('treasury'); closeMobileMore()" class="flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white/5 transition">
                <div class="h-9 w-9 rounded-lg bg-emerald-500/10 grid place-items-center"><i data-lucide="wallet" class="w-4 h-4 text-emerald-400"></i></div>
                <span class="text-[10px] text-white/60">Treasury</span>
            </button>
            <button onclick="setActiveRoute('history'); closeMobileMore()" class="flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white/5 transition">
                <div class="h-9 w-9 rounded-lg bg-purple-500/10 grid place-items-center"><i data-lucide="clock" class="w-4 h-4 text-purple-400"></i></div>
                <span class="text-[10px] text-white/60">History</span>
            </button>
            <a href="{% url 'organizations:team_detail' team.slug %}" class="flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white/5 transition">
                <div class="h-9 w-9 rounded-lg bg-white/10 grid place-items-center"><i data-lucide="external-link" class="w-4 h-4 text-white/60"></i></div>
                <span class="text-[10px] text-white/60">Team</span>
            </a>
            <a href="/" class="flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white/5 transition">
                <div class="h-9 w-9 rounded-lg bg-white/10 grid place-items-center"><i data-lucide="home" class="w-4 h-4 text-white/60"></i></div>
                <span class="text-[10px] text-white/60">Platform</span>
            </a>
            <button onclick="setActiveRoute('guide'); closeMobileMore()" class="flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-white/5 transition">
                <div class="h-9 w-9 rounded-lg bg-teal-500/10 grid place-items-center"><i data-lucide="book-open" class="w-4 h-4 text-teal-400"></i></div>
                <span class="text-[10px] text-white/60">Guide</span>
            </button>
        </div>
    </div>
</nav>

<script>
    function toggleMobileMore() {
        const menu = document.getElementById('mobileMoreMenu');
        menu.classList.toggle('hidden');
    }
    function closeMobileMore() {
        document.getElementById('mobileMoreMenu')?.classList.add('hidden');
    }
    // Close on outside tap
    document.addEventListener('click', (e) => {
        const nav = document.getElementById('mobileBottomNav');
        if (nav && !nav.contains(e.target)) closeMobileMore();
    });
</script>
