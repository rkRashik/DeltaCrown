{% extends "base.html" %}
{% load static %}

{% block title %}DeltaCrown | Pro Profile - {{ profile_user.username|default:'Player' }}{% endblock %}

{% block extra_css %}
<!-- Google Fonts for profile design -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

<!-- Tailwind config for profile page -->
<script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Space Grotesk', 'sans-serif'],
                        mono: ['ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Consolas', "Liberation Mono", "Courier New", 'monospace'],
                    },
                    colors: {
                        z: {
                            bg: '#030014',       /* Deep Void */
                            panel: '#0F0B1E',    /* Glass Panel */
                            card: '#15102A',     /* Solid Card */
                            cyan: '#00F0FF',     /* Cyber Cyan */
                            purple: '#7B2CBF',   /* Electric Purple */
                            gold: '#FFD60A',     /* Trophy Gold */
                            red: '#FF007A',      /* Alert Red */
                            green: '#10B981',    /* Success Green */
                            accent: '#6366F1'    /* Indigo Accent */
                        }
                    },
                    backgroundImage: {
                        'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',
                        'card-shine': 'linear-gradient(105deg, transparent 20%, rgba(255,255,255,0.05) 25%, transparent 30%)',
                    },
                    boxShadow: {
                        'neon-cyan': '0 0 20px rgba(0, 240, 255, 0.25)',
                        'neon-purple': '0 0 20px rgba(123, 44, 191, 0.25)',
                        'neon-gold': '0 0 20px rgba(255, 214, 10, 0.25)',
                        'neon-red': '0 0 20px rgba(255, 0, 122, 0.25)',
                    },
                    animation: {
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'shine': 'shine 3s infinite linear',
                    },
                    keyframes: {
                        shine: {
                            '0%': { backgroundPosition: '200% center' },
                            '100%': { backgroundPosition: '-200% center' },
                        }
                    }
                }
            }
        }
</script>

<style>
    /* Profile page wrapper styling */
    .profile-zenith-wrapper {
        background-color: #030014;
        color: #e2e8f0;
        overflow-x: hidden;
        min-height: 100vh;
                radial-gradient(circle at 10% 20%, rgba(123, 44, 191, 0.15) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(0, 240, 255, 0.1) 0%, transparent 20%);
        }

        /* Glassmorphism Utilities */
        .glass-panel {
            background: rgba(15, 11, 30, 0.75);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }
        
        .glass-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.03) 0%, rgba(255, 255, 255, 0.01) 100%);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .glass-card:hover {
            background: rgba(255, 255, 255, 0.07);
            border-color: rgba(255, 255, 255, 0.15);
            transform: translateY(-4px);
            box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.5);
        }

        /* Gradient Text */
        .text-gradient-gold {
            background: linear-gradient(to right, #FFD60A, #FF9F0A);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .text-gradient-cyan {
            background: linear-gradient(to right, #00F0FF, #0099FF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #030014; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #00F0FF; }

        /* Grid Layout Fixes */
        .dashboard-grid {
            display: grid;
            gap: 1.5rem;
            grid-template-columns: 1fr;
            align-items: start; /* Prevents stretching to equalize height which looks bad when content differs */
        }
        
        @media (min-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: 320px minmax(0, 1fr) 320px;
            }
        }
    </style>
{% endblock %}

{% block content %}
<!-- Zenith Profile Wrapper for custom background -->
<div class="profile-zenith-wrapper">

    <header class="relative w-full h-[550px] lg:h-[650px] mb-8 group">
        
        <div class="absolute inset-0 w-full h-full overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-t from-z-bg via-z-bg/80 to-transparent z-10"></div>
            {% if profile.banner_url %}
            <img src="{{ profile.banner_url }}" 
                 class="w-full h-full object-cover object-center opacity-60 group-hover:scale-105 transition duration-[3s]" alt="Cover">
            {% else %}
            <img src="https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=2670&auto=format&fit=crop" 
                 class="w-full h-full object-cover object-center opacity-60 group-hover:scale-105 transition duration-[3s]" alt="Cover">
            {% endif %}
        </div>

        <div class="absolute bottom-0 left-0 w-full z-20 px-4 md:px-8 pb-8">
            <div class="max-w-[1600px] mx-auto flex flex-col md:flex-row items-end gap-8">
                
                <div class="relative shrink-0">
                    <div class="w-36 h-36 md:w-44 md:h-44 rounded-3xl p-1 bg-gradient-to-br from-z-cyan via-z-purple to-z-red shadow-neon-cyan relative group">
                        {% if profile.avatar_url %}
                        <img src="{{ profile.avatar_url }}" 
                             class="w-full h-full object-cover rounded-2xl bg-z-bg" alt="{{ profile_user.username }}">
                        {% else %}
                        <img src="https://images.unsplash.com/photo-1566492031773-4f4e44671857?q=80&w=1000&auto=format&fit=crop" 
                             class="w-full h-full object-cover rounded-2xl bg-z-bg" alt="Avatar">
                        {% endif %}
                        
                        <div class="absolute -bottom-3 -right-3 bg-z-bg p-1 rounded-xl">
                            <div class="bg-z-gold text-black font-black font-display text-sm px-3 py-1 rounded-lg border border-white/20 shadow-neon-gold">
                                LVL {{ user_profile.level|default:"1" }}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex-1 mb-2">
                    <div class="flex items-center gap-3 mb-2">
                        {% if user_teams and user_teams.0 %}
                        <span class="bg-white/10 backdrop-blur text-white text-[10px] font-bold px-2 py-0.5 rounded border border-white/10 hover:bg-white/20 cursor-pointer transition">
                            [{{ user_teams.0.tag|upper }}] {{ user_teams.0.name|upper }}
                        </span>
                        {% endif %}
                        {% if user_profile.kyc_status == 'verified' %}
                        <div class="flex items-center gap-1 bg-z-cyan/10 px-2 py-0.5 rounded border border-z-cyan/20">
                            <i class="fa-solid fa-circle-check text-sm text-z-cyan"></i>
                            <span class="text-[10px] text-z-cyan font-bold uppercase">Verified Pro</span>
                        </div>
                        {% endif %}
                    </div>

                    <h1 class="text-5xl md:text-7xl font-display font-bold text-white tracking-tight flex items-end gap-4 leading-none mb-2">
                        {{ profile.display_name|default:profile_user.username }}
                        <span class="text-xl font-mono font-normal text-gray-500 mb-2 tracking-widest">#{{ profile_user.username }}</span>
                    </h1>

                    {% if profile.bio %}
                    <p class="text-gray-300 text-base max-w-2xl font-light leading-relaxed border-l-2 border-z-purple pl-4 my-4">
                        {{ profile.bio }}
                    </p>
                    {% endif %}

                    <div class="flex flex-wrap items-center gap-8 mt-6">
                        <div class="text-center group cursor-pointer">
                            <div class="text-2xl font-bold text-white group-hover:text-z-cyan transition">{{ follower_count|default:0 }}</div>
                            <div class="text-[10px] text-gray-500 uppercase tracking-widest font-bold">Followers</div>
                        </div>
                        <div class="text-center group cursor-pointer">
                            <div class="text-2xl font-bold text-white group-hover:text-z-purple transition">{{ following_count|default:0 }}</div>
                            <div class="text-[10px] text-gray-500 uppercase tracking-widest font-bold">Following</div>
                        </div>
                        <div class="text-center group cursor-pointer">
                            <div class="text-2xl font-bold text-white group-hover:text-z-gold transition">{{ user_stats.total_wins|default:0 }}</div>
                            <div class="text-[10px] text-gray-500 uppercase tracking-widest font-bold">Wins</div>
                        </div>
                        
                        {% if identity_ctx.country_name %}
                        <div class="ml-auto md:ml-0 flex items-center gap-3 px-4 py-2 rounded-full bg-white/5 border border-white/10 hover:bg-white/10 transition cursor-pointer">
                            {% if identity_ctx.country_flag_url %}
                            <img src="{{ identity_ctx.country_flag_url }}" alt="{{ identity_ctx.country_name }} flag" class="w-5 h-4 object-cover rounded-sm">
                            {% endif %}
                            <span class="text-xs text-white font-bold">{{ identity_ctx.country_name }}</span>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <div class="hidden md:flex flex-col gap-3 shrink-0 mb-4">
                    {% if relationship_ctx.show_edit_button %}
                    <a href="{{ settings_url }}" class="bg-z-cyan text-black font-black font-display uppercase tracking-wider px-10 py-4 rounded-xl hover:bg-white hover:scale-105 transition shadow-neon-cyan flex items-center justify-center gap-2">
                        <i class="fa-solid fa-pen"></i> Edit Profile
                    </a>
                    {% else %}
                        {% if relationship_ctx.can_follow %}
                            {% if relationship_ctx.follow_requested %}
                            <button disabled class="bg-gray-500/50 text-white font-bold uppercase tracking-wider px-10 py-4 rounded-xl cursor-not-allowed flex items-center justify-center gap-2">
                                <i class="fa-solid fa-clock"></i> Requested
                            </button>
                            {% else %}
                            <a href="{{ follow_url }}" class="bg-z-cyan text-black font-black font-display uppercase tracking-wider px-10 py-4 rounded-xl hover:bg-white hover:scale-105 transition shadow-neon-cyan flex items-center justify-center gap-2">
                                <i class="fa-solid fa-user-plus"></i> {% if relationship_ctx.is_private_account %}Request Follow{% else %}Follow{% endif %}
                            </a>
                            {% endif %}
                        {% elif relationship_ctx.is_following %}
                        <a href="{{ unfollow_url }}" class="bg-white/10 text-white font-bold uppercase tracking-wider px-10 py-4 rounded-xl hover:bg-red-500/20 hover:text-red-400 transition flex items-center justify-center gap-2">
                            <i class="fa-solid fa-user-check"></i> Following
                        </a>
                        {% endif %}
                        {% if relationship_ctx.can_recruit %}
                        <button class="bg-z-purple/20 text-z-purple border border-z-purple/50 font-black font-display uppercase tracking-wider px-10 py-4 rounded-xl hover:bg-z-purple hover:text-white transition flex items-center justify-center gap-2">
                            <i class="fa-solid fa-file-signature"></i> Recruit
                        </button>
                        {% endif %}
                    {% endif %}
                    <div class="flex gap-2">
                        {% if preferred_contact.href and not relationship_ctx.show_edit_button %}
                        <a href="{{ preferred_contact.href }}" target="_blank" rel="noopener" class="flex-1 bg-z-purple/20 text-z-purple border border-z-purple/50 px-6 py-3 rounded-xl hover:bg-z-purple hover:text-white transition font-bold flex items-center justify-center gap-2">
                            <i class="{{ preferred_contact.icon }}"></i> Connect
                        </a>
                        {% endif %}
                        <button class="bg-white/5 text-white border border-white/10 px-5 py-3 rounded-xl hover:bg-white/10 transition">
                            <i class="fa-solid fa-share-nodes"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>


    <main class="max-w-[1600px] mx-auto px-4 md:px-8 pb-20 dashboard-grid">

        <aside class="space-y-6 order-2 lg:order-1">
            
            <div class="glass-panel p-6 rounded-2xl relative overflow-hidden group">
                <div class="absolute -right-8 -top-8 bg-gradient-to-br from-z-gold/20 to-transparent w-32 h-32 rounded-full blur-2xl"></div>
                
                <div class="flex justify-between items-center mb-4 relative z-10">
                    <h3 class="text-white font-bold font-display uppercase text-sm tracking-widest">Profile Status</h3>
                    <div class="bg-z-gold/20 text-z-gold px-2 py-1 rounded text-xs font-bold border border-z-gold/30">85%</div>
                </div>
                
                <div class="relative w-full h-3 bg-white/10 rounded-full mb-4 overflow-hidden">
                    <div class="absolute top-0 left-0 h-full bg-gradient-to-r from-z-gold to-[#FF9F0A] rounded-full" style="width: 85%"></div>
                </div>
                
                <p class="text-xs text-gray-400 mb-4">Complete your <span class="text-white font-bold">Hardware Loadout</span> to earn the Verified Badge.</p>
                <button class="w-full py-2.5 rounded-lg bg-white/5 border border-white/10 text-white text-xs font-bold hover:bg-z-gold hover:text-black hover:border-z-gold transition uppercase">
                    Complete Now
                </button>
            </div>

            <div class="glass-panel p-6 rounded-2xl">
                <div class="flex items-center justify-between mb-5 border-b border-white/5 pb-3">
                    <h3 class="text-gray-400 font-bold text-xs uppercase tracking-widest flex items-center gap-2">
                        <i class="fa-solid fa-link text-z-cyan"></i> Connect
                    </h3>
                </div>

                {% if is_owner or permissions.can_view_social_links %}
                    {# UP.2 FIX PASS #5 PART A: Discord-First Row with proper copy button (not inside <a>) #}
                    {% if discord_handle or discord_url %}
                    <div class="mb-4 p-3 rounded-xl bg-gradient-to-r from-z-purple/20 to-transparent border border-z-purple/30 flex items-center justify-between group">
                        <a href="{{ discord_url|default:'https://discord.com/' }}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 flex-1 min-w-0 hover:opacity-80 transition">
                            <div class="w-10 h-10 rounded-lg bg-z-purple flex items-center justify-center text-white text-lg shadow-lg">
                                <i class="fa-brands fa-discord"></i>
                            </div>
                            <div>
                                <div class="text-[9px] text-z-purple font-bold uppercase tracking-wider">Discord</div>
                                <div class="text-white font-mono text-sm font-bold">{{ discord_handle|default:"View Profile" }}</div>
                            </div>
                        </a>
                        {% if discord_handle %}
                        <button type="button" 
                                data-copy-text="{{ discord_handle }}" 
                                aria-label="Copy Discord username"
                                class="text-gray-400 hover:text-white transition-colors p-2 flex-shrink-0">
                            <i class="fa-regular fa-copy"></i>
                        </button>
                        {% endif %}
                    </div>
                    {% endif %}

                    {# UP.2 FIX PASS #5 PART B+C: Social Platform Grid - Loop through filtered links (exact URLs, no blanks) #}
                    <div class="grid grid-cols-3 gap-2">
                        {% for link in social_links_renderable %}
                            {% if link.platform != 'discord' %}
                                {% if link.platform == 'twitter' %}
                                <a href="{{ link.url }}" target="_blank" rel="noopener noreferrer" class="flex flex-col items-center justify-center p-3 rounded-xl bg-white/5 border border-white/5 hover:bg-black/40 hover:border-white/30 transition group" title="Twitter/X">
                                    <span class="text-gray-400 group-hover:text-white text-2xl font-bold mb-1">ùïè</span>
                                </a>
                                {% elif link.platform == 'twitch' %}
                                <a href="{{ link.url }}" target="_blank" rel="noopener noreferrer" class="flex flex-col items-center justify-center p-3 rounded-xl bg-white/5 border border-white/5 hover:bg-[#9146FF]/20 hover:border-[#9146FF]/50 transition group" title="Twitch">
                                    <i class="fa-brands fa-twitch text-gray-400 group-hover:text-[#9146FF] text-xl mb-1"></i>
                                </a>
                                {% elif link.platform == 'youtube' %}
                                <a href="{{ link.url }}" target="_blank" rel="noopener noreferrer" class="flex flex-col items-center justify-center p-3 rounded-xl bg-white/5 border border-white/5 hover:bg-[#FF0000]/20 hover:border-[#FF0000]/50 transition group" title="YouTube">
                                    <i class="fa-brands fa-youtube text-gray-400 group-hover:text-[#FF0000] text-xl mb-1"></i>
                                </a>
                                {% elif link.platform == 'facebook' %}
                                <a href="{{ link.url }}" target="_blank" rel="noopener noreferrer" class="flex flex-col items-center justify-center p-3 rounded-xl bg-white/5 border border-white/5 hover:bg-[#1877F2]/20 hover:border-[#1877F2]/50 transition group" title="Facebook">
                                    <i class="fa-brands fa-facebook text-gray-400 group-hover:text-[#1877F2] text-xl mb-1"></i>
                                </a>
                                {% elif link.platform == 'instagram' %}
                                <a href="{{ link.url }}" target="_blank" rel="noopener noreferrer" class="flex flex-col items-center justify-center p-3 rounded-xl bg-white/5 border border-white/5 hover:bg-[#E4405F]/20 hover:border-[#E4405F]/50 transition group" title="Instagram">
                                    <i class="fa-brands fa-instagram text-gray-400 group-hover:text-[#E4405F] text-xl mb-1"></i>
                                </a>
                                {% elif link.platform == 'tiktok' %}
                                <a href="{{ link.url }}" target="_blank" rel="noopener noreferrer" class="flex flex-col items-center justify-center p-3 rounded-xl bg-white/5 border border-white/5 hover:bg-black/40 hover:border-white/30 transition group" title="TikTok">
                                    <i class="fa-brands fa-tiktok text-gray-400 group-hover:text-white text-xl mb-1"></i>
                                </a>
                                {% elif link.platform == 'kick' %}
                                <a href="{{ link.url }}" target="_blank" rel="noopener noreferrer" class="flex flex-col items-center justify-center p-3 rounded-xl bg-white/5 border border-white/5 hover:bg-[#53FC18]/20 hover:border-[#53FC18]/50 transition group" title="Kick">
                                    <i class="fa-solid fa-k text-gray-400 group-hover:text-[#53FC18] text-xl mb-1"></i>
                                </a>
                                {% elif link.platform == 'steam' %}
                                <a href="{{ link.url }}" target="_blank" rel="noopener noreferrer" class="flex flex-col items-center justify-center p-3 rounded-xl bg-white/5 border border-white/5 hover:bg-[#171A21]/20 hover:border-white/30 transition group" title="Steam">
                                    <i class="fa-brands fa-steam text-gray-400 group-hover:text-white text-xl mb-1"></i>
                                </a>
                                {% elif link.platform == 'github' %}
                                <a href="{{ link.url }}" target="_blank" rel="noopener noreferrer" class="flex flex-col items-center justify-center p-3 rounded-xl bg-white/5 border border-white/5 hover:bg-black/40 hover:border-white/30 transition group" title="GitHub">
                                    <i class="fa-brands fa-github text-gray-400 group-hover:text-white text-xl mb-1"></i>
                                </a>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                    </div>
                    
                    {% if not social_links and not social_links_map.discord %}
                    <div class="text-center text-gray-500 text-xs py-4 italic">No social links connected</div>
                    {% endif %}
                {% else %}
                <div class="text-center text-gray-500 text-xs py-8 italic">
                    <i class="fa-solid fa-lock text-2xl mb-2 block"></i>
                    Contact info is private
                </div>
                {% endif %}
            </div>

            <div class="glass-panel p-6 rounded-2xl group cursor-pointer hover:border-z-green/30 transition">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-gray-400 font-bold text-xs uppercase tracking-widest flex items-center gap-2">
                        <i class="fa-solid fa-microchip text-z-green"></i> Gear
                    </h3>
                    <i class="fa-solid fa-arrow-right text-gray-600 -rotate-45 group-hover:text-z-green transition"></i>
                </div>
                <div class="space-y-3">
                    {% if hardware_gears %}
                        {% for gear in hardware_gears %}
                        <div class="flex items-center gap-3">
                            {% if gear.category == 'MOUSE' %}
                            <i class="fa-solid fa-computer-mouse text-gray-500"></i>
                            {% elif gear.category == 'KEYBOARD' %}
                            <i class="fa-regular fa-keyboard text-gray-500"></i>
                            {% elif gear.category == 'HEADSET' %}
                            <i class="fa-solid fa-headphones text-gray-500"></i>
                            {% elif gear.category == 'MONITOR' %}
                            <i class="fa-solid fa-desktop text-gray-500"></i>
                            {% elif gear.category == 'MOUSEPAD' %}
                            <i class="fa-solid fa-square text-gray-500"></i>
                            {% else %}
                            <i class="fa-solid fa-microchip text-gray-500"></i>
                            {% endif %}
                            <span class="text-sm text-white font-bold">{{ gear.brand }} {{ gear.model }}</span>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="text-center text-gray-500 text-xs py-2 italic">No gear configured</div>
                    {% endif %}
                </div>
            </div>

            <div class="glass-panel p-0 rounded-2xl overflow-hidden relative group cursor-pointer border border-z-gold/30">
                <div class="absolute inset-0 bg-gradient-to-br from-z-gold/10 via-z-bg to-z-bg group-hover:from-z-gold/20 transition duration-500"></div>
                
                <div class="p-6 relative z-10">
                    <div class="flex justify-between items-center mb-2">
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-full bg-z-gold/20 flex items-center justify-center border border-z-gold/50 text-z-gold shadow-[0_0_15px_rgba(255,214,10,0.4)]">
                                <i class="fa-solid fa-coins"></i>
                            </div>
                            <span class="text-xs font-bold text-z-gold uppercase tracking-wider">Wallet</span>
                        </div>
                        <i class="fa-solid fa-chevron-right text-xs text-z-gold/50"></i>
                    </div>
                    
                    {% if is_owner %}
                    <div class="mt-4">
                        <div class="text-[10px] text-gray-400 uppercase font-bold">Current Balance</div>
                        <div class="text-3xl font-display font-black text-white flex items-end gap-1">
                            {{ wallet_balance|floatformat:0 }}
                            <span class="text-sm font-sans text-z-gold font-bold mb-1">DC</span>
                        </div>
                    </div>
                    
                    <div class="mt-4 flex gap-2">
                        <button class="flex-1 py-2 rounded bg-z-gold text-black text-[10px] font-black uppercase hover:bg-white transition">Top Up</button>
                        <button class="flex-1 py-2 rounded bg-white/5 text-white text-[10px] font-black uppercase border border-white/10 hover:bg-white/10 transition">History</button>
                    </div>
                    {% else %}
                    <div class="mt-4 text-center py-6">
                        <i class="fa-solid fa-lock text-3xl text-gray-600 mb-2"></i>
                        <div class="text-xs text-gray-500 italic">Wallet balance is private</div>
                    </div>
                    {% endif %}
                </div>
            </div>

        </aside>


        <section class="space-y-6 order-1 lg:order-2 min-w-0">

            <nav class="flex overflow-x-auto pb-2 scrollbar-hide gap-2 border-b border-white/10 mb-4">
                <button class="shrink-0 px-6 py-3 rounded-t-xl bg-z-cyan/10 border-b-2 border-z-cyan text-z-cyan font-bold text-sm tracking-wide shadow-[0_4px_20px_-10px_rgba(0,240,255,0.3)]">Overview</button>
                <button class="shrink-0 px-6 py-3 rounded-t-xl text-gray-400 hover:text-white hover:bg-white/5 font-medium text-sm transition">Posts</button>
                <button class="shrink-0 px-6 py-3 rounded-t-xl text-gray-400 hover:text-white hover:bg-white/5 font-medium text-sm transition">Career</button>
                <button class="shrink-0 px-6 py-3 rounded-t-xl text-gray-400 hover:text-white hover:bg-white/5 font-medium text-sm transition">Game IDs</button>
                <button class="shrink-0 px-6 py-3 rounded-t-xl text-gray-400 hover:text-white hover:bg-white/5 font-medium text-sm transition">Inventory</button>
            </nav>

            <!-- UP.4 TACTICAL ABOUT SECTION (v4.0) -->
            {% include "user_profile/profile/partials/_about_tactical_v4.html" %}

            <div class="glass-panel p-6 rounded-2xl">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-gray-400 font-bold text-xs uppercase tracking-widest flex items-center gap-2">
                        <i class="fa-solid fa-chart-pie text-z-cyan"></i> Performance Analytics
                    </h3>
                    <select class="bg-black/40 text-white text-xs px-3 py-1 rounded border border-white/10 outline-none">
                        <option>Last 20 Matches</option>
                        <option>All Time</option>
                    </select>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="bg-black/20 rounded-xl p-4 border border-white/5 text-center relative overflow-hidden">
                        <div class="text-[10px] text-gray-500 uppercase font-bold mb-1">K/D Ratio</div>
                        <div class="text-2xl font-black text-white">{{ stats_ctx.kd_ratio|default:"0.00" }}</div>
                        <div class="text-[10px] text-gray-400 mt-1">{{ stats_ctx.total_kills|default:0 }} K / {{ stats_ctx.total_deaths|default:0 }} D</div>
                        <div class="absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-z-green to-transparent opacity-50"></div>
                    </div>
                    <div class="bg-black/20 rounded-xl p-4 border border-white/5 text-center relative overflow-hidden">
                        <div class="text-[10px] text-gray-500 uppercase font-bold mb-1">Win Rate</div>
                        <div class="text-2xl font-black text-white">{{ stats_ctx.win_rate|default:0 }}%</div>
                        <div class="text-[10px] text-gray-400 mt-1">{{ stats_ctx.total_wins|default:0 }} W / {{ stats_ctx.total_matches|default:0 }} M</div>
                         <div class="absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-z-cyan to-transparent opacity-50"></div>
                    </div>
                    <div class="bg-black/20 rounded-xl p-4 border border-white/5 text-center relative overflow-hidden">
                        <div class="text-[10px] text-gray-500 uppercase font-bold mb-1">Matches</div>
                        <div class="text-2xl font-black text-white">{{ stats_ctx.total_matches|default:0 }}</div>
                        <div class="text-[10px] text-gray-400 mt-1">Played</div>
                         <div class="absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-z-purple to-transparent opacity-50"></div>
                    </div>
                    <div class="bg-black/20 rounded-xl p-4 border border-white/5 text-center relative overflow-hidden">
                        <div class="text-[10px] text-gray-500 uppercase font-bold mb-1">Tournaments</div>
                        <div class="text-2xl font-black text-white">{{ stats_ctx.tournaments_won|default:0 }}</div>
                        <div class="text-[10px] text-gray-400 mt-1">Won / {{ stats_ctx.tournaments_played|default:0 }} Played</div>
                         <div class="absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-z-gold to-transparent opacity-50"></div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                
                <div class="glass-panel p-6 rounded-2xl hover:border-z-gold/50 transition duration-300 group cursor-pointer relative overflow-hidden">
                    <div class="absolute right-0 top-0 w-40 h-40 bg-z-gold/5 rounded-full blur-3xl group-hover:bg-z-gold/10 transition"></div>
                    
                    <div class="flex justify-between items-start mb-4">
                        <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-z-gold/20 to-transparent border border-z-gold/20 flex items-center justify-center text-z-gold text-xl shadow-lg">
                            <i class="fa-solid fa-trophy"></i>
                        </div>
                        <i class="fa-solid fa-arrow-right text-gray-600 group-hover:text-white -rotate-45 transition"></i>
                    </div>
                    
                    <h3 class="text-white font-bold font-display text-xl mb-1">Career</h3>
                    <p class="text-xs text-gray-400 mb-6 font-medium">Active in 2 Games</p>

                    <div class="space-y-4">
                        <div class="flex items-center gap-4 relative pl-4 border-l-2 border-z-green">
                            <div class="w-10 h-10 rounded-lg bg-white/10 flex items-center justify-center"><i class="fa-solid fa-v text-[#ff4655] font-bold"></i></div>
                            <div>
                                <div class="text-white text-sm font-bold">Team Liquid</div>
                                <div class="text-[10px] text-z-green font-bold uppercase tracking-wider">Current ‚Ä¢ 2024</div>
                            </div>
                        </div>
                        <div class="flex items-center gap-4 relative pl-4 border-l-2 border-gray-700 opacity-60 group-hover:opacity-100 transition">
                            <div class="w-10 h-10 rounded-lg bg-white/5 flex items-center justify-center text-xs font-bold">G2</div>
                            <div>
                                <div class="text-white text-sm font-bold">G2 Esports</div>
                                <div class="text-[10px] text-gray-400 font-bold uppercase tracking-wider">Former ‚Ä¢ 2023</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="glass-panel p-6 rounded-2xl hover:border-z-purple/50 transition duration-300 group cursor-pointer relative overflow-hidden">
                    <div class="absolute right-0 top-0 w-40 h-40 bg-z-purple/5 rounded-full blur-3xl group-hover:bg-z-purple/10 transition"></div>

                    <div class="flex justify-between items-start mb-4">
                        <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-z-purple/20 to-transparent border border-z-purple/20 flex items-center justify-center text-z-purple text-xl shadow-lg">
                            <i class="fa-solid fa-gamepad"></i>
                        </div>
                        <i class="fa-solid fa-arrow-right text-gray-600 group-hover:text-white -rotate-45 transition"></i>
                    </div>
                    
                    <h3 class="text-white font-bold font-display text-xl mb-1">Game Passports</h3>
                    <p class="text-xs text-gray-400 mb-6 font-medium">{{ pinned_passports|length|add:unpinned_passports|length }} Linked Account{{ pinned_passports|length|add:unpinned_passports|length|pluralize }}</p>

                    {% if is_owner or permissions.can_view_game_passports %}
                    <div class="space-y-3">
                        {# Show pinned passports first #}
                        {% for passport in pinned_passports %}
                        <div class="flex items-center justify-between p-3 rounded-xl bg-white/5 border border-white/5 hover:bg-white/10 transition">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded bg-z-cyan flex items-center justify-center text-white"><i class="fa-solid fa-gamepad"></i></div>
                                <div>
                                    <div class="text-white text-xs font-bold font-mono">{{ passport.in_game_name }}{% if passport.discriminator %}#{{ passport.discriminator }}{% endif %}</div>
                                    <div class="text-[10px] text-z-cyan">{% if passport.rank_name %}{{ passport.rank_name }}{% endif %}{% if passport.platform %} ‚Ä¢ {{ passport.platform }}{% endif %}</div>
                                </div>
                            </div>
                            {% if passport.is_verified %}
                            <i class="fa-solid fa-circle-check text-z-cyan text-sm shadow-neon-cyan"></i>
                            {% endif %}
                        </div>
                        {% endfor %}
                        {# Show unpinned passports #}
                        {% for passport in unpinned_passports %}
                        <div class="flex items-center justify-between p-3 rounded-xl bg-white/5 border border-white/5 hover:bg-white/10 transition">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded bg-gray-700 flex items-center justify-center text-white"><i class="fa-solid fa-gamepad"></i></div>
                                <div>
                                    <div class="text-white text-xs font-bold font-mono">{{ passport.in_game_name }}{% if passport.discriminator %}#{{ passport.discriminator }}{% endif %}</div>
                                    <div class="text-[10px] text-gray-400">{% if passport.rank_name %}{{ passport.rank_name }}{% endif %}{% if passport.platform %} ‚Ä¢ {{ passport.platform }}{% endif %}</div>
                                </div>
                            </div>
                            {% if passport.is_verified %}
                            <i class="fa-solid fa-circle-check text-gray-500 text-sm"></i>
                            {% endif %}
                        </div>
                        {% endfor %}
                        {# Empty state #}
                        {% if not pinned_passports and not unpinned_passports %}
                        <div class="text-center text-gray-500 text-xs py-4">No game passports linked yet</div>
                        {% endif %}
                    </div>
                    {% else %}
                    <div class="text-center text-gray-500 text-xs py-8 italic">
                        <i class="fa-solid fa-lock text-2xl mb-2 block"></i>
                        Game Passports are private
                    </div>
                    {% endif %}
                </div>

            </div>

        </section>


        <aside class="space-y-6 order-3">
            
            <div class="glass-panel p-6 rounded-2xl relative overflow-hidden">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-gray-400 font-bold text-xs uppercase tracking-widest flex items-center gap-2">
                        <i class="fa-solid fa-tower-broadcast text-z-red animate-pulse"></i> Live
                    </h3>
                    <span class="text-[10px] bg-z-red/20 text-z-red px-2 py-0.5 rounded font-bold">ON AIR</span>
                </div>
                
                <div class="bg-black/40 rounded-xl p-4 border border-white/10 text-center relative group cursor-pointer hover:border-z-red/50 transition">
                    <img src="https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=2670&auto=format&fit=crop" class="absolute inset-0 opacity-20 w-full h-full object-cover">
                    <div class="relative z-10">
                        <div class="text-[9px] text-gray-400 uppercase font-bold mb-2">Tournament ‚Ä¢ Finals</div>
                        <div class="flex items-center justify-center gap-3 mb-3">
                            <div class="font-black text-2xl text-white">TL</div>
                            <div class="text-xs text-z-red font-mono font-bold">VS</div>
                            <div class="font-black text-2xl text-white">SEN</div>
                        </div>
                        <button class="w-full py-2 rounded bg-z-red text-white text-xs font-bold hover:bg-white hover:text-z-red transition shadow-neon-red">
                            Watch Stream
                        </button>
                    </div>
                </div>
            </div>

            <div class="glass-panel p-6 rounded-2xl">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-gray-400 font-bold text-xs uppercase tracking-widest">Affiliations</h3>
                </div>
                
                {% if user_teams %}
                    {% for team in user_teams %}
                <div class="flex items-center gap-4 p-3 rounded-xl bg-white/5 border border-white/5 hover:border-z-cyan/50 hover:bg-white/10 transition cursor-pointer group mb-2">
                    {% if team.logo_url %}
                    <img src="{{ team.logo_url }}" alt="{{ team.name }}" class="w-12 h-12 rounded-lg object-cover border border-white/10">
                    {% else %}
                    <div class="w-12 h-12 rounded-lg bg-white/10 flex items-center justify-center font-black text-white border border-white/10">{{ team.tag|upper }}</div>
                    {% endif %}
                    <div class="flex-1">
                        <div class="text-white font-bold text-sm group-hover:text-z-cyan transition">{{ team.name }}</div>
                        <div class="text-[10px] text-gray-400">{{ team.role|default:'Member' }}{% if team.game %} ‚Ä¢ {{ team.game }}{% endif %}</div>
                    </div>
                </div>
                    {% endfor %}
                {% else %}
                <div class="text-center text-gray-500 text-xs py-4">No team affiliations yet</div>
                {% endif %}
            </div>

            <div class="glass-panel p-6 rounded-2xl">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-gray-400 font-bold text-xs uppercase tracking-widest">Trophies</h3>
                    <i class="fa-solid fa-chevron-right text-xs text-gray-600"></i>
                </div>
                
                <div class="grid grid-cols-4 gap-2">
                    <div class="aspect-square rounded-xl bg-gradient-to-br from-z-gold/20 to-transparent border border-z-gold/30 flex items-center justify-center text-2xl hover:scale-110 transition cursor-help shadow-[0_0_15px_rgba(255,214,10,0.2)]">üèÜ</div>
                    <div class="aspect-square rounded-xl bg-white/5 border border-white/10 flex items-center justify-center text-2xl hover:bg-white/10 transition">ü•á</div>
                    <div class="aspect-square rounded-xl bg-white/5 border border-white/10 flex items-center justify-center text-2xl hover:bg-white/10 transition">ü•à</div>
                    <div class="aspect-square rounded-xl bg-white/5 border border-white/10 flex items-center justify-center text-2xl hover:bg-white/10 transition">ü•â</div>
                </div>
            </div>

            <div class="glass-panel p-0 rounded-2xl overflow-hidden border border-z-red/30 relative group">
                <div class="absolute inset-0 bg-gradient-to-t from-z-red/10 via-z-bg to-z-bg"></div>
                
                <div class="p-6 relative z-10">
                    <div class="flex justify-between items-center mb-4">
                        <div class="flex items-center gap-2">
                            <i class="fa-solid fa-crosshairs text-z-red animate-pulse"></i>
                            <span class="text-xs font-bold text-z-red uppercase tracking-wider">Active Bounty</span>
                        </div>
                        <div class="text-[10px] text-white bg-z-red px-2 py-0.5 rounded font-bold">HARD</div>
                    </div>
                    
                    <h4 class="text-white font-bold text-sm leading-tight mb-2">Headhunter Challenge</h4>
                    <p class="text-[10px] text-gray-400 mb-3">Get 50 Headshots in Ranked matches this week.</p>
                    
                    <div class="flex justify-between text-[10px] text-gray-300 mb-1 font-mono">
                        <span>32 / 50</span>
                        <span>64%</span>
                    </div>
                    <div class="w-full h-1.5 bg-gray-800 rounded-full mb-4">
                        <div class="h-full bg-z-red rounded-full shadow-neon-red" style="width: 64%"></div>
                    </div>

                    <div class="flex items-center justify-between border-t border-white/10 pt-3">
                        <div class="flex items-center gap-1">
                            <span class="text-xs font-bold text-z-gold">500</span>
                            <span class="text-[9px] text-gray-400">DC REWARD</span>
                        </div>
                        <button class="text-[10px] text-white hover:text-z-red transition font-bold uppercase">View Details</button>
                    </div>
                </div>
            </div>

        </aside>

    </main>

    <div class="lg:hidden fixed bottom-0 left-0 w-full glass-panel border-t border-white/10 z-50 px-6 py-4 flex justify-between items-center text-2xl text-gray-500 pb-safe">
        <button class="text-z-cyan drop-shadow-[0_0_10px_rgba(0,240,255,0.5)]"><i class="fa-solid fa-user"></i></button>
        <button class="hover:text-white transition"><i class="fa-solid fa-users"></i></button>
        <div class="w-14 h-14 bg-gradient-to-br from-z-cyan to-z-purple rounded-full -mt-10 border-4 border-z-bg flex items-center justify-center text-white shadow-neon-purple hover:scale-110 transition cursor-pointer">
            <i class="fa-solid fa-plus text-xl"></i>
        </div>
        <button class="hover:text-white transition"><i class="fa-solid fa-trophy"></i></button>
        <button class="hover:text-white transition"><i class="fa-solid fa-bars"></i></button>
    </div>

</div>
<!-- End Zenith Profile Wrapper -->

{# UP.2 FIX PASS #5 PART A: Clipboard copy JS for Discord button #}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Attach clipboard copy to all [data-copy-text] buttons
    const copyButtons = document.querySelectorAll('[data-copy-text]');
    
    copyButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const textToCopy = this.getAttribute('data-copy-text');
            
            if (navigator.clipboard && textToCopy) {
                navigator.clipboard.writeText(textToCopy).then(() => {
                    // Success feedback
                    const originalHTML = this.innerHTML;
                    this.innerHTML = '<i class="fa-solid fa-check text-green-400"></i>';
                    
                    setTimeout(() => {
                        this.innerHTML = originalHTML;
                    }, 1500);
                }).catch(err => {
                    console.error('Failed to copy:', err);
                    alert('Copied: ' + textToCopy);
                });
            }
        });
    });
});
</script>

{% endblock %}
T h u r s d a y ,   J a n u a r y   1 5 ,   2 0 2 6   1 : 0 0 : 2 5   P M 