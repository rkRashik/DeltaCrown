<!-- ============================================
     WALLET COMPONENT
     Section 3.3.8 - Master Plan
     Display: Balance, Transactions (Owner Only)
     Features: Blur Toggle, Coin Animation
     ============================================ -->
{% if is_own_profile %}
<div class="glass-card p-6 space-y-6"
     x-data="{ walletBlurred: true }">
    
    <!-- Header -->
    <div class="flex items-center justify-between mb-2">
        <h3 class="text-white font-bold text-lg uppercase tracking-wide flex items-center gap-2">
            <span>ğŸ’°</span> Wallet
        </h3>
        <button @click="walletBlurred = !walletBlurred" 
                class="text-slate-400 hover:text-white transition-colors">
            <span x-show="walletBlurred">ğŸ‘</span>
            <span x-show="!walletBlurred" style="display: none;">ğŸ‘â€ğŸ—¨</span>
        </button>
    </div>
    
    <!-- Balance Display -->
    <div class="relative p-6 rounded-xl bg-gradient-to-br from-amber-500/10 via-yellow-500/5 to-transparent border border-amber-500/20 overflow-hidden">
        
        <!-- Animated Coin Background -->
        <div class="absolute top-4 right-4 text-6xl opacity-10 animate-spin-slow">ğŸ’°</div>
        
        <!-- Balance -->
        <div class="relative z-10">
            <p class="text-xs text-amber-400 uppercase tracking-wide font-semibold mb-2">Available Balance</p>
            <div :class="walletBlurred ? 'filter blur-md select-none' : ''" 
                 class="transition-all duration-300">
                <p class="text-4xl md:text-5xl font-black text-white mb-1">
                    {% if wallet %}{{ wallet.cached_balance|floatformat:0 }}{% else %}0{% endif %}
                    <span class="text-2xl text-amber-400 font-bold">DC</span>
                </p>
                <p class="text-sm text-slate-400">
                    â‰ˆ ${% if wallet %}{{ usd_equivalent|floatformat:2 }}{% else %}0.00{% endif %} USD
                </p>
            </div>
        </div>
        
    </div>
    
    <!-- Quick Actions -->
    <div class="grid grid-cols-2 gap-3">
        <a href="{% url 'economy:deposit' %}" 
           class="flex items-center justify-center gap-2 px-4 py-3 rounded-lg bg-emerald-600 hover:bg-emerald-500 
                  text-white font-bold text-sm transition-colors">
            <span>ğŸ’³</span> Deposit
        </a>
        <a href="{% url 'economy:withdraw' %}" 
           class="flex items-center justify-center gap-2 px-4 py-3 rounded-lg bg-slate-700 hover:bg-slate-600 
                  text-white font-bold text-sm transition-colors">
            <span>ğŸ¦</span> Withdraw
        </a>
    </div>
    
    <!-- Recent Transactions -->
    <div class="pt-4 border-t border-white/5">
        <h4 class="text-slate-300 text-sm font-semibold mb-3">Recent Transactions</h4>
        
        {% if recent_transactions %}
        <div class="space-y-2">
            {% for transaction in recent_transactions|slice:":3" %}
            <div class="flex items-center justify-between p-3 rounded-lg bg-slate-800/20 border border-white/5">
                
                <!-- Left: Type + Description -->
                <div class="flex items-center gap-3">
                    <span class="text-2xl">
                        {% if transaction.type == 'deposit' %}ğŸ’³
                        {% elif transaction.type == 'withdraw' %}ğŸ¦
                        {% elif transaction.type == 'prize' %}ğŸ†
                        {% elif transaction.type == 'entry_fee' %}ğŸ®
                        {% else %}ğŸ’°
                        {% endif %}
                    </span>
                    <div>
                        <p class="text-white text-sm font-semibold">{{ transaction.description|truncatewords:4 }}</p>
                        <p class="text-slate-500 text-xs">{{ transaction.created_at|timesince }} ago</p>
                    </div>
                </div>
                
                <!-- Right: Amount -->
                <div class="text-right">
                    <p class="text-sm font-bold
                              {% if transaction.transaction_type == 'credit' or transaction.amount > 0 %}text-emerald-400{% else %}text-rose-400{% endif %}">
                        {% if transaction.amount > 0 %}+{% endif %}{{ transaction.amount|floatformat:2 }}
                    </p>
                    <p class="text-xs text-slate-500">DC</p>
                </div>
                
            </div>
            {% endfor %}
        </div>
        
        <div class="text-center mt-3">
            <a href="{% url 'economy:transaction_history' %}" 
               class="text-indigo-400 hover:text-indigo-300 text-sm font-semibold transition-colors">
                View All Transactions â†’
            </a>
        </div>
        {% else %}
        <div class="text-center py-4">
            <p class="text-slate-500 text-sm">No transactions yet</p>
        </div>
        {% endif %}
        
    </div>
    
</div>

{% else %}

<!-- Spectator View (Hidden Wallet) -->
<div class="glass-card p-6 text-center py-12">
    <div class="text-6xl mb-3 opacity-30">ğŸ”’</div>
    <p class="text-slate-500 text-sm font-semibold">Wallet is Private</p>
    <p class="text-slate-600 text-xs mt-1">Only the owner can view wallet details</p>
</div>

{% endif %}
