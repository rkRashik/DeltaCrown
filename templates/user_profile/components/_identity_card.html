<!-- ============================================
     IDENTITY CARD COMPONENT
     Section 3.3.1 - Master Plan
     Display: Bio, Location, Join Date, Pronouns
     Owner: Editable via Modal
     ============================================ -->
<div class="glass-card p-6 space-y-4">
    
    <!-- Header -->
    <div class="flex items-center justify-between mb-2">
        <h3 class="text-white font-bold text-lg uppercase tracking-wide">About</h3>
        {% if is_own_profile %}
        <button @click="$dispatch('open-bio-modal')" 
                class="text-indigo-400 hover:text-indigo-300 text-sm font-semibold transition-colors">
            ‚úè Edit
        </button>
        {% endif %}
    </div>
    
    <!-- Bio Text -->
    <div class="text-slate-300 text-sm leading-relaxed">
        {% if profile.bio %}
            <p>{{ profile.bio }}</p>
        {% else %}
            {% if is_own_profile %}
                <p class="text-slate-500 italic">Tell the community about yourself...</p>
            {% else %}
                <p class="text-slate-500 italic">No bio yet.</p>
            {% endif %}
        {% endif %}
    </div>
    
    <!-- Metadata Grid -->
    <div class="space-y-3 pt-2 border-t border-white/5">
        
        <!-- Location -->
        {% if profile.country or profile.city %}
        <div class="flex items-start gap-3">
            <span class="text-slate-500 text-lg flex-shrink-0">üìç</span>
            <div class="flex-1">
                <p class="text-xs text-slate-500 uppercase tracking-wide mb-0.5">Location</p>
                <p class="text-white font-semibold">
                    {% if profile.city %}{{ profile.city }}, {% endif %}{{ profile.country|default:"Unknown" }}
                </p>
            </div>
        </div>
        {% endif %}
        
        <!-- Pronouns -->
        {% if profile.pronouns %}
        <div class="flex items-start gap-3">
            <span class="text-slate-500 text-lg flex-shrink-0">üë§</span>
            <div class="flex-1">
                <p class="text-xs text-slate-500 uppercase tracking-wide mb-0.5">Pronouns</p>
                <p class="text-white font-semibold">{{ profile.pronouns }}</p>
            </div>
        </div>
        {% endif %}
        
        <!-- Join Date -->
        <div class="flex items-start gap-3">
            <span class="text-slate-500 text-lg flex-shrink-0">üìÖ</span>
            <div class="flex-1">
                <p class="text-xs text-slate-500 uppercase tracking-wide mb-0.5">Member Since</p>
                <p class="text-white font-semibold">{{ profile_user.date_joined|date:"F Y" }}</p>
            </div>
        </div>
        
        <!-- Age (if available and public) -->
        {% if profile.age and profile.show_age %}
        <div class="flex items-start gap-3">
            <span class="text-slate-500 text-lg flex-shrink-0">üéÇ</span>
            <div class="flex-1">
                <p class="text-xs text-slate-500 uppercase tracking-wide mb-0.5">Age</p>
                <p class="text-white font-semibold">{{ profile.age }} years</p>
            </div>
        </div>
        {% endif %}
        
        <!-- Phone (if available and visible) -->
        {% if profile.phone_number %}
        <div class="flex items-start gap-3">
            <span class="text-slate-500 text-lg flex-shrink-0">üì±</span>
            <div class="flex-1">
                <p class="text-xs text-slate-500 uppercase tracking-wide mb-0.5">Phone</p>
                {% if is_own_profile or profile.privacy.show_phone %}
                <p class="text-white font-semibold">{{ profile.phone_number }}</p>
                {% else %}
                <p class="text-slate-600 italic text-sm">Hidden</p>
                {% endif %}
            </div>
        </div>
        {% endif %}
        
    </div>
    
</div>

<!-- ============================================
     EDIT BIO MODAL
     Alpine.js Modal with Character Counter
     ============================================ -->
{% if is_own_profile %}
<div x-data="{ 
        showBioModal: false,
        bioText: '{{ profile.bio|default:""|escapejs }}',
        maxChars: 500,
        get remainingChars() { return this.maxChars - this.bioText.length; },
        get isOverLimit() { return this.bioText.length > this.maxChars; }
     }"
     @open-bio-modal.window="showBioModal = true"
     @keydown.escape.window="showBioModal = false"
     x-show="showBioModal"
     x-transition:enter="transition ease-out duration-200"
     x-transition:enter-start="opacity-0"
     x-transition:enter-end="opacity-100"
     x-transition:leave="transition ease-in duration-150"
     x-transition:leave-start="opacity-100"
     x-transition:leave-end="opacity-0"
     class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm"
     style="display: none;">
    
    <!-- Modal Card -->
    <div @click.away="showBioModal = false"
         x-transition:enter="transition ease-out duration-200 transform"
         x-transition:enter-start="opacity-0 scale-95"
         x-transition:enter-end="opacity-100 scale-100"
         x-transition:leave="transition ease-in duration-150 transform"
         x-transition:leave-start="opacity-100 scale-100"
         x-transition:leave-end="opacity-0 scale-95"
         class="glass-card w-full max-w-2xl max-h-[90vh] overflow-y-auto">
        
        <!-- Header -->
        <div class="sticky top-0 bg-slate-900/95 backdrop-blur-xl px-6 py-4 border-b border-white/10 flex items-center justify-between">
            <h2 class="text-xl font-bold text-white uppercase tracking-wide">Edit Bio</h2>
            <button @click="showBioModal = false" 
                    class="text-slate-400 hover:text-white text-2xl leading-none transition-colors">
                √ó
            </button>
        </div>
        
        <!-- Body -->
        <div class="p-6 space-y-6">
            
            <form method="POST" action="{% url 'user_profile:update_bio' %}" 
                  @submit="if(isOverLimit) { $event.preventDefault(); $dispatch('show-toast', { message: 'Bio is too long!', icon: '‚ùå' }); }">
                {% csrf_token %}
                
                <!-- Textarea -->
                <div class="relative">
                    <textarea name="bio" 
                              x-model="bioText"
                              rows="8"
                              maxlength="550"
                              placeholder="Tell the community about yourself..."
                              class="glass-input w-full px-4 py-3 rounded-lg text-white placeholder-slate-500 
                                     focus:ring-2 focus:ring-indigo-500 focus:outline-none resize-none"
                              :class="isOverLimit ? 'ring-2 ring-rose-500' : ''"></textarea>
                    
                    <!-- Character Counter -->
                    <div class="absolute bottom-3 right-3 text-xs font-semibold"
                         :class="isOverLimit ? 'text-rose-500' : remainingChars < 50 ? 'text-amber-500' : 'text-slate-500'">
                        <span x-text="remainingChars"></span> / {{ maxChars }}
                    </div>
                </div>
                
                <!-- Guidelines -->
                <div class="bg-slate-800/50 border border-slate-700 rounded-lg p-4">
                    <p class="text-slate-400 text-sm mb-2 font-semibold">‚úè Guidelines</p>
                    <ul class="text-slate-500 text-xs space-y-1 list-disc list-inside">
                        <li>Keep it respectful and appropriate</li>
                        <li>No advertising or spam</li>
                        <li>Share your gaming journey, achievements, or interests</li>
                        <li>Maximum 500 characters</li>
                    </ul>
                </div>
                
                <!-- Actions -->
                <div class="flex gap-3 pt-2">
                    <button type="button" 
                            @click="showBioModal = false"
                            class="flex-1 px-6 py-3 rounded-lg font-bold text-white bg-slate-700 hover:bg-slate-600 transition-colors">
                        Cancel
                    </button>
                    <button type="submit"
                            :disabled="isOverLimit"
                            :class="isOverLimit ? 'opacity-50 cursor-not-allowed' : 'hover:from-indigo-500 hover:to-purple-500'"
                            class="flex-1 px-6 py-3 rounded-lg font-bold text-white bg-gradient-to-r from-indigo-600 to-purple-600 transition-all">
                        üíæ Save Bio
                    </button>
                </div>
                
            </form>
            
        </div>
        
    </div>
    
</div>
{% endif %}
