{% extends "base.html" %}
{% block title %}Dashboard — DeltaCrown{% endblock %}

{% block content %}
<section aria-labelledby="page-title">
  <h1 id="page-title" class="mb-3">Dashboard</h1>
  <p class="text-muted">Welcome back{% if request.user.is_authenticated %}, {{ request.user.username }}{% endif %}.</p>

  <div class="row g-3 mt-3">
    <div class="col-12 col-lg-6">
      <div class="card p-3 h-100">
        <h2 class="h5 mb-3">Upcoming matches</h2>
        {% if upcoming_matches %}
          <ul class="list-unstyled mb-0">
            {% for m in upcoming_matches %}
              <li class="mb-3 p-2 rounded border d-flex align-items-center justify-content-between">
                <div>
                  <div class="small text-muted">Round {{ m.round_no }}</div>
                  <div class="fw-medium">
                    {% if m.is_solo_match %}
                      {{ m.user_a.display_name|default:"—" }} vs {{ m.user_b.display_name|default:"—" }}
                    {% else %}
                      {{ m.team_a.tag|default:"—" }} vs {{ m.team_b.tag|default:"—" }}
                    {% endif %}
                  </div>
                  <div class="small text-muted">
                    {{ m.tournament.name }} ·
                    <span>
                      {% if m.scheduled_at %}{{ m.scheduled_at|date:"M d, Y h:i A" }}{% else %}Time: —{% endif %}
                    </span>
                  </div>
                </div>
                <div class="d-flex gap-2">
                  <a class="btn btn-sm btn-outline" href="{% url 'tournaments:match_review' m.id %}">Review</a>
                  <a class="btn btn-sm btn-primary" href="{% url 'tournaments:match_report' m.id %}">Report</a>
                </div>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="alert alert-info mb-0">No upcoming matches</div>
        {% endif %}
      </div>
    </div>

    <div class="col-12 col-lg-6">
      <div class="card p-3 h-100">
        <h2 class="h5 mb-3">Recent notifications</h2>
        {% if recent_notifications %}
          <ul class="mb-0 list-unstyled">
            {% for n in recent_notifications %}
              <li class="mb-2">
                <div class="fw-medium">{{ n.title|default:n.subject|default:"Notification" }}</div>
                <div class="small text-muted">
                  {% if n.created_at %}{{ n.created_at|date:"M d, Y h:i A" }}
                  {% elif n.timestamp %}{{ n.timestamp|date:"M d, Y h:i A" }}{% endif %}
                </div>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="alert alert-info mb-0">No notifications yet.</div>
        {% endif %}
      </div>
    </div>
  </div>
</section>
{% endblock %}
