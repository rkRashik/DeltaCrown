{% extends "base.html" %}
{% load static %}

{% block title %}My Matches â€” DeltaCrown{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto px-4 py-6">
  <div class="flex items-center justify-between gap-3 mb-4">
    <h1 class="text-2xl font-bold">My Matches</h1>

    <!-- Grouping control -->
    <form method="get" class="flex items-center gap-2">
      {# Keep current filters intact #}
      <input type="hidden" name="game" value="{{ params.game }}">
      <input type="hidden" name="state" value="{{ params.state }}">
      <input type="hidden" name="tournament_id" value="{{ params.tournament_id }}">
      <input type="hidden" name="start_date" value="{{ params.start_date }}">
      <input type="hidden" name="end_date" value="{{ params.end_date }}">
      <label for="group" class="text-sm">Group by</label>
      <select id="group" name="group" class="form-select text-sm">
        <option value="" {% if not group_by %}selected{% endif %}>None</option>
        <option value="tournament" {% if group_by == "tournament" %}selected{% endif %}>Tournament</option>
        <option value="date" {% if group_by == "date" %}selected{% endif %}>Date</option>
      </select>
      <button class="btn btn-secondary btn-sm" type="submit">Apply</button>
    </form>
  </div>

  <!-- Counters -->
  <div class="grid grid-cols-3 gap-3 mb-4">
    <div class="rounded-xl border border-white/10 p-3">
      <div class="text-sm text-white/60">Upcoming</div>
      <div class="text-2xl font-bold">{{ counters.upcoming }}</div>
    </div>
    <div class="rounded-xl border border-white/10 p-3">
      <div class="text-sm text-white/60">Live</div>
      <div class="text-2xl font-bold">{{ counters.live }}</div>
    </div>
    <div class="rounded-xl border border-white/10 p-3">
      <div class="text-sm text-white/60">Completed</div>
      <div class="text-2xl font-bold">{{ counters.completed }}</div>
    </div>
  </div>

  {# Group headers are emitted inside the list partial using {% ifchanged %} #}
  {% include "dashboard/partials/_my_matches_list.html" with matches=page_obj.object_list group_by=group_by %}

  {% include "dashboard/partials/_pager.html" with page_obj=page_obj %}
</div>
{% endblock %}
