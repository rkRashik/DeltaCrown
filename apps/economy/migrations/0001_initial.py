# Generated by Django 5.2.8 on 2026-01-23 17:57

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name="CoinPolicy",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
                    ),
                ),
                (
                    "tournament_id",
                    models.IntegerField(
                        blank=True,
                        db_index=True,
                        help_text="Legacy tournament ID (reference only)",
                        null=True,
                        unique=True,
                    ),
                ),
                ("enabled", models.BooleanField(default=True)),
                ("participation", models.PositiveIntegerField(default=5)),
                ("top4", models.PositiveIntegerField(default=25)),
                ("runner_up", models.PositiveIntegerField(default=50)),
                ("winner", models.PositiveIntegerField(default=100)),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
            ],
        ),
        migrations.CreateModel(
            name="DeltaCrownWallet",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
                    ),
                ),
                ("cached_balance", models.IntegerField(default=0)),
                (
                    "allow_overdraft",
                    models.BooleanField(
                        default=False,
                        help_text="If True, allows negative balance (overdraft). Default: False (reject insufficient funds).",
                    ),
                ),
                (
                    "bkash_number",
                    models.CharField(
                        blank=True,
                        default="",
                        help_text="bKash mobile wallet number (e.g., 01712345678)",
                        max_length=15,
                    ),
                ),
                (
                    "nagad_number",
                    models.CharField(
                        blank=True,
                        default="",
                        help_text="Nagad mobile wallet number (e.g., 01812345678)",
                        max_length=15,
                    ),
                ),
                (
                    "rocket_number",
                    models.CharField(
                        blank=True,
                        default="",
                        help_text="Rocket mobile wallet number (e.g., 01912345678)",
                        max_length=15,
                    ),
                ),
                (
                    "bank_account_name",
                    models.CharField(
                        blank=True,
                        default="",
                        help_text="Full name as per bank account",
                        max_length=100,
                    ),
                ),
                (
                    "bank_account_number",
                    models.CharField(
                        blank=True, default="", help_text="Bank account number", max_length=30
                    ),
                ),
                (
                    "bank_name",
                    models.CharField(
                        blank=True,
                        default="",
                        help_text="Name of the bank (e.g., Dutch-Bangla Bank, Brac Bank)",
                        max_length=100,
                    ),
                ),
                (
                    "bank_branch",
                    models.CharField(
                        blank=True, default="", help_text="Branch name or code", max_length=100
                    ),
                ),
                (
                    "pin_hash",
                    models.CharField(
                        blank=True,
                        default="",
                        help_text="Hashed 6-digit PIN for withdrawal verification",
                        max_length=255,
                    ),
                ),
                (
                    "pin_enabled",
                    models.BooleanField(
                        default=False, help_text="Whether PIN protection is enabled"
                    ),
                ),
                (
                    "pin_failed_attempts",
                    models.IntegerField(
                        default=0, help_text="Number of consecutive failed PIN attempts"
                    ),
                ),
                (
                    "pin_locked_until",
                    models.DateTimeField(
                        blank=True,
                        help_text="PIN lockout expiry timestamp (15 min after 5 failed attempts)",
                        null=True,
                    ),
                ),
                (
                    "pending_balance",
                    models.IntegerField(
                        default=0, help_text="Balance locked in pending withdrawals"
                    ),
                ),
                (
                    "lifetime_earnings",
                    models.IntegerField(
                        default=0, help_text="Total DeltaCoins earned from prizes (all-time)"
                    ),
                ),
                (
                    "last_withdrawal_at",
                    models.DateTimeField(
                        blank=True, help_text="Last successful withdrawal timestamp", null=True
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
            ],
            options={
                "verbose_name": "DeltaCrown Wallet",
            },
        ),
        migrations.CreateModel(
            name="GiftRequest",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
                    ),
                ),
                ("quantity", models.PositiveIntegerField(default=1)),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("PENDING", "Pending"),
                            ("ACCEPTED", "Accepted"),
                            ("REJECTED", "Rejected"),
                            ("CANCELED", "Canceled"),
                        ],
                        db_index=True,
                        default="PENDING",
                        max_length=20,
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("resolved_at", models.DateTimeField(blank=True, null=True)),
                (
                    "message",
                    models.TextField(
                        blank=True,
                        default="",
                        help_text="Optional message from sender",
                        max_length=500,
                    ),
                ),
            ],
            options={
                "verbose_name": "Gift Request",
                "verbose_name_plural": "Gift Requests",
                "db_table": "economy_gift_request",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="InventoryItem",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
                    ),
                ),
                (
                    "slug",
                    models.SlugField(
                        help_text="Unique immutable identifier (e.g., awp-dragon-lore)",
                        max_length=100,
                        unique=True,
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        help_text="Display name (e.g., AWP | Dragon Lore)", max_length=200
                    ),
                ),
                (
                    "description",
                    models.TextField(
                        blank=True, default="", help_text="Item description for users"
                    ),
                ),
                (
                    "item_type",
                    models.CharField(
                        choices=[
                            ("COSMETIC", "Cosmetic Skin"),
                            ("CASE", "Loot Case"),
                            ("TOKEN", "Special Token"),
                            ("COLLECTIBLE", "Collectible Item"),
                            ("BADGE", "Achievement Badge"),
                        ],
                        db_index=True,
                        max_length=20,
                    ),
                ),
                (
                    "rarity",
                    models.CharField(
                        choices=[
                            ("COMMON", "Common"),
                            ("RARE", "Rare"),
                            ("EPIC", "Epic"),
                            ("LEGENDARY", "Legendary"),
                        ],
                        db_index=True,
                        max_length=20,
                    ),
                ),
                (
                    "tradable",
                    models.BooleanField(
                        default=False, help_text="Can this item be traded between users?"
                    ),
                ),
                (
                    "giftable",
                    models.BooleanField(
                        default=False, help_text="Can this item be gifted to other users?"
                    ),
                ),
                (
                    "icon",
                    models.ImageField(
                        blank=True,
                        help_text="Item icon/image",
                        null=True,
                        upload_to="inventory/items/",
                    ),
                ),
                (
                    "icon_url",
                    models.URLField(
                        blank=True,
                        default="",
                        help_text="External icon URL (if not using ImageField)",
                        max_length=500,
                    ),
                ),
                (
                    "metadata",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="Additional item data (game-specific, stats, etc.)",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
            ],
            options={
                "verbose_name": "Inventory Item",
                "verbose_name_plural": "Inventory Items",
                "db_table": "economy_inventory_item",
                "ordering": ["name"],
            },
        ),
        migrations.CreateModel(
            name="TopUpRequest",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
                    ),
                ),
                ("amount", models.PositiveIntegerField(help_text="Amount in DeltaCoins to add")),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("pending", "Pending Review"),
                            ("approved", "Approved"),
                            ("completed", "Completed"),
                            ("rejected", "Rejected"),
                            ("cancelled", "Cancelled"),
                        ],
                        default="pending",
                        max_length=20,
                    ),
                ),
                (
                    "payment_method",
                    models.CharField(
                        choices=[
                            ("bkash", "bKash"),
                            ("nagad", "Nagad"),
                            ("rocket", "Rocket"),
                            ("bank", "Bank Transfer"),
                        ],
                        max_length=20,
                    ),
                ),
                (
                    "payment_number",
                    models.CharField(
                        help_text="bKash/Nagad/Rocket transaction ID or bank reference",
                        max_length=50,
                    ),
                ),
                (
                    "payment_details",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="Additional payment info (sender name, transaction ID, etc.)",
                    ),
                ),
                (
                    "dc_to_bdt_rate",
                    models.DecimalField(
                        decimal_places=2,
                        default=1.0,
                        help_text="DeltaCoin to BDT exchange rate (e.g., 1 DC = 1.00 BDT)",
                        max_digits=10,
                    ),
                ),
                (
                    "bdt_amount",
                    models.DecimalField(
                        decimal_places=2, help_text="Amount paid in BDT", max_digits=10
                    ),
                ),
                ("requested_at", models.DateTimeField(auto_now_add=True)),
                ("reviewed_at", models.DateTimeField(blank=True, null=True)),
                (
                    "completed_at",
                    models.DateTimeField(
                        blank=True, help_text="When credits were actually added", null=True
                    ),
                ),
                (
                    "user_note",
                    models.TextField(
                        blank=True, default="", help_text="User note/payment proof details"
                    ),
                ),
                (
                    "admin_note",
                    models.TextField(
                        blank=True,
                        default="",
                        help_text="Admin note (approval details, verification notes, etc.)",
                    ),
                ),
                (
                    "rejection_reason",
                    models.TextField(
                        blank=True, default="", help_text="Reason for rejection (shown to user)"
                    ),
                ),
            ],
            options={
                "verbose_name": "Top-Up Request",
                "verbose_name_plural": "Top-Up Requests",
                "ordering": ["-requested_at"],
            },
        ),
        migrations.CreateModel(
            name="TradeRequest",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
                    ),
                ),
                ("offered_quantity", models.PositiveIntegerField(default=1)),
                (
                    "requested_quantity",
                    models.PositiveIntegerField(
                        blank=True, help_text="Quantity of requested item", null=True
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("PENDING", "Pending"),
                            ("ACCEPTED", "Accepted"),
                            ("REJECTED", "Rejected"),
                            ("CANCELED", "Canceled"),
                        ],
                        db_index=True,
                        default="PENDING",
                        max_length=20,
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("resolved_at", models.DateTimeField(blank=True, null=True)),
                (
                    "message",
                    models.TextField(
                        blank=True,
                        default="",
                        help_text="Optional message from initiator",
                        max_length=500,
                    ),
                ),
            ],
            options={
                "verbose_name": "Trade Request",
                "verbose_name_plural": "Trade Requests",
                "db_table": "economy_trade_request",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="UserInventoryItem",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
                    ),
                ),
                (
                    "quantity",
                    models.PositiveIntegerField(
                        default=1, help_text="How many of this item the user owns"
                    ),
                ),
                (
                    "locked",
                    models.BooleanField(
                        default=False, help_text="Locked items cannot be traded/gifted"
                    ),
                ),
                (
                    "acquired_from",
                    models.CharField(
                        choices=[
                            ("PURCHASE", "Purchase"),
                            ("REWARD", "Reward"),
                            ("GIFT", "Gift"),
                            ("TRADE", "Trade"),
                            ("ADMIN", "Admin Grant"),
                        ],
                        db_index=True,
                        max_length=20,
                    ),
                ),
                ("acquired_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
            ],
            options={
                "verbose_name": "User Inventory Item",
                "verbose_name_plural": "User Inventory Items",
                "db_table": "economy_user_inventory_item",
                "ordering": ["-acquired_at"],
            },
        ),
        migrations.CreateModel(
            name="WalletPINOTP",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
                    ),
                ),
                (
                    "code_hash",
                    models.CharField(help_text="Hashed OTP code (6 digits)", max_length=255),
                ),
                (
                    "purpose",
                    models.CharField(
                        choices=[
                            ("pin_setup", "PIN Setup (First Time)"),
                            ("pin_change", "PIN Change"),
                        ],
                        default="pin_setup",
                        max_length=20,
                    ),
                ),
                (
                    "attempt_count",
                    models.IntegerField(default=0, help_text="Number of verification attempts"),
                ),
                (
                    "max_attempts",
                    models.IntegerField(default=5, help_text="Maximum allowed attempts"),
                ),
                (
                    "is_used",
                    models.BooleanField(
                        default=False,
                        help_text="Whether OTP has been successfully verified and used",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                (
                    "expires_at",
                    models.DateTimeField(help_text="OTP expiry time (10 minutes from creation)"),
                ),
                (
                    "used_at",
                    models.DateTimeField(
                        blank=True, help_text="When OTP was successfully used", null=True
                    ),
                ),
            ],
            options={
                "verbose_name": "Wallet PIN OTP",
                "verbose_name_plural": "Wallet PIN OTPs",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="WithdrawalRequest",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
                    ),
                ),
                (
                    "amount",
                    models.PositiveIntegerField(help_text="Amount in DeltaCoins to withdraw"),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("pending", "Pending Review"),
                            ("approved", "Approved"),
                            ("completed", "Completed"),
                            ("rejected", "Rejected"),
                            ("cancelled", "Cancelled"),
                        ],
                        default="pending",
                        max_length=20,
                    ),
                ),
                (
                    "payment_method",
                    models.CharField(
                        choices=[
                            ("bkash", "bKash"),
                            ("nagad", "Nagad"),
                            ("rocket", "Rocket"),
                            ("bank", "Bank Transfer"),
                        ],
                        max_length=20,
                    ),
                ),
                (
                    "payment_number",
                    models.CharField(
                        help_text="bKash/Nagad/Rocket number or bank account number", max_length=50
                    ),
                ),
                (
                    "payment_details",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="Additional payment info (bank name, branch, account name, etc.)",
                    ),
                ),
                (
                    "dc_to_bdt_rate",
                    models.DecimalField(
                        decimal_places=2,
                        default=1.0,
                        help_text="DeltaCoin to BDT exchange rate (e.g., 1 DC = 1.00 BDT)",
                        max_digits=10,
                    ),
                ),
                (
                    "processing_fee",
                    models.PositiveIntegerField(
                        default=0, help_text="Processing fee in DeltaCoins"
                    ),
                ),
                (
                    "bdt_amount",
                    models.DecimalField(
                        decimal_places=2, help_text="Amount in BDT after conversion", max_digits=10
                    ),
                ),
                ("requested_at", models.DateTimeField(auto_now_add=True)),
                ("reviewed_at", models.DateTimeField(blank=True, null=True)),
                (
                    "completed_at",
                    models.DateTimeField(
                        blank=True, help_text="When funds were actually transferred", null=True
                    ),
                ),
                (
                    "user_note",
                    models.TextField(
                        blank=True, default="", help_text="User note/reason for withdrawal"
                    ),
                ),
                (
                    "admin_note",
                    models.TextField(
                        blank=True,
                        default="",
                        help_text="Admin note (rejection reason, transfer details, etc.)",
                    ),
                ),
                (
                    "rejection_reason",
                    models.TextField(
                        blank=True, default="", help_text="Reason for rejection (shown to user)"
                    ),
                ),
            ],
            options={
                "verbose_name": "Withdrawal Request",
                "verbose_name_plural": "Withdrawal Requests",
                "ordering": ["-requested_at"],
            },
        ),
        migrations.CreateModel(
            name="DeltaCrownTransaction",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True, primary_key=True, serialize=False, verbose_name="ID"
                    ),
                ),
                (
                    "amount",
                    models.IntegerField(help_text="Positive for credit, negative for debit"),
                ),
                (
                    "reason",
                    models.CharField(
                        choices=[
                            ("participation", "Participation"),
                            ("top4", "Top 4"),
                            ("runner_up", "Runner-up"),
                            ("winner", "Winner"),
                            ("entry_fee_debit", "Entry fee (debit)"),
                            ("refund", "Refund"),
                            ("manual_adjust", "Manual adjust"),
                            ("correction", "Correction"),
                            ("p2p_transfer", "P2P Transfer"),
                        ],
                        max_length=32,
                    ),
                ),
                (
                    "tournament_id",
                    models.IntegerField(
                        blank=True,
                        db_index=True,
                        help_text="Legacy tournament ID (reference only)",
                        null=True,
                    ),
                ),
                (
                    "registration_id",
                    models.IntegerField(
                        blank=True,
                        db_index=True,
                        help_text="Legacy registration ID (reference only)",
                        null=True,
                    ),
                ),
                (
                    "match_id",
                    models.IntegerField(
                        blank=True, help_text="Legacy match ID (reference only)", null=True
                    ),
                ),
                ("note", models.CharField(blank=True, default="", max_length=255)),
                (
                    "idempotency_key",
                    models.CharField(blank=True, max_length=64, null=True, unique=True),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="coin_transactions_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "DeltaCrown Transaction",
                "ordering": ("-created_at", "id"),
            },
        ),
    ]
