# apps/teams/urls.py
from django.urls import path, include
from .views.public import (
    team_hub,
    team_list,
    team_detail,
    create_team_view,
    invite_member_view,
    my_invites,
    accept_invite_view,
    decline_invite_view,
    leave_team_view,
    manage_team_view,
    join_team_view,
    kick_member_view,
    transfer_captaincy_view,
    team_settings_view,
    delete_team_view,
    cancel_invite_view,
    # New professional management views
    update_team_info_view,
    update_privacy_view,
)
from .views.ajax import (
    my_teams_data,
    update_team_info,
    update_team_privacy,
    kick_member,
    transfer_captaincy,
    leave_team,
)

app_name = "teams"

urlpatterns = [
    # Team List - Now the main landing page (removed hub redirect)
    path("", team_list, name="index"),
    path("", team_list, name="hub"),
    path("list/", team_list, name="list"),
    path("rankings/", team_list, name="rankings"),
    
    path("create/", create_team_view, name="create"),

    # Detail + captain actions (slug-based)
    path("<slug:slug>/", team_detail, name="detail"),
    path("<slug:slug>/manage/", manage_team_view, name="manage"),
    # Aliases commonly referenced by templates
    path("<slug:slug>/manage/", manage_team_view, name="edit"),
    path("<slug:slug>/invite/", invite_member_view, name="invite_member"),
    path("<slug:slug>/invite/", invite_member_view, name="invite"),
    path("<slug:slug>/leave/", leave_team_view, name="leave"),
    path("<slug:slug>/join/", join_team_view, name="join"),
    path("<slug:slug>/kick/<int:profile_id>/", kick_member_view, name="kick"),
    path("<slug:slug>/transfer/<int:profile_id>/", transfer_captaincy_view, name="transfer_captaincy"),
    path("<slug:slug>/settings/", team_settings_view, name="settings"),
    path("<slug:slug>/delete/", delete_team_view, name="delete"),
    path("<slug:slug>/cancel-invite/", cancel_invite_view, name="cancel_invite"),
    
    # New professional management endpoints (kept from public.py)
    path("<slug:slug>/update-info/", update_team_info_view, name="update_team_info"),
    path("<slug:slug>/update-privacy/", update_privacy_view, name="update_privacy"),
    
    # AJAX endpoints (modularized)
    path("<slug:slug>/kick-member/", kick_member, name="kick_member"),
    path("<slug:slug>/transfer-captaincy/", transfer_captaincy, name="transfer_captaincy"),
    path("<slug:slug>/leave-team/", leave_team, name="leave_team"),
    path("my-teams-data/", my_teams_data, name="my_teams_ajax"),
    
    # Invites
    path("invites/", my_invites, name="my_invites"),
    # Alias for 'invitations' link
    path("invitations/", my_invites, name="invitations"),
    path("invites/<str:token>/accept/", accept_invite_view, name="accept_invite"),
    path("invites/<str:token>/decline/", decline_invite_view, name="decline_invite"),
    
    # Social features - include with namespace
    path("", include(("apps.teams.urls_social", "teams_social"), namespace="teams_social")),
]
