{% extends "tournaments/base.html" %}
{% load static humanize tournament_tags %}

{# ─────────────────────────────────────────────────────────
   Organizer Dashboard — My Tournaments
   Phase 4 Frontend Rebuild
   View: OrganizerDashboardView
   ───────────────────────────────────────────────────────── #}

{% block title %}Organizer Dashboard | DeltaCrown{% endblock %}

{% block tournament_content %}

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

  {# ── Header ── #}
  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8">
    <div>
      <h1 class="font-display font-black text-3xl text-white">Organizer Dashboard</h1>
      <p class="text-sm text-gray-500 mt-1">Manage your tournaments, registrations, and matches.</p>
    </div>
    <a href="{% url 'tournaments:create_tournament' %}" class="inline-flex items-center gap-2 px-5 py-3 bg-dc-cyan text-black font-bold text-sm rounded-xl hover:bg-dc-cyan/90 transition-all">
      <i data-lucide="plus" class="w-4 h-4"></i> Create Tournament
    </a>
  </div>

  {# ── Stats Cards ── #}
  <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
    <div class="glass rounded-xl p-5">
      <div class="flex items-center gap-3 mb-3">
        <div class="w-10 h-10 rounded-lg bg-dc-cyan/10 flex items-center justify-center">
          <i data-lucide="trophy" class="w-5 h-5 text-dc-cyan"></i>
        </div>
      </div>
      <div class="text-2xl font-display font-bold text-white">{{ stats.total_tournaments }}</div>
      <div class="text-xs text-gray-500 uppercase tracking-wider font-bold mt-1">Total</div>
    </div>

    <div class="glass rounded-xl p-5">
      <div class="flex items-center gap-3 mb-3">
        <div class="w-10 h-10 rounded-lg bg-green-500/10 flex items-center justify-center">
          <i data-lucide="play" class="w-5 h-5 text-green-500"></i>
        </div>
      </div>
      <div class="text-2xl font-display font-bold text-white">{{ stats.active_tournaments }}</div>
      <div class="text-xs text-gray-500 uppercase tracking-wider font-bold mt-1">Active</div>
    </div>

    <div class="glass rounded-xl p-5">
      <div class="flex items-center gap-3 mb-3">
        <div class="w-10 h-10 rounded-lg bg-yellow-500/10 flex items-center justify-center">
          <i data-lucide="file-edit" class="w-5 h-5 text-yellow-500"></i>
        </div>
      </div>
      <div class="text-2xl font-display font-bold text-white">{{ stats.draft_tournaments }}</div>
      <div class="text-xs text-gray-500 uppercase tracking-wider font-bold mt-1">Drafts</div>
    </div>

    <div class="glass rounded-xl p-5">
      <div class="flex items-center gap-3 mb-3">
        <div class="w-10 h-10 rounded-lg bg-dc-purple/10 flex items-center justify-center">
          <i data-lucide="check-circle" class="w-5 h-5 text-dc-purple"></i>
        </div>
      </div>
      <div class="text-2xl font-display font-bold text-white">{{ stats.completed_tournaments }}</div>
      <div class="text-xs text-gray-500 uppercase tracking-wider font-bold mt-1">Completed</div>
    </div>
  </div>

  {# ── Tournament List ── #}
  <div class="glass rounded-2xl overflow-hidden">
    <div class="px-6 py-4 border-b border-dc-border flex items-center justify-between">
      <h2 class="font-display font-bold text-lg text-white">Your Tournaments</h2>
    </div>

    {% if tournaments %}
    <div class="divide-y divide-white/5">
      {% for tournament in tournaments %}
      <a href="{% url 'tournaments:organizer_tournament_detail' tournament.slug %}" class="flex items-center gap-4 px-6 py-4 hover:bg-white/5 transition group">
        {# Thumbnail #}
        <div class="w-16 h-12 rounded-lg overflow-hidden flex-shrink-0 bg-dc-surface">
          {% if tournament.thumbnail_image %}
            <img src="{{ tournament.thumbnail_image.url }}" class="w-full h-full object-cover" alt="{{ tournament.name }}">
          {% elif tournament.banner_image %}
            <img src="{{ tournament.banner_image.url }}" class="w-full h-full object-cover" alt="{{ tournament.name }}">
          {% else %}
            <div class="w-full h-full flex items-center justify-center">
              <i data-lucide="trophy" class="w-5 h-5 text-gray-700"></i>
            </div>
          {% endif %}
        </div>

        {# Info #}
        <div class="flex-1 min-w-0">
          <h3 class="text-sm font-bold text-white truncate group-hover:text-dc-cyan transition">{{ tournament.name }}</h3>
          <div class="flex items-center gap-3 mt-1">
            <span class="text-[10px] text-gray-500">{{ tournament.game.display_name }}</span>
            <span class="text-[10px] text-gray-600">•</span>
            <span class="text-[10px] text-gray-500">{{ tournament.tournament_start|date:"M j, Y" }}</span>
          </div>
        </div>

        {# Metrics #}
        <div class="hidden md:flex items-center gap-6">
          <div class="text-center">
            <div class="text-sm font-bold text-white">{{ tournament.registration_count }}</div>
            <div class="text-[10px] text-gray-500">Regs</div>
          </div>
          <div class="text-center">
            <div class="text-sm font-bold text-white">{{ tournament.match_count }}</div>
            <div class="text-[10px] text-gray-500">Matches</div>
          </div>
        </div>

        {# Status badge #}
        <div class="flex-shrink-0">
          {% include "tournaments/components/_status_badge.html" with status=tournament.status %}
        </div>

        <i data-lucide="chevron-right" class="w-4 h-4 text-gray-600 group-hover:text-dc-cyan transition"></i>
      </a>
      {% endfor %}
    </div>

    {# Pagination #}
    <div class="px-6 py-4 border-t border-dc-border">
      {% include "tournaments/components/_pagination.html" with page_obj=page_obj %}
    </div>

    {% else %}
      <div class="p-8">
        {% include "tournaments/components/_empty_state.html" with icon="trophy" title="No tournaments yet" description="Create your first tournament to get started." action_url="/tournaments/organizer/create/" action_text="Create Tournament" %}
      </div>
    {% endif %}
  </div>
</div>

{% endblock %}
