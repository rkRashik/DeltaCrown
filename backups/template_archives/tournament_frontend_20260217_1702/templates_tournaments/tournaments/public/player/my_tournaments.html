{% extends "base.html" %}
{% load static %}

{% block title %}My Tournaments â€” DeltaCrown{% endblock %}

{% block content %}
<section class="container py-8">
  <!-- Page Header -->
  <div class="flex items-center justify-between mb-6">
    <div>
      <h1 class="sec-h">My Tournaments</h1>
      <p class="text-muted mt-1">Track your tournament registrations and progress</p>
    </div>
    <a href="{% url 'tournaments:list' %}" class="btn-primary">
      <i class="fas fa-search mr-2"></i>Browse Tournaments
    </a>
  </div>

  <!-- Filter Tabs -->
  <div class="glass rounded-xl p-1 mb-6 inline-flex">
    <a href="?status=all" class="px-4 py-2 rounded-lg {% if filter_status == 'all' %}bg-primary text-white{% else %}text-muted hover:text-white transition{% endif %}">
      All Tournaments
    </a>
    <a href="?status=active" class="px-4 py-2 rounded-lg {% if filter_status == 'active' %}bg-primary text-white{% else %}text-muted hover:text-white transition{% endif %}">
      Active
      {% if active_count > 0 %}<span class="ml-1 px-2 py-0.5 rounded-full bg-accent text-xs">{{ active_count }}</span>{% endif %}
    </a>
    <a href="?status=upcoming" class="px-4 py-2 rounded-lg {% if filter_status == 'upcoming' %}bg-primary text-white{% else %}text-muted hover:text-white transition{% endif %}">
      Upcoming
      {% if upcoming_count > 0 %}<span class="ml-1 px-2 py-0.5 rounded-full bg-blue-500/20 text-blue-400 text-xs">{{ upcoming_count }}</span>{% endif %}
    </a>
    <a href="?status=completed" class="px-4 py-2 rounded-lg {% if filter_status == 'completed' %}bg-primary text-white{% else %}text-muted hover:text-white transition{% endif %}">
      Completed
      {% if completed_count > 0 %}<span class="ml-1 px-2 py-0.5 rounded-full bg-gray-500/20 text-gray-400 text-xs">{{ completed_count }}</span>{% endif %}
    </a>
  </div>

  <!-- Tournaments Grid -->
  {% if my_tournaments %}
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
      {% for registration in my_tournaments %}
        {% include "tournaments/public/player/_tournament_card.html" with registration=registration %}
      {% endfor %}
    </div>

    <!-- Pagination -->
    {% if is_paginated %}
      <nav class="flex items-center justify-center gap-2">
        {% if page_obj.has_previous %}
          <a href="?page=1&status={{ filter_status }}" class="px-3 py-2 glass rounded-lg hover:bg-primary/20 transition">
            <i class="fas fa-angle-double-left"></i>
          </a>
          <a href="?page={{ page_obj.previous_page_number }}&status={{ filter_status }}" class="px-3 py-2 glass rounded-lg hover:bg-primary/20 transition">
            <i class="fas fa-angle-left"></i>
          </a>
        {% endif %}

        <span class="px-4 py-2 glass rounded-lg">
          Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
        </span>

        {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}&status={{ filter_status }}" class="px-3 py-2 glass rounded-lg hover:bg-primary/20 transition">
            <i class="fas fa-angle-right"></i>
          </a>
          <a href="?page={{ page_obj.paginator.num_pages }}&status={{ filter_status }}" class="px-3 py-2 glass rounded-lg hover:bg-primary/20 transition">
            <i class="fas fa-angle-double-right"></i>
          </a>
        {% endif %}
      </nav>
    {% endif %}
  {% else %}
    <!-- Empty State -->
    {% include "tournaments/public/player/_empty_state.html" with type="tournaments" filter_status=filter_status %}
  {% endif %}
</section>
{% endblock %}
