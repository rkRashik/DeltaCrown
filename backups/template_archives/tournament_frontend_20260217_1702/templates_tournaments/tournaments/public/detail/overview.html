{% extends "base.html" %}
{% load static %}

{% comment %}
FE-T-002: Tournament Detail Page
Purpose: Comprehensive tournament information page (state-based rendering)
Source: Documents/ExecutionPlan/FrontEnd/Backlog/FRONTEND_TOURNAMENT_BACKLOG.md (Section 1.2)
URL: /tournaments/<slug>/
{% endcomment %}

{% block title %}{{ tournament.name }} - DeltaCrown{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'tournaments/public/css/tournament-detail.css' %}">
{% endblock %}

{% block content %}
<div class="tournament-detail-container">
  <!-- Hero Section -->
  {% include "tournaments/public/detail/_hero.html" with tournament=tournament %}

  <!-- Main Content Area -->
  <div class="container mx-auto px-4 py-8">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      
      <!-- Main Content (Left Column - 2/3 width) -->
      <div class="lg:col-span-2">
        <!-- Tab Navigation -->
        {% include "tournaments/public/detail/_tabs.html" with tournament=tournament %}
      </div>

      <!-- Sidebar (Right Column - 1/3 width) -->
      <div class="lg:col-span-1">
        <!-- Registration CTA Card (FE-T-003) -->
        {% include "tournaments/public/detail/_cta_card.html" with tournament=tournament cta_state=cta_state cta_label=cta_label cta_disabled=cta_disabled is_registered=is_registered %}

        <!-- Info Panel -->
        {% include "tournaments/public/detail/_info_panel.html" with tournament=tournament %}

        <!-- Announcements Section -->
        {% if announcements %}
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
          <h3 class="text-xl font-bold mb-4 flex items-center">
            <i class="fas fa-bullhorn mr-2 text-blue-600"></i> Announcements
          </h3>
          <div class="space-y-3">
            {% for announcement in announcements %}
            <div class="border-l-4 {% if announcement.is_important %}border-red-500 bg-red-50{% elif announcement.is_pinned %}border-yellow-500 bg-yellow-50{% else %}border-gray-300 bg-gray-50{% endif %} p-3 rounded-r">
              <div class="flex items-start justify-between mb-1">
                <h4 class="font-semibold text-sm">{{ announcement.title }}</h4>
                <div class="flex space-x-1">
                  {% if announcement.is_pinned %}
                  <span class="text-yellow-600 text-xs">üìå</span>
                  {% endif %}
                  {% if announcement.is_important %}
                  <span class="text-red-600 text-xs">‚ö†Ô∏è</span>
                  {% endif %}
                </div>
              </div>
              <p class="text-gray-700 text-sm mb-2 line-clamp-3">{{ announcement.message }}</p>
              <div class="text-xs text-gray-500">
                {{ announcement.created_at|date:"M d, g:i A" }}
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
        {% endif %}

        <!-- Participants Preview (if registration open/closed) -->
        {% if tournament.status != 'draft' %}
          {% include "tournaments/public/detail/_participants_list.html" with tournament=tournament %}
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'tournaments/public/js/tournament-detail.js' %}"></script>
{% endblock %}
