{% extends "base.html" %}
{% load static %}

{% block title %}Profile Settings - DeltaCrown{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/settings.css' %}">
{% endblock %}

{% block content %}
<div class="settings-container">
    
    <div class="settings-header">
        <h1 class="settings-title">Profile Settings</h1>
        <p class="settings-subtitle">Manage your account, privacy, and game profiles</p>
    </div>
    
    <div class="settings-layout">
        
        <!-- Sidebar Navigation -->
        <aside class="settings-sidebar">
            <nav class="settings-nav">
                <button class="nav-item active" data-section="profile">
                    <span class="nav-icon">üë§</span>
                    <span class="nav-text">Profile</span>
                </button>
                <button class="nav-item" data-section="identity">
                    <span class="nav-icon">üÜî</span>
                    <span class="nav-text">Identity & KYC</span>
                </button>
                <button class="nav-item" data-section="games">
                    <span class="nav-icon">üéÆ</span>
                    <span class="nav-text">Game IDs</span>
                </button>
                <button class="nav-item" data-section="socials">
                    <span class="nav-icon">üîó</span>
                    <span class="nav-text">Social Links</span>
                </button>
                <button class="nav-item" data-section="privacy">
                    <span class="nav-icon">üîí</span>
                    <span class="nav-text">Privacy</span>
                </button>
                <button class="nav-item" data-section="security">
                    <span class="nav-icon">üõ°Ô∏è</span>
                    <span class="nav-text">Security</span>
                </button>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <main class="settings-main">
            
            <!-- Profile Section -->
            <section id="section-profile" class="settings-section active">
                <h2 class="section-title">Profile Information</h2>
                
                <form method="post" enctype="multipart/form-data" class="settings-form">
                    {% csrf_token %}
                    
                    <div class="form-group">
                        <label class="form-label">Avatar</label>
                        <div class="avatar-upload">
                            {% if request.user.profile.avatar %}
                                <img src="{{ request.user.profile.avatar.url }}" alt="Avatar" class="avatar-preview">
                            {% else %}
                                <div class="avatar-preview default">{{ request.user.username|first|upper }}</div>
                            {% endif %}
                            <input type="file" name="avatar" accept="image/*" class="file-input" id="avatar-input">
                            <label for="avatar-input" class="btn btn-secondary">Change Avatar</label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Banner Image</label>
                        <div class="banner-upload">
                            {% if request.user.profile.banner %}
                                <img src="{{ request.user.profile.banner.url }}" alt="Banner" class="banner-preview">
                            {% else %}
                                <div class="banner-preview default">No banner uploaded</div>
                            {% endif %}
                            <input type="file" name="banner" accept="image/*" class="file-input" id="banner-input">
                            <label for="banner-input" class="btn btn-secondary">Change Banner</label>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="username">Username</label>
                            <input type="text" id="username" name="username" value="{{ request.user.username }}" class="form-input" readonly>
                            <span class="form-hint">Username cannot be changed</span>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="display_name">Display Name</label>
                            <input type="text" id="display_name" name="display_name" value="{{ request.user.profile.display_name }}" class="form-input" maxlength="80">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="bio">Bio</label>
                        <textarea id="bio" name="bio" class="form-input" rows="4" placeholder="Tell us about yourself...">{{ request.user.profile.bio }}</textarea>
                        <span class="form-hint">Maximum 500 characters</span>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="country">Country</label>
                            <input type="text" id="country" name="country" value="{{ request.user.profile.country }}" class="form-input">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="city">City</label>
                            <input type="text" id="city" name="city" value="{{ request.user.profile.city }}" class="form-input">
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </form>
            </section>
            
            <!-- Identity & KYC Section -->
            <section id="section-identity" class="settings-section">
                <h2 class="section-title">Identity & KYC Verification</h2>
                
                <div class="kyc-status-card">
                    {% if request.user.profile.is_kyc_verified %}
                        <div class="kyc-verified">
                            <span class="status-icon">‚úì</span>
                            <div>
                                <h3>KYC Verified</h3>
                                <p>Your identity has been verified</p>
                            </div>
                        </div>
                    {% else %}
                        <div class="kyc-unverified">
                            <span class="status-icon">‚ö†</span>
                            <div>
                                <h3>KYC Not Verified</h3>
                                <p>Verify your identity to unlock tournament features and prize withdrawals</p>
                                <a href="{% url 'user_profile:kyc_upload' %}" class="btn btn-primary">Start Verification</a>
                            </div>
                        </div>
                    {% endif %}
                </div>
                
                <form method="post" class="settings-form">
                    {% csrf_token %}
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="real_full_name">Full Legal Name</label>
                            <input type="text" id="real_full_name" name="real_full_name" value="{{ request.user.profile.real_full_name }}" class="form-input" {% if request.user.profile.is_kyc_verified %}readonly{% endif %}>
                            {% if request.user.profile.is_kyc_verified %}
                                <span class="form-hint">Locked after KYC verification</span>
                            {% endif %}
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="date_of_birth">Date of Birth</label>
                            <input type="date" id="date_of_birth" name="date_of_birth" value="{{ request.user.profile.date_of_birth|date:'Y-m-d' }}" class="form-input" {% if request.user.profile.is_kyc_verified %}readonly{% endif %}>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="nationality">Nationality</label>
                        <input type="text" id="nationality" name="nationality" value="{{ request.user.profile.nationality }}" class="form-input" {% if request.user.profile.is_kyc_verified %}readonly{% endif %}>
                    </div>
                    
                    {% if not request.user.profile.is_kyc_verified %}
                        <button type="submit" class="btn btn-primary">Update Identity Info</button>
                    {% endif %}
                </form>
            </section>
            
            <!-- Game IDs Section -->
            <section id="section-games" class="settings-section">
                <h2 class="section-title">Game Profiles</h2>
                
                <form method="post" class="settings-form">
                    {% csrf_token %}
                    
                    <div class="game-id-group">
                        <h3 class="game-title">Riot Games</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="riot_id">Riot ID (Name#TAG)</label>
                                <input type="text" id="riot_id" name="riot_id" value="{{ request.user.profile.riot_id }}" class="form-input" placeholder="PlayerName#TAG">
                            </div>
                        </div>
                    </div>
                    
                    <div class="game-id-group">
                        <h3 class="game-title">Steam Games</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="steam_id">Steam ID</label>
                                <input type="text" id="steam_id" name="steam_id" value="{{ request.user.profile.steam_id }}" class="form-input" placeholder="Your Steam ID">
                            </div>
                        </div>
                    </div>
                    
                    <div class="game-id-group">
                        <h3 class="game-title">Mobile Legends</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="mlbb_id">Game ID</label>
                                <input type="text" id="mlbb_id" name="mlbb_id" value="{{ request.user.profile.mlbb_id }}" class="form-input">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="mlbb_server_id">Server ID</label>
                                <input type="text" id="mlbb_server_id" name="mlbb_server_id" value="{{ request.user.profile.mlbb_server_id }}" class="form-input">
                            </div>
                        </div>
                    </div>
                    
                    <div class="game-id-group">
                        <h3 class="game-title">Other Games</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="ea_id">EA ID (FC 24)</label>
                                <input type="text" id="ea_id" name="ea_id" value="{{ request.user.profile.ea_id }}" class="form-input">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="pubg_mobile_id">PUBG Mobile ID</label>
                                <input type="text" id="pubg_mobile_id" name="pubg_mobile_id" value="{{ request.user.profile.pubg_mobile_id }}" class="form-input">
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Save Game IDs</button>
                </form>
            </section>
            
            <!-- Social Links Section -->
            <section id="section-socials" class="settings-section">
                <h2 class="section-title">Social Links</h2>
                
                <form method="post" class="settings-form">
                    {% csrf_token %}
                    
                    <div class="form-group">
                        <label class="form-label" for="youtube_link">YouTube Channel</label>
                        <input type="url" id="youtube_link" name="youtube_link" value="{{ request.user.profile.youtube_link }}" class="form-input" placeholder="https://youtube.com/@channel">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="twitch_link">Twitch</label>
                        <input type="url" id="twitch_link" name="twitch_link" value="{{ request.user.profile.twitch_link }}" class="form-input" placeholder="https://twitch.tv/username">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="discord_id">Discord ID</label>
                        <input type="text" id="discord_id" name="discord_id" value="{{ request.user.profile.discord_id }}" class="form-input" placeholder="username#1234">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="facebook">Facebook</label>
                            <input type="url" id="facebook" name="facebook" value="{{ request.user.profile.facebook }}" class="form-input" placeholder="https://facebook.com/profile">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="instagram">Instagram</label>
                            <input type="url" id="instagram" name="instagram" value="{{ request.user.profile.instagram }}" class="form-input" placeholder="https://instagram.com/username">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="twitter">Twitter/X</label>
                        <input type="url" id="twitter" name="twitter" value="{{ request.user.profile.twitter }}" class="form-input" placeholder="https://twitter.com/username">
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Save Social Links</button>
                </form>
            </section>
            
            <!-- Privacy Section -->
            <section id="section-privacy" class="settings-section">
                <h2 class="section-title">Privacy Settings</h2>
                
                <form method="post" class="settings-form">
                    {% csrf_token %}
                    
                    <div class="privacy-group">
                        <h3 class="privacy-title">Profile Visibility</h3>
                        
                        <label class="checkbox-label">
                            <input type="checkbox" name="show_email" {% if request.user.profile.show_email %}checked{% endif %}>
                            <span>Show email address on public profile</span>
                        </label>
                        
                        <label class="checkbox-label">
                            <input type="checkbox" name="show_phone" {% if request.user.profile.show_phone %}checked{% endif %}>
                            <span>Show phone number on public profile</span>
                        </label>
                        
                        <label class="checkbox-label">
                            <input type="checkbox" name="show_real_name" {% if request.user.profile.show_real_name %}checked{% endif %}>
                            <span>Show real name on public profile</span>
                        </label>
                        
                        <label class="checkbox-label">
                            <input type="checkbox" name="show_age" {% if request.user.profile.show_age %}checked{% endif %}>
                            <span>Show age on public profile</span>
                        </label>
                        
                        <label class="checkbox-label">
                            <input type="checkbox" name="show_country" {% if request.user.profile.show_country %}checked{% endif %}>
                            <span>Show country on public profile</span>
                        </label>
                        
                        <label class="checkbox-label">
                            <input type="checkbox" name="show_socials" {% if request.user.profile.show_socials %}checked{% endif %}>
                            <span>Show social links on public profile</span>
                        </label>
                    </div>
                    
                    <div class="privacy-group">
                        <h3 class="privacy-title">Account Privacy</h3>
                        
                        <label class="checkbox-label">
                            <input type="checkbox" name="is_private" {% if request.user.profile.is_private %}checked{% endif %}>
                            <span>Make entire profile private</span>
                        </label>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Save Privacy Settings</button>
                </form>
            </section>
            
            <!-- Security Section -->
            <section id="section-security" class="settings-section">
                <h2 class="section-title">Security</h2>
                
                <div class="security-card">
                    <h3>Change Password</h3>
                    <p>Keep your account secure with a strong password</p>
                    <a href="{% url 'account:password_change' %}" class="btn btn-secondary">Change Password</a>
                </div>
                
                <div class="security-card">
                    <h3>Two-Factor Authentication</h3>
                    <p>Add an extra layer of security to your account</p>
                    <button class="btn btn-secondary" disabled>Coming Soon</button>
                </div>
                
                <div class="security-card danger">
                    <h3>Delete Account</h3>
                    <p>Permanently delete your account and all associated data</p>
                    <button class="btn btn-danger" onclick="alert('Please contact support to delete your account')">Delete Account</button>
                </div>
            </section>
            
        </main>
    </div>
    
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/settings.js' %}"></script>
{% endblock %}
