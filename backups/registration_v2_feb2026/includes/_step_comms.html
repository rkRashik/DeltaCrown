<div data-wizard-step="comms" class="wizard-step step-hidden animate-slide-in-right">
    <div class="mb-8 border-b border-white/10 pb-6">
        <h2 class="font-gaming font-bold text-3xl text-white mb-2">How to Reach You</h2>
        <p class="text-sm text-gray-400 max-w-lg">
            Share your contact details so the organizer and your opponents can reach you for match scheduling and updates.
        </p>
    </div>

    <div class="space-y-5" id="comms-channels">
        {% for channel in form_config.channels %}
        <div class="space-y-2" data-channel="{{ channel.key }}">
            <label class="text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1 flex items-center gap-2" for="comm_{{ channel.key }}">
                {% if channel.key == 'discord' %}
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="#5865F2"><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189z"/></svg>
                {% elif channel.key == 'phone' or channel.key == 'whatsapp' %}
                <i data-lucide="phone" class="w-3.5 h-3.5 text-green-400"></i>
                {% elif channel.key == 'telegram' %}
                <i data-lucide="send" class="w-3.5 h-3.5 text-blue-400"></i>
                {% elif channel.key == 'email' %}
                <i data-lucide="mail" class="w-3.5 h-3.5 text-cyan-400"></i>
                {% elif channel.key == 'facebook' %}
                <i data-lucide="facebook" class="w-3.5 h-3.5 text-blue-500"></i>
                {% else %}
                <i data-lucide="message-circle" class="w-3.5 h-3.5 text-gray-400"></i>
                {% endif %}

                {{ channel.label }}
                {% if channel.required %}<span class="text-red-400">*</span>{% else %}<span class="text-gray-600">(Optional)</span>{% endif %}
            </label>

            {% if channel.help_text %}
            <p class="text-[10px] text-gray-500 ml-1">{{ channel.help_text }}</p>
            {% endif %}

            <div class="relative">
                {% if channel.key == 'discord' %}
                <div class="absolute left-4 top-1/2 -translate-y-1/2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="#5865F2"><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189z"/></svg>
                </div>
                {% elif channel.key == 'phone' or channel.key == 'whatsapp' %}
                <div class="absolute left-4 top-1/2 -translate-y-1/2 text-green-400">
                    <i data-lucide="phone" class="w-4 h-4"></i>
                </div>
                {% elif channel.key == 'telegram' %}
                <div class="absolute left-4 top-1/2 -translate-y-1/2 text-blue-400">
                    <i data-lucide="send" class="w-4 h-4"></i>
                </div>
                {% elif channel.key == 'email' %}
                <div class="absolute left-4 top-1/2 -translate-y-1/2 text-cyan-400">
                    <i data-lucide="mail" class="w-4 h-4"></i>
                </div>
                {% else %}
                <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">
                    <i data-lucide="message-circle" class="w-4 h-4"></i>
                </div>
                {% endif %}

                <input
                    type="{% if channel.key == 'email' %}email{% elif channel.key == 'phone' or channel.key == 'whatsapp' %}tel{% else %}text{% endif %}"
                    name="comm_{{ channel.key }}"
                    id="comm_{{ channel.key }}"
                    class="input-premium pl-12"
                    placeholder="{{ channel.placeholder|default:channel.label }}"
                    value="{{ channel.prefill_value|default:'' }}"
                    {% if channel.required %}required{% endif %}
                    oninput="checkStep('comms')"
                    data-channel-key="{{ channel.key }}"
                    data-required="{{ channel.required|yesno:'true,false' }}"
                >
            </div>

            <p class="text-[10px] ml-1 hidden" data-validation-msg="comm_{{ channel.key }}">
                <i data-lucide="alert-circle" class="w-3 h-3 inline mr-1"></i>
                <span></span>
            </p>
        </div>
        {% empty %}
        <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
            <div class="space-y-2">
                <label class="text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1">Phone / WhatsApp <span class="text-red-400">*</span></label>
                <div class="relative">
                    <div class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">
                        <i data-lucide="phone" class="w-4 h-4"></i>
                    </div>
                    <input type="tel" name="phone" value="{{ fields.phone.value }}" class="input-premium pl-12 font-mono" placeholder="Your phone number" oninput="checkStep('comms')" required>
                </div>
            </div>
            <div class="space-y-2">
                <label class="text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1">Discord ID {% if registration_type == 'team' %}<span class="text-red-400">*</span>{% else %}<span class="text-gray-600">(Optional)</span>{% endif %}</label>
                <div class="relative">
                    <div class="absolute left-4 top-1/2 -translate-y-1/2 text-indigo-400">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189z"/></svg>
                    </div>
                    <input type="text" name="discord" value="{{ fields.discord.value }}" class="input-premium pl-12" placeholder="Username#0000" oninput="checkStep('comms')">
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    {% if form_config.channels|length > 1 %}
    <div class="mt-8 p-5 rounded-xl border border-white/10 bg-white/[0.02]">
        <h3 class="text-xs font-black text-gray-400 uppercase tracking-[0.15em] mb-3 flex items-center gap-2">
            <i data-lucide="star" class="w-4 h-4 text-dc-gold"></i> Preferred Contact Method
        </h3>
        <p class="text-[10px] text-gray-500 mb-3">Which channel should the organizer primarily use to contact you?</p>
        <div class="flex flex-wrap gap-2">
            {% for channel in form_config.channels %}
            <label class="flex items-center gap-2 px-4 py-2.5 rounded-xl border border-white/10 bg-black/30 cursor-pointer hover:border-white/20 transition-all text-sm has-[:checked]:border-[color:var(--accent)] has-[:checked]:bg-[color:var(--accent)]/5">
                <input type="radio" name="preferred_contact" value="{{ channel.key }}" class="appearance-none w-3.5 h-3.5 border-2 border-gray-600 rounded-full checked:border-[color:var(--accent)] checked:bg-[color:var(--accent)] transition-all" {% if channel.key == 'discord' or forloop.first %}checked{% endif %}>
                <span class="text-gray-300 font-medium">{{ channel.label }}</span>
            </label>
            {% endfor %}
        </div>
    </div>
    {% else %}
    <input type="hidden" name="preferred_contact" value="{{ fields.preferred_contact.value|default:'discord' }}">
    {% endif %}
</div>
